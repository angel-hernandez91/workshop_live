

============================== 2022-03-09 21:39:14.052384 | b1b69cac-3994-4c48-9690-81e18bfa81af ==============================
21:39:14.052384 [info ] [MainThread]: Running with dbt=1.0.1
21:39:14.052771 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
21:39:14.052951 [debug] [MainThread]: Tracking: tracking
21:39:14.073980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108811670>]}
21:39:15.148368 [debug] [MainThread]: Executing "git --help"
21:39:15.164961 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
21:39:15.165717 [debug] [MainThread]: STDERR: "b''"
21:39:15.177916 [debug] [MainThread]: Acquiring new snowflake connection "debug"
21:39:15.180693 [debug] [MainThread]: Using snowflake connection "debug"
21:39:15.181020 [debug] [MainThread]: On debug: select 1 as id
21:39:15.181313 [debug] [MainThread]: Opening a new connection, currently in state init
21:39:16.427147 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.25 seconds
21:39:16.428912 [debug] [MainThread]: On debug: Close
21:39:16.606744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e765ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e765bb0>]}
21:39:16.966241 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-03-10 00:33:34.363134 | c1d19487-e86c-4e29-b940-259eebebb184 ==============================
00:33:34.363134 [info ] [MainThread]: Running with dbt=1.0.1
00:33:34.363894 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
00:33:34.364084 [debug] [MainThread]: Tracking: tracking
00:33:34.364305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8ea90>]}
00:33:34.365630 [debug] [MainThread]: Set downloads directory='/var/folders/mk/2ztnrxy17z11rwb071p5c8c80000gp/T/dbt-downloads-amxp7u84'
00:33:34.365949 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
00:33:35.007726 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
00:33:35.008111 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json
00:33:35.053099 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json 200
00:33:35.056523 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json
00:33:35.253219 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json 200
00:33:35.253959 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
00:33:35.473391 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
00:33:35.484283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json
00:33:35.701225 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json 200
00:33:35.702029 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
00:33:35.740377 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
00:33:35.743705 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json
00:33:35.866265 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json 200
00:33:35.867010 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:33:35.912225 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:33:35.948595 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json
00:33:35.983144 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json 200
00:33:35.983563 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json
00:33:36.025551 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json 200
00:33:36.029415 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
00:33:36.090099 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
00:33:36.101331 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
00:33:36.137428 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
00:33:36.140659 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:33:36.176738 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:33:36.213733 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json
00:33:36.262334 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json 200
00:33:36.262894 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json
00:33:36.303768 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json 200
00:33:36.304211 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json
00:33:36.339045 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json 200
00:33:36.339534 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json
00:33:36.379384 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json 200
00:33:36.379841 [info ] [MainThread]: Installing fivetran/fivetran_log
00:33:36.752485 [info ] [MainThread]:   Installed from version 0.5.2
00:33:36.752892 [info ] [MainThread]:   Up to date!
00:33:36.753266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c1d19487-e86c-4e29-b940-259eebebb184', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bad520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8e550>]}
00:33:36.753552 [info ] [MainThread]: Installing fivetran/fivetran_utils
00:33:36.984233 [info ] [MainThread]:   Installed from version 0.3.4
00:33:36.984644 [info ] [MainThread]:   Up to date!
00:33:36.985015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c1d19487-e86c-4e29-b940-259eebebb184', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bac580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bac3d0>]}
00:33:36.985305 [info ] [MainThread]: Installing dbt-labs/spark_utils
00:33:37.247837 [info ] [MainThread]:   Installed from version 0.3.0
00:33:37.248272 [info ] [MainThread]:   Up to date!
00:33:37.248801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c1d19487-e86c-4e29-b940-259eebebb184', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bac910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bac970>]}
00:33:37.249177 [info ] [MainThread]: Installing dbt-labs/dbt_utils
00:33:37.574553 [info ] [MainThread]:   Installed from version 0.8.2
00:33:37.575143 [info ] [MainThread]:   Up to date!
00:33:37.575653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c1d19487-e86c-4e29-b940-259eebebb184', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8e6d0>]}
00:33:37.579189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c85bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c85a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c85550>]}


============================== 2022-03-10 00:48:07.846820 | e58f180f-87f9-4f8b-b53b-68a4b675f066 ==============================
00:48:07.846820 [info ] [MainThread]: Running with dbt=1.0.1
00:48:07.847670 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
00:48:07.848097 [debug] [MainThread]: Tracking: tracking
00:48:07.848545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b9079a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b907550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b907c70>]}
00:48:07.849556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b907550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b907c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b907400>]}


============================== 2022-03-10 00:49:39.804298 | 7616c932-250a-4158-bd6a-6c9d43ce540a ==============================
00:49:39.804298 [info ] [MainThread]: Running with dbt=1.0.1
00:49:39.805178 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
00:49:39.805421 [debug] [MainThread]: Tracking: tracking
00:49:39.805713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d9bb0>]}
00:49:39.808062 [debug] [MainThread]: Set downloads directory='/var/folders/mk/2ztnrxy17z11rwb071p5c8c80000gp/T/dbt-downloads-4j8ypv97'
00:49:39.808448 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
00:49:39.895458 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
00:49:39.896003 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json
00:49:39.947369 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json 200
00:49:39.951123 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json
00:49:39.991075 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json 200
00:49:39.991975 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
00:49:40.032232 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
00:49:40.043672 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json
00:49:40.078535 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json 200
00:49:40.079185 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
00:49:40.119940 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
00:49:40.123688 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json
00:49:40.162663 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json 200
00:49:40.163278 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:49:40.203912 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:49:40.236994 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json
00:49:40.272208 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json 200
00:49:40.272737 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json
00:49:40.309900 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json 200
00:49:40.313632 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
00:49:40.350241 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
00:49:40.360871 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
00:49:40.396270 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
00:49:40.399951 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:49:40.435625 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:49:40.469396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json
00:49:40.503656 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json 200
00:49:40.504098 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json
00:49:40.543117 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json 200
00:49:40.543661 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json
00:49:40.586809 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json 200
00:49:40.587224 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json
00:49:40.621585 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json 200
00:49:40.622118 [info ] [MainThread]: Installing fivetran/fivetran_log
00:49:41.059657 [info ] [MainThread]:   Installed from version 0.5.2
00:49:41.060197 [info ] [MainThread]:   Up to date!
00:49:41.060800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7616c932-250a-4158-bd6a-6c9d43ce540a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218f74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d9b80>]}
00:49:41.061163 [info ] [MainThread]: Installing fivetran/fivetran_utils
00:49:41.301482 [info ] [MainThread]:   Installed from version 0.3.4
00:49:41.301913 [info ] [MainThread]:   Up to date!
00:49:41.302286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7616c932-250a-4158-bd6a-6c9d43ce540a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121904640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219049d0>]}
00:49:41.302641 [info ] [MainThread]: Installing dbt-labs/spark_utils
00:49:41.566126 [info ] [MainThread]:   Installed from version 0.3.0
00:49:41.566677 [info ] [MainThread]:   Up to date!
00:49:41.567144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7616c932-250a-4158-bd6a-6c9d43ce540a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219048b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219041f0>]}
00:49:41.567440 [info ] [MainThread]: Installing dbt-labs/dbt_utils
00:49:41.885953 [info ] [MainThread]:   Installed from version 0.8.2
00:49:41.886557 [info ] [MainThread]:   Up to date!
00:49:41.887104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7616c932-250a-4158-bd6a-6c9d43ce540a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d9700>]}
00:49:41.894346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d0130>]}


============================== 2022-03-10 00:49:49.720325 | 3ba4e8ce-df9b-4a85-8158-aee9e8495bb6 ==============================
00:49:49.720325 [info ] [MainThread]: Running with dbt=1.0.1
00:49:49.721240 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:49:49.721491 [debug] [MainThread]: Tracking: tracking
00:49:49.721942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7839a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f783430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7838b0>]}
00:49:49.773868 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
00:49:49.774237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f85b100>]}
00:49:49.842712 [debug] [MainThread]: Parsing macros/catalog.sql
00:49:49.845143 [debug] [MainThread]: Parsing macros/adapters.sql
00:49:49.888648 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:49:49.892871 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:49:49.898649 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:49:49.900178 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:49:49.903606 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:49:49.913304 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:49:49.914325 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:49:49.918541 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:49:49.921014 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:49:49.922857 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:49:49.941233 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:49:49.952985 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:49:49.983876 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:49:49.989654 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:49:49.991850 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:49:49.993943 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:49:49.998791 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:49:50.011173 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:49:50.012860 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:49:50.025174 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:49:50.042850 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:49:50.051040 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:49:50.054121 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:49:50.061853 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:49:50.063334 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:49:50.066189 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:49:50.069100 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:49:50.075600 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:49:50.092846 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:49:50.094393 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:49:50.097042 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:49:50.098754 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:49:50.099675 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:49:50.100518 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:49:50.101371 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:49:50.102916 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:49:50.107786 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:49:50.116735 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:49:50.119034 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:49:50.122084 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:49:50.132695 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:49:50.135871 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:49:50.140720 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:49:50.148757 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:49:50.160724 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:49:50.164563 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
00:49:50.165957 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
00:49:50.167603 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
00:49:50.169109 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
00:49:50.177611 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
00:49:50.179228 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
00:49:50.180868 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
00:49:50.184483 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
00:49:50.185800 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
00:49:50.187997 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
00:49:50.190739 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
00:49:50.201013 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
00:49:50.203086 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
00:49:50.204568 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
00:49:50.206197 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
00:49:50.208015 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
00:49:50.209482 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
00:49:50.211161 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
00:49:50.212165 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
00:49:50.215797 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
00:49:50.221597 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
00:49:50.223250 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
00:49:50.227042 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
00:49:50.229035 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
00:49:50.230727 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
00:49:50.232826 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
00:49:50.259168 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
00:49:50.261363 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
00:49:50.264171 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
00:49:50.265893 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
00:49:50.267083 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
00:49:50.268435 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
00:49:50.269632 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
00:49:50.270905 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
00:49:50.272672 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
00:49:50.274399 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
00:49:50.276808 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
00:49:50.279011 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
00:49:50.280322 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
00:49:50.282935 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
00:49:50.285170 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
00:49:50.286689 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
00:49:50.288009 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
00:49:50.291018 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
00:49:50.293122 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
00:49:50.295257 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
00:49:50.297614 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
00:49:50.300628 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
00:49:50.302146 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
00:49:50.305875 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
00:49:50.314981 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
00:49:50.319546 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
00:49:50.321219 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
00:49:50.325043 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
00:49:50.329541 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
00:49:50.333081 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
00:49:50.334799 [debug] [MainThread]: Parsing macros/sql/star.sql
00:49:50.339449 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
00:49:50.347749 [debug] [MainThread]: Parsing macros/sql/union.sql
00:49:50.358580 [debug] [MainThread]: Parsing macros/sql/groupby.sql
00:49:50.359966 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
00:49:50.363555 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
00:49:50.365390 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
00:49:50.367083 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
00:49:50.373634 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
00:49:50.379464 [debug] [MainThread]: Parsing macros/sql/pivot.sql
00:49:50.383864 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
00:49:50.386267 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
00:49:50.387636 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
00:49:50.395300 [debug] [MainThread]: Parsing macros/maintenance_operation.sql
00:49:50.415359 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/concat.sql
00:49:50.415929 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/datatypes.sql
00:49:50.416380 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/dateadd.sql
00:49:50.423088 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/datediff.sql
00:49:50.437394 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/current_timestamp.sql
00:49:50.438012 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/split_part.sql
00:49:50.439438 [debug] [MainThread]: Parsing macros/dbt_utils/sql/get_relations_by_prefix.sql
00:49:50.445123 [debug] [MainThread]: Parsing macros/etc/assert_not_null.sql
00:49:50.446528 [debug] [MainThread]: Parsing macros/snowplow/convert_timezone.sql
00:49:50.447168 [debug] [MainThread]: Parsing macros/enabled_vars.sql
00:49:50.448248 [debug] [MainThread]: Parsing macros/percentile.sql
00:49:50.452046 [debug] [MainThread]: Parsing macros/pivot_json_extract.sql
00:49:50.453192 [debug] [MainThread]: Parsing macros/persist_pass_through_columns.sql
00:49:50.454371 [debug] [MainThread]: Parsing macros/json_parse.sql
00:49:50.460622 [debug] [MainThread]: Parsing macros/max_bool.sql
00:49:50.462338 [debug] [MainThread]: Parsing macros/calculated_fields.sql
00:49:50.463436 [debug] [MainThread]: Parsing macros/seed_data_helper.sql
00:49:50.464942 [debug] [MainThread]: Parsing macros/fill_pass_through_columns.sql
00:49:50.466501 [debug] [MainThread]: Parsing macros/string_agg.sql
00:49:50.468945 [debug] [MainThread]: Parsing macros/timestamp_diff.sql
00:49:50.479413 [debug] [MainThread]: Parsing macros/generate_docs.sql
00:49:50.480491 [debug] [MainThread]: Parsing macros/generate_columns_macro.sql
00:49:50.484409 [debug] [MainThread]: Parsing macros/source_relation.sql
00:49:50.487055 [debug] [MainThread]: Parsing macros/first_value.sql
00:49:50.489313 [debug] [MainThread]: Parsing macros/add_dbt_source_relation.sql
00:49:50.490090 [debug] [MainThread]: Parsing macros/add_pass_through_columns.sql
00:49:50.492205 [debug] [MainThread]: Parsing macros/staging_models_automation.sql
00:49:50.495501 [debug] [MainThread]: Parsing macros/union_relations.sql
00:49:50.505104 [debug] [MainThread]: Parsing macros/snowflake_seed_data.sql
00:49:50.506148 [debug] [MainThread]: Parsing macros/get_columns_for_macro.sql
00:49:50.510220 [debug] [MainThread]: Parsing macros/fill_staging_columns.sql
00:49:50.515092 [debug] [MainThread]: Parsing macros/json_extract.sql
00:49:50.518356 [debug] [MainThread]: Parsing macros/collect_freshness.sql
00:49:50.522837 [debug] [MainThread]: Parsing macros/timestamp_add.sql
00:49:50.526382 [debug] [MainThread]: Parsing macros/ceiling.sql
00:49:50.528007 [debug] [MainThread]: Parsing macros/remove_prefix_from_columns.sql
00:49:50.529684 [debug] [MainThread]: Parsing macros/union_data.sql
00:49:50.536794 [debug] [MainThread]: Parsing macros/dummy_coalesce_value.sql
00:49:50.540273 [debug] [MainThread]: Parsing macros/array_agg.sql
00:49:50.541549 [debug] [MainThread]: Parsing macros/empty_variable_warning.sql
00:49:50.542631 [debug] [MainThread]: Parsing macros/enabled_vars_one_true.sql
00:49:50.543739 [debug] [MainThread]: Parsing macros/get_brand_columns.sql
00:49:51.061505 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
00:49:51.075529 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
00:49:51.108809 [debug] [MainThread]: 1603: static parser failed on fivetran_log__transformation_status.sql
00:49:51.115968 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__transformation_status.sql
00:49:51.117267 [debug] [MainThread]: 1603: static parser failed on fivetran_log__connector_status.sql
00:49:51.148473 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__connector_status.sql
00:49:51.149745 [debug] [MainThread]: 1699: static parser successfully parsed fivetran_log__credit_mar_destination_history.sql
00:49:51.152915 [debug] [MainThread]: 1603: static parser failed on fivetran_log__audit_table.sql
00:49:51.189534 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__audit_table.sql
00:49:51.190673 [debug] [MainThread]: 1603: static parser failed on fivetran_log__mar_table_history.sql
00:49:51.198158 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__mar_table_history.sql
00:49:51.199261 [debug] [MainThread]: 1603: static parser failed on fivetran_log__schema_changelog.sql
00:49:51.205740 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__schema_changelog.sql
00:49:51.206965 [debug] [MainThread]: 1603: static parser failed on fivetran_log__connector_daily_events.sql
00:49:51.246478 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__connector_daily_events.sql
00:49:51.247629 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__credits_used.sql
00:49:51.252447 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__credits_used.sql
00:49:51.253565 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__destination_membership.sql
00:49:51.259156 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__destination_membership.sql
00:49:51.260252 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__transformation.sql
00:49:51.267087 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__transformation.sql
00:49:51.268212 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__account_membership.sql
00:49:51.274042 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__account_membership.sql
00:49:51.275156 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__connector.sql
00:49:51.299105 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__connector.sql
00:49:51.300281 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__destination.sql
00:49:51.305502 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__destination.sql
00:49:51.306605 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__active_volume.sql
00:49:51.311768 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__active_volume.sql
00:49:51.312834 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__user.sql
00:49:51.318679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__user.sql
00:49:51.319743 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__log.sql
00:49:51.325341 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__log.sql
00:49:51.326485 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__account.sql
00:49:51.331583 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__account.sql
00:49:51.332687 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__trigger_table.sql
00:49:51.338631 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__trigger_table.sql
00:49:51.339915 [debug] [MainThread]: 1603: static parser failed on staging/tmp/stg_fivetran_log__connector_tmp.sql
00:49:51.344217 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/tmp/stg_fivetran_log__connector_tmp.sql
00:49:51.658422 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__transformation_status_destination_id__transformation_id.4c7bf174ec' (models/fivetran_log.yml) depends on a node named 'fivetran_log__transformation_status' which is disabled
00:49:51.658939 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__transformation_transformation_id__destination_id.53b3485eb3' (models/staging/stg_fivetran_log.yml) depends on a node named 'stg_fivetran_log__transformation' which is disabled
00:49:51.659255 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__trigger_table_trigger_table__transformation_id.124bb8d5ca' (models/staging/stg_fivetran_log.yml) depends on a node named 'stg_fivetran_log__trigger_table' which is disabled
00:49:51.704631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203239d0>]}
00:49:51.724473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120323430>]}
00:49:51.724863 [info ] [MainThread]: Found 18 models, 23 tests, 0 snapshots, 0 analyses, 479 macros, 0 operations, 0 seed files, 11 sources, 0 exposures, 0 metrics
00:49:51.728092 [info ] [MainThread]: 
00:49:51.728700 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:49:51.730623 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel"
00:49:51.742988 [debug] [ThreadPool]: Using snowflake connection "list_angel"
00:49:51.743245 [debug] [ThreadPool]: On list_angel: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel"} */

    show terse schemas in database angel
    limit 10000
00:49:51.743425 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:49:53.142682 [debug] [ThreadPool]: SQL status: SUCCESS 101 in 1.4 seconds
00:49:53.149007 [debug] [ThreadPool]: On list_angel: Close
00:49:53.932134 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel"
00:49:53.935901 [debug] [ThreadPool]: Using snowflake connection "list_angel"
00:49:53.936135 [debug] [ThreadPool]: On list_angel: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel"} */

    show terse schemas in database angel
    limit 10000
00:49:53.936336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:49:54.906331 [debug] [ThreadPool]: SQL status: SUCCESS 101 in 0.97 seconds
00:49:54.912211 [debug] [ThreadPool]: On list_angel: Close
00:49:55.067042 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel"
00:49:55.070816 [debug] [ThreadPool]: Using snowflake connection "list_angel"
00:49:55.071037 [debug] [ThreadPool]: On list_angel: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel"} */

    show terse schemas in database angel
    limit 10000
00:49:55.071230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:49:55.722754 [debug] [ThreadPool]: SQL status: SUCCESS 101 in 0.65 seconds
00:49:55.728540 [debug] [ThreadPool]: On list_angel: Close
00:49:55.966660 [debug] [ThreadPool]: Acquiring new snowflake connection "create_angel_workshop_live"
00:49:55.967159 [debug] [ThreadPool]: Acquiring new snowflake connection "create_angel_workshop_live"
00:49:55.967506 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='angel', schema='workshop_live', identifier=None)"
00:49:55.974772 [debug] [ThreadPool]: Using snowflake connection "create_angel_workshop_live"
00:49:55.974994 [debug] [ThreadPool]: On create_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "create_angel_workshop_live"} */
create schema if not exists angel.workshop_live
00:49:55.975189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:49:56.642481 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.67 seconds
00:49:56.644079 [debug] [ThreadPool]: On create_angel_workshop_live: Close
00:49:56.949383 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live"
00:49:56.959286 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live"
00:49:56.959519 [debug] [ThreadPool]: On list_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live"} */

    show terse objects in angel.workshop_live
00:49:56.959715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:49:57.663152 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.7 seconds
00:49:57.665075 [debug] [ThreadPool]: On list_angel_workshop_live: Close
00:49:57.819784 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_fivetran_log"
00:49:57.823618 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_fivetran_log"
00:49:57.823875 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_fivetran_log"} */

    show terse objects in angel.workshop_live_fivetran_log
00:49:57.824071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:49:58.511195 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.69 seconds
00:49:58.514022 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: Close
00:49:58.677358 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_stg_fivetran_log"
00:49:58.681212 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_stg_fivetran_log"
00:49:58.681432 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_stg_fivetran_log"} */

    show terse objects in angel.workshop_live_stg_fivetran_log
00:49:58.681631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:49:59.368440 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.69 seconds
00:49:59.371303 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: Close
00:49:59.568354 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:49:59.568878 [info ] [MainThread]: 
00:49:59.577642 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account
00:49:59.578063 [info ] [Thread-1  ]: 1 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__account [RUN]
00:49:59.578689 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account"
00:49:59.578918 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account
00:49:59.579144 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account
00:49:59.584859 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account"
00:49:59.585721 [debug] [Thread-1  ]: finished collecting timing info
00:49:59.585957 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account
00:49:59.623234 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__account"
00:49:59.624820 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__account"
00:49:59.625011 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__account"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__account  as
      (with account as (
    
    select * from angel.fivetran_log.account

),

fields as (

    select
        id as account_id,
        country,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        name as account_name,
        status
        
    from account

)

select * from fields
      );
00:49:59.625183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:02.193189 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.57 seconds
00:50:02.207465 [debug] [Thread-1  ]: finished collecting timing info
00:50:02.207735 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account: Close
00:50:02.391309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120301d60>]}
00:50:02.391948 [info ] [Thread-1  ]: 1 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__account [[32mSUCCESS 1[0m in 2.81s]
00:50:02.392513 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account
00:50:02.392825 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account_membership
00:50:02.393468 [info ] [Thread-1  ]: 2 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership [RUN]
00:50:02.394152 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
00:50:02.394375 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account_membership
00:50:02.394595 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account_membership
00:50:02.400931 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
00:50:02.401562 [debug] [Thread-1  ]: finished collecting timing info
00:50:02.401799 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account_membership
00:50:02.405476 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
00:50:02.407090 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
00:50:02.407314 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account_membership: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__account_membership"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership  as
      (with account_membership as (
    
    select * from angel.fivetran_log.account_membership

),

fields as (

    select
        account_id,
        user_id,
        cast(activated_at as 
    timestamp_ntz
) as activated_at,
        cast(joined_at as 
    timestamp_ntz
) as joined_at,
        role as account_role
        
    from account_membership
    
)

select * from fields
      );
00:50:02.407531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:05.404209 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
00:50:05.407134 [debug] [Thread-1  ]: finished collecting timing info
00:50:05.407436 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account_membership: Close
00:50:05.619390 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120583730>]}
00:50:05.619969 [info ] [Thread-1  ]: 2 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership [[32mSUCCESS 1[0m in 3.23s]
00:50:05.620481 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account_membership
00:50:05.620778 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__active_volume
00:50:05.621125 [info ] [Thread-1  ]: 3 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume [RUN]
00:50:05.621787 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
00:50:05.622174 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__active_volume
00:50:05.622459 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__active_volume
00:50:05.628496 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
00:50:05.629131 [debug] [Thread-1  ]: finished collecting timing info
00:50:05.629358 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__active_volume
00:50:05.634034 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
00:50:05.635650 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
00:50:05.635864 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__active_volume: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__active_volume"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume  as
      (with active_volume as (

    select * from angel.fivetran_log.active_volume

),

fields as (

    select
        id as active_volume_id,
        connector_id as connector_name, -- Note: this misnomer will be changed by Fivetran soon
        destination_id,
        cast(measured_at as 
    timestamp_ntz
) as measured_at,
        monthly_active_rows,
        schema_name,
        table_name
    
    from active_volume
)

select * from fields
      );
00:50:05.636061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:09.266074 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.63 seconds
00:50:09.268595 [debug] [Thread-1  ]: finished collecting timing info
00:50:09.268892 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__active_volume: Close
00:50:09.509021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12073fcd0>]}
00:50:09.509603 [info ] [Thread-1  ]: 3 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume [[32mSUCCESS 1[0m in 3.89s]
00:50:09.510114 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__active_volume
00:50:09.510421 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector_tmp
00:50:09.510769 [info ] [Thread-1  ]: 4 of 18 START view model workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp [RUN]
00:50:09.511574 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
00:50:09.511833 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector_tmp
00:50:09.512102 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector_tmp
00:50:09.516989 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
00:50:09.517718 [debug] [Thread-1  ]: finished collecting timing info
00:50:09.517953 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector_tmp
00:50:09.545226 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
00:50:09.546397 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
00:50:09.546614 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector_tmp: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector_tmp"} */

  create or replace  view angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp 
  
   as (
    select *
from angel.fivetran_log.connector
  );
00:50:09.546806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:10.925362 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.38 seconds
00:50:10.928199 [debug] [Thread-1  ]: finished collecting timing info
00:50:10.928492 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector_tmp: Close
00:50:11.150940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12059f700>]}
00:50:11.151952 [info ] [Thread-1  ]: 4 of 18 OK created view model workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp [[32mSUCCESS 1[0m in 1.64s]
00:50:11.152418 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector_tmp
00:50:11.152764 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__credits_used
00:50:11.153092 [info ] [Thread-1  ]: 5 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used [RUN]
00:50:11.153673 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
00:50:11.153890 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__credits_used
00:50:11.154104 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__credits_used
00:50:11.161097 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
00:50:11.161888 [debug] [Thread-1  ]: finished collecting timing info
00:50:11.162285 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__credits_used
00:50:11.167048 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
00:50:11.168446 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
00:50:11.168667 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__credits_used: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__credits_used"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used  as
      (with  credits_used as (

    select * from angel.fivetran_log.credits_used

),

fields as (
    
    select 
        destination_id,
        measured_month,
        credits_consumed
    
    from credits_used
)

select * from fields
      );
00:50:11.168873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:13.378680 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.21 seconds
00:50:13.381588 [debug] [Thread-1  ]: finished collecting timing info
00:50:13.381901 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__credits_used: Close
00:50:13.552024 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120693c70>]}
00:50:13.552603 [info ] [Thread-1  ]: 5 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used [[32mSUCCESS 1[0m in 2.40s]
00:50:13.553113 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__credits_used
00:50:13.553410 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination
00:50:13.553750 [info ] [Thread-1  ]: 6 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination [RUN]
00:50:13.554401 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
00:50:13.554622 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination
00:50:13.554842 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination
00:50:13.560597 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination"
00:50:13.561283 [debug] [Thread-1  ]: finished collecting timing info
00:50:13.561531 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination
00:50:13.565264 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__destination"
00:50:13.566797 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
00:50:13.567033 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__destination"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination  as
      (with destination as (

    select * from angel.fivetran_log.destination

),

fields as (

    select
        id as destination_id,
        account_id,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        name as destination_name,
        region
    
    from destination
)

select * from fields
      );
00:50:13.567233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:16.073895 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.51 seconds
00:50:16.076999 [debug] [Thread-1  ]: finished collecting timing info
00:50:16.077318 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination: Close
00:50:16.232735 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a6fd0>]}
00:50:16.233328 [info ] [Thread-1  ]: 6 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination [[32mSUCCESS 1[0m in 2.68s]
00:50:16.233848 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination
00:50:16.234153 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination_membership
00:50:16.234631 [info ] [Thread-1  ]: 7 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership [RUN]
00:50:16.235321 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
00:50:16.235580 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination_membership
00:50:16.235836 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination_membership
00:50:16.242404 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
00:50:16.243062 [debug] [Thread-1  ]: finished collecting timing info
00:50:16.243318 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination_membership
00:50:16.247976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
00:50:16.249644 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
00:50:16.249870 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination_membership: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__destination_membership"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership  as
      (with destination_membership as (
    
    select * from angel.fivetran_log.destination_membership

),

fields as (

    select
        destination_id,
        user_id,
        cast(activated_at as 
    timestamp_ntz
) as activated_at,
        cast(joined_at as 
    timestamp_ntz
) as joined_at,
        role as destination_role
        
    from destination_membership
)

select * from fields
      );
00:50:16.250069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:18.915843 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.67 seconds
00:50:18.918465 [debug] [Thread-1  ]: finished collecting timing info
00:50:18.918761 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination_membership: Close
00:50:19.091354 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120778970>]}
00:50:19.091931 [info ] [Thread-1  ]: 7 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership [[32mSUCCESS 1[0m in 2.86s]
00:50:19.092456 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination_membership
00:50:19.092872 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__log
00:50:19.093228 [info ] [Thread-1  ]: 8 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__log.. [RUN]
00:50:19.093892 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__log"
00:50:19.094148 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__log
00:50:19.094400 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__log
00:50:19.100599 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__log"
00:50:19.101248 [debug] [Thread-1  ]: finished collecting timing info
00:50:19.101480 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__log
00:50:19.105244 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__log"
00:50:19.107299 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__log"
00:50:19.107539 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__log"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log  as
      (with log as (

    select * from angel.fivetran_log.log
    
),

fields as (

    select
        id as log_id, 
        cast(time_stamp as 
    timestamp_ntz
) as created_at,
        connector_id, -- Note: the connector_id column used to erroneously equal the connector_name, NOT its id.
        case when transformation_id is not null and event is null then 'TRANSFORMATION'
        else event end as event_type, 
        message_data,
        case 
        when transformation_id is not null and message_data like '%has succeeded%' then 'transformation run success'
        when transformation_id is not null and message_data like '%has failed%' then 'transformation run failed'
        else message_event end as event_subtype,
        transformation_id

    from log
)

select * from fields
      );
00:50:19.107760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:21.662892 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.56 seconds
00:50:21.665609 [debug] [Thread-1  ]: finished collecting timing info
00:50:21.665911 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__log: Close
00:50:21.929548 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207aa250>]}
00:50:21.930123 [info ] [Thread-1  ]: 8 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__log [[32mSUCCESS 1[0m in 2.84s]
00:50:21.930638 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__log
00:50:21.930944 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__user
00:50:21.931288 [info ] [Thread-1  ]: 9 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__user. [RUN]
00:50:21.931941 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__user"
00:50:21.932202 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__user
00:50:21.932561 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__user
00:50:21.938373 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__user"
00:50:21.939081 [debug] [Thread-1  ]: finished collecting timing info
00:50:21.939333 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__user
00:50:21.943043 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__user"
00:50:21.944704 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__user"
00:50:21.944931 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__user"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__user  as
      (with fivetran_user as (

    select * from angel.fivetran_log.user

),

fields as (

    select
        id as user_id,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        email,
        email_disabled as has_disabled_email_notifications,
        family_name as last_name,
        given_name as first_name,
        phone,
        verified as is_verified
        
    from fivetran_user

)

select * from fields
      );
00:50:21.945133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:23.832114 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.89 seconds
00:50:23.834876 [debug] [Thread-1  ]: finished collecting timing info
00:50:23.835170 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__user: Close
00:50:24.021195 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207cc2e0>]}
00:50:24.021838 [info ] [Thread-1  ]: 9 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__user [[32mSUCCESS 1[0m in 2.09s]
00:50:24.022358 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__user
00:50:24.022652 [debug] [Thread-1  ]: Began running node model.workshop_live.my_first_dbt_model
00:50:24.023075 [info ] [Thread-1  ]: 10 of 18 START table model workshop_live.my_first_dbt_model..................... [RUN]
00:50:24.023896 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_first_dbt_model"
00:50:24.024124 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_first_dbt_model
00:50:24.024339 [debug] [Thread-1  ]: Compiling model.workshop_live.my_first_dbt_model
00:50:24.028976 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_first_dbt_model"
00:50:24.029837 [debug] [Thread-1  ]: finished collecting timing info
00:50:24.030095 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_first_dbt_model
00:50:24.033942 [debug] [Thread-1  ]: Writing runtime SQL for node "model.workshop_live.my_first_dbt_model"
00:50:24.035451 [debug] [Thread-1  ]: Using snowflake connection "model.workshop_live.my_first_dbt_model"
00:50:24.035674 [debug] [Thread-1  ]: On model.workshop_live.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.workshop_live.my_first_dbt_model"} */


      create or replace transient table angel.workshop_live.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
00:50:24.035876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:26.635691 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.6 seconds
00:50:26.638460 [debug] [Thread-1  ]: finished collecting timing info
00:50:26.638755 [debug] [Thread-1  ]: On model.workshop_live.my_first_dbt_model: Close
00:50:26.815343 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207cc040>]}
00:50:26.815955 [info ] [Thread-1  ]: 10 of 18 OK created table model workshop_live.my_first_dbt_model................ [[32mSUCCESS 1[0m in 2.79s]
00:50:26.816470 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_first_dbt_model
00:50:26.816768 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector
00:50:26.817110 [info ] [Thread-1  ]: 11 of 18 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__connector [RUN]
00:50:26.817757 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
00:50:26.818013 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector
00:50:26.818266 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector
00:50:26.835241 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
00:50:26.835634 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */

    describe table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp
00:50:26.835855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:27.641967 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.81 seconds
00:50:27.657364 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector"
00:50:27.657965 [debug] [Thread-1  ]: finished collecting timing info
00:50:27.658196 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector
00:50:27.661999 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__connector"
00:50:27.665332 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
00:50:27.665550 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector  as
      (with connector as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp

),

fields as (
    select
        
    
    
    _fivetran_deleted
    
 as 
    
    _fivetran_deleted
    
, 
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    connecting_user_id
    
 as 
    
    connecting_user_id
    
, 
    
    
    connector_id
    
 as 
    
    connector_id
    
, 
    
    
    connector_name
    
 as 
    
    connector_name
    
, 
    
    
    connector_type
    
 as 
    
    connector_type
    
, 
    
    
    connector_type_id
    
 as 
    
    connector_type_id
    
, 
    
    
    destination_id
    
 as 
    
    destination_id
    
, 
    
    
    paused
    
 as 
    
    paused
    
, 
    cast(null as 
    int
) as 
    
    service_version
    
 , 
    
    
    signed_up
    
 as 
    
    signed_up
    



        ,row_number() over ( partition by connector_name, destination_id order by _fivetran_synced desc ) as nth_last_record
    from connector

),

final as (

    select 
        connector_id,
        connector_name,
        coalesce(connector_type_id, connector_type) as connector_type,
        destination_id,
        connecting_user_id,
        paused as is_paused,
        signed_up as set_up_at

    from fields

    -- Only look at the most recent one
    where nth_last_record = 1
)

select * 
from final
      );
00:50:29.608492 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.94 seconds
00:50:29.611279 [debug] [Thread-1  ]: finished collecting timing info
00:50:29.611583 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: Close
00:50:29.812211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207af910>]}
00:50:29.812781 [info ] [Thread-1  ]: 11 of 18 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__connector [[32mSUCCESS 1[0m in 2.99s]
00:50:29.813290 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector
00:50:29.813590 [debug] [Thread-1  ]: Began running node model.workshop_live.my_second_dbt_model
00:50:29.813933 [info ] [Thread-1  ]: 12 of 18 START view model workshop_live.my_second_dbt_model..................... [RUN]
00:50:29.814590 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_second_dbt_model"
00:50:29.814847 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_second_dbt_model
00:50:29.815258 [debug] [Thread-1  ]: Compiling model.workshop_live.my_second_dbt_model
00:50:29.819213 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_second_dbt_model"
00:50:29.819846 [debug] [Thread-1  ]: finished collecting timing info
00:50:29.820086 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_second_dbt_model
00:50:29.824266 [debug] [Thread-1  ]: Writing runtime SQL for node "model.workshop_live.my_second_dbt_model"
00:50:29.825306 [debug] [Thread-1  ]: Using snowflake connection "model.workshop_live.my_second_dbt_model"
00:50:29.825520 [debug] [Thread-1  ]: On model.workshop_live.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.workshop_live.my_second_dbt_model"} */

  create or replace  view angel.workshop_live.my_second_dbt_model 
  
   as (
    -- Use the `ref` function to select from other models

select *
from angel.workshop_live.my_first_dbt_model
where id = 1
  );
00:50:29.825719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:30.735043 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.91 seconds
00:50:30.737675 [debug] [Thread-1  ]: finished collecting timing info
00:50:30.737974 [debug] [Thread-1  ]: On model.workshop_live.my_second_dbt_model: Close
00:50:30.896576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120807280>]}
00:50:30.897147 [info ] [Thread-1  ]: 12 of 18 OK created view model workshop_live.my_second_dbt_model................ [[32mSUCCESS 1[0m in 1.08s]
00:50:30.897651 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_second_dbt_model
00:50:30.897957 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_status
00:50:30.898303 [info ] [Thread-1  ]: 13 of 18 START table model workshop_live_fivetran_log.fivetran_log__connector_status [RUN]
00:50:30.898942 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_status"
00:50:30.899161 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_status
00:50:30.899376 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_status
00:50:30.918465 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_status"
00:50:30.919157 [debug] [Thread-1  ]: finished collecting timing info
00:50:30.919408 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_status
00:50:30.975190 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__connector_status"
00:50:30.986303 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_status"
00:50:30.986538 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_status: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_status"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__connector_status  as
      (with connector_log as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    -- only looking at errors, warnings, and syncs here
    where event_type = 'SEVERE'
        or event_type = 'WARNING'
        or event_subtype like 'sync%'
        or (event_subtype = 'status' 
            and 

  parse_json( message_data )['status'] ='RESCHEDULED'
            and 

  parse_json( message_data )['reason'] like '%intended behavior%'
            ) -- for priority-first syncs. these should be captured by event_type = 'WARNING' but let's make sure

        -- whole reason is "We have rescheduled the connector to force flush data from the forward sync into your destination. This is intended behavior and means that the connector is working as expected."
),

schema_changes as (

    select
        connector_id,
        count(*) as number_of_schema_changes_last_month

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where 
        

    datediff(
        day,
        created_at,
        
    current_timestamp::
    timestamp_ntz


        )

 <= 30
        and event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config')

    group by 1

),

connector as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector

),

destination as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination
),

connector_metrics as (

    select
        connector.connector_id,
        connector.connector_name,
        connector.connector_type,
        connector.destination_id,
        connector.is_paused,
        connector.set_up_at,
        max(case when connector_log.event_subtype = 'sync_start' then connector_log.created_at else null end) as last_sync_started_at,

        max(case when connector_log.event_subtype = 'sync_end' 
            then connector_log.created_at else null end) as last_sync_completed_at,

        max(case when connector_log.event_subtype = 'status'
                and 

  parse_json( connector_log.message_data )['status'] ='RESCHEDULED'
                and 

  parse_json( connector_log.message_data )['reason'] like '%intended behavior%'
            then connector_log.created_at else null end) as last_priority_first_sync_completed_at,
                

        max(case when connector_log.event_type = 'SEVERE' then connector_log.created_at else null end) as last_error_at,
        max(case when event_type = 'WARNING' then connector_log.created_at else null end) as last_warning_at

    from connector 
    left join connector_log 
        on connector_log.connector_id = connector.connector_id
    group by 1,2,3,4,5,6

),

connector_health as (

    select
        *,
        case 
            -- connector is paused
            when is_paused then 'paused'

            -- a sync has never been attempted
            when last_sync_started_at is null then 'incomplete'

            -- a priority-first sync has occurred, but a normal sync has not
            when last_priority_first_sync_completed_at is not null and last_sync_completed_at is null then 'priority first sync'

            -- a priority sync has occurred more recently than a normal one (may occurr if the connector has been paused and resumed)
            when last_priority_first_sync_completed_at > last_sync_completed_at then 'priority first sync'

            -- a sync has been attempted, but not completed, and it's not due to errors. also a priority-first sync hasn't
            when last_sync_completed_at is null and last_error_at is null then 'initial sync in progress'

            -- there's been an error since the connector last completed a sync
            when last_error_at > last_sync_completed_at then 'broken'

            -- there's never been a successful sync and there have been errors
            when last_sync_completed_at is null and last_error_at is not null then 'broken'

        else 'connected' end as connector_health

    from connector_metrics
),

-- Joining with log to grab pertinent error/warning messagees
connector_recent_logs as (

    select 
        connector_health.connector_id,
        connector_health.connector_name,
        connector_health.connector_type,
        connector_health.destination_id,
        connector_health.connector_health,
        connector_health.last_sync_started_at,
        connector_health.last_sync_completed_at,
        connector_health.set_up_at,
        connector_log.event_subtype,
        connector_log.event_type,
        connector_log.message_data

    from connector_health 
    left join connector_log 
        on connector_log.connector_id = connector_health.connector_id
        -- limiting relevance to since the last successful sync completion (if there has been one)
        and connector_log.created_at > coalesce(connector_health.last_sync_completed_at, connector_health.last_priority_first_sync_completed_at, '2000-01-01') 
        -- only looking at errors and warnings (excluding syncs - both normal and priority first)
        and connector_log.event_type != 'INFO' 
        -- need to explicitly avoid priority first statuses because they are of event_type WARNING
        and not (connector_log.event_subtype = 'status' 
            and 

  parse_json( connector_log.message_data )['status'] ='RESCHEDULED'
            and 

  parse_json( connector_log.message_data )['reason'] like '%intended behavior%')

    group by 1,2,3,4,5,6,7,8,9,10,11 -- de-duping error messages
    

),

final as (

    select
        connector_recent_logs.connector_id,
        connector_recent_logs.connector_name,
        connector_recent_logs.connector_type,
        connector_recent_logs.destination_id,
        destination.destination_name,
        connector_recent_logs.connector_health,
        connector_recent_logs.last_sync_started_at,
        connector_recent_logs.last_sync_completed_at,
        connector_recent_logs.set_up_at,
        coalesce(schema_changes.number_of_schema_changes_last_month, 0) as number_of_schema_changes_last_month
        
        
        , 
    listagg(distinct case when connector_recent_logs.event_type = 'SEVERE' then connector_recent_logs.message_data else null end, '\n')

 as errors_since_last_completed_sync
        , 
    listagg(distinct case when connector_recent_logs.event_type = 'WARNING' then connector_recent_logs.message_data else null end, '\n')

 as warnings_since_last_completed_sync
        

    from connector_recent_logs
    left join schema_changes 
        on connector_recent_logs.connector_id = schema_changes.connector_id 

    join destination on destination.destination_id = connector_recent_logs.destination_id
    group by 1,2,3,4,5,6,7,8,9,10
)

select * from final
      );
00:50:30.986754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:33.691054 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.7 seconds
00:50:33.693671 [debug] [Thread-1  ]: finished collecting timing info
00:50:33.693975 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_status: Close
00:50:33.886541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a31c0>]}
00:50:33.887116 [info ] [Thread-1  ]: 13 of 18 OK created table model workshop_live_fivetran_log.fivetran_log__connector_status [[32mSUCCESS 1[0m in 2.99s]
00:50:33.887629 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_status
00:50:33.887931 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__mar_table_history
00:50:33.888274 [info ] [Thread-1  ]: 14 of 18 START table model workshop_live_fivetran_log.fivetran_log__mar_table_history [RUN]
00:50:33.888926 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
00:50:33.889330 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__mar_table_history
00:50:33.889787 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__mar_table_history
00:50:33.895946 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
00:50:33.896621 [debug] [Thread-1  ]: finished collecting timing info
00:50:33.896854 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__mar_table_history
00:50:33.900559 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
00:50:33.904137 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
00:50:33.904353 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__mar_table_history: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__mar_table_history"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__mar_table_history  as
      (with active_volume as (

    select 
        *, 
        
    date_trunc('month', measured_at)
 as measured_month

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume 

    where schema_name != 'fivetran_log' -- it's free! 

),

connector as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector
),

destination as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination
),

ordered_mar as (

    select
        connector_name,
        schema_name,
        table_name,
        destination_id,
        measured_at,
        measured_month,
        monthly_active_rows,

        -- each measurement is cumulative for the month, so we'll only look at the latest date for each month
        row_number() over(partition by table_name, connector_name, destination_id, measured_month order by measured_at desc) as n

    from active_volume

),

latest_mar as (
    select 
        connector_name,
        schema_name,
        table_name,
        destination_id,
        measured_month,
        date(measured_at) as last_measured_at,
        monthly_active_rows
      
    from ordered_mar
    where n = 1

),

mar_join as (

    select 
        latest_mar.*,
        connector.connector_type,
        connector.connector_id,
        destination.destination_name

    from latest_mar
    join connector 
        on latest_mar.connector_name = connector.connector_name
        and latest_mar.destination_id = connector.destination_id
    join destination on latest_mar.destination_id = destination.destination_id
)

select * from mar_join
order by measured_month desc, destination_id, connector_name
      );
00:50:33.904554 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:35.640563 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.74 seconds
00:50:35.643164 [debug] [Thread-1  ]: finished collecting timing info
00:50:35.643517 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__mar_table_history: Close
00:50:35.869042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a3d60>]}
00:50:35.869688 [info ] [Thread-1  ]: 14 of 18 OK created table model workshop_live_fivetran_log.fivetran_log__mar_table_history [[32mSUCCESS 1[0m in 1.98s]
00:50:35.870217 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__mar_table_history
00:50:35.870518 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__audit_table
00:50:35.870862 [info ] [Thread-1  ]: 15 of 18 START incremental model workshop_live_fivetran_log.fivetran_log__audit_table [RUN]
00:50:35.871517 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:35.872008 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__audit_table
00:50:35.872253 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__audit_table
00:50:35.891089 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:35.891362 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
select date(max(sync_start)) from angel.workshop_live_fivetran_log.fivetran_log__audit_table
00:50:35.891560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:36.686720 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.8 seconds
00:50:36.710252 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__audit_table"
00:50:36.710843 [debug] [Thread-1  ]: finished collecting timing info
00:50:36.711064 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__audit_table
00:50:36.751948 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:36.752209 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    

      create or replace temporary table angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp  as
      (

with sync_log as (
    
    select 
        *,
        

  parse_json( message_data )['table'] as table_name

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('sync_start', 'sync_end', 'write_to_table_start', 'write_to_table_end', 'records_modified')

    

    -- Capture the latest timestamp in a call statement instead of a subquery for optimizing BQ costs on incremental runs-- load the result from the above query into a new variable-- the query_result is stored as a dataframe. Therefore, we want to now store it as a singular value.-- compare the new batch of data to the latest sync already stored in this model
        and date(created_at) >= '2022-03-10'

    
),


connector as (

    select *
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status

),

add_connector_info as (

    select 
        sync_log.*,
        connector.connector_name,
        connector.destination_id,
        connector.destination_name

    from sync_log join connector using(connector_id)
),

sync_timestamps as (

    select
        connector_id,
        connector_name,
        table_name,
        event_subtype,
        destination_id,
        destination_name,

        created_at as write_to_table_start,
        
        min(case when event_subtype = 'write_to_table_end' then created_at else null end) 
            over (partition by connector_id, table_name order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as write_to_table_end,

        max(case when event_subtype = 'sync_start' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between UNBOUNDED PRECEDING and CURRENT ROW) as sync_start,

        min(case when event_subtype = 'sync_end' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as sync_end, -- coalesce with next_sync_start

        min(case when event_subtype = 'sync_start' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as next_sync_start

    from add_connector_info

),

-- this will be the base for every record in the final CTE
limit_to_table_starts as (

    select *

    from sync_timestamps 
    where event_subtype = 'write_to_table_start'

),

records_modified_log as (

    select 
        connector_id,
        created_at,
        

  parse_json( message_data )['table'] as table_name,
        

  parse_json( message_data )['schema'] as schema_name,
        

  parse_json( message_data )['operationType'] as operation_type,
        cast (

  parse_json( message_data )['count'] as 
    int
) as row_count

    from sync_log 
    where event_subtype = 'records_modified'

),

sum_records_modified as (

    select
        limit_to_table_starts.connector_id,
        limit_to_table_starts.connector_name,
        limit_to_table_starts.table_name,
        limit_to_table_starts.destination_id,
        limit_to_table_starts.destination_name,
        limit_to_table_starts.write_to_table_start,
        limit_to_table_starts.write_to_table_end,
        limit_to_table_starts.sync_start,
        case when limit_to_table_starts.sync_end > limit_to_table_starts.next_sync_start then null else limit_to_table_starts.sync_end end as sync_end,

        sum(case when records_modified_log.operation_type = 'REPLACED_OR_INSERTED' then records_modified_log.row_count else 0 end) as sum_rows_replaced_or_inserted,
        sum(case when records_modified_log.operation_type = 'UPDATED' then records_modified_log.row_count else 0 end) as sum_rows_updated,
        sum(case when records_modified_log.operation_type = 'DELETED' then records_modified_log.row_count else 0 end) as sum_rows_deleted

    from limit_to_table_starts

    left join records_modified_log on 
        limit_to_table_starts.connector_id = records_modified_log.connector_id
        and limit_to_table_starts.table_name = records_modified_log.table_name
        -- confine it to one sync
        and records_modified_log.created_at > limit_to_table_starts.sync_start 
        and records_modified_log.created_at < coalesce(limit_to_table_starts.sync_end, limit_to_table_starts.next_sync_start) 

    group by 1,2,3,4,5,6,7,8,9

),

surrogate_key as (

    select 
        *,
        md5(cast(coalesce(cast(connector_id as 
    varchar
), '') || '-' || coalesce(cast(destination_id as 
    varchar
), '') || '-' || coalesce(cast(table_name as 
    varchar
), '') || '-' || coalesce(cast(write_to_table_start as 
    varchar
), '') as 
    varchar
)) as unique_table_sync_key

    from sum_records_modified
)

select *
from surrogate_key
      );
00:50:39.192685 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.44 seconds
00:50:39.197994 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:39.198222 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp
00:50:39.352557 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.15 seconds
00:50:39.359307 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:39.359526 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table angel.workshop_live_fivetran_log.fivetran_log__audit_table
00:50:39.522736 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.16 seconds
00:50:39.535841 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:39.536069 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table "ANGEL"."WORKSHOP_LIVE_FIVETRAN_LOG"."FIVETRAN_LOG__AUDIT_TABLE"
00:50:39.675701 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.14 seconds
00:50:39.706462 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__audit_table"
00:50:39.708904 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:39.709106 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
begin;
00:50:39.928726 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
00:50:39.929421 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:39.929745 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: merge into angel.workshop_live_fivetran_log.fivetran_log__audit_table as DBT_INTERNAL_DEST
        using angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.unique_table_sync_key = DBT_INTERNAL_DEST.unique_table_sync_key
        

    
    when matched then update set
        "CONNECTOR_ID" = DBT_INTERNAL_SOURCE."CONNECTOR_ID","CONNECTOR_NAME" = DBT_INTERNAL_SOURCE."CONNECTOR_NAME","TABLE_NAME" = DBT_INTERNAL_SOURCE."TABLE_NAME","DESTINATION_ID" = DBT_INTERNAL_SOURCE."DESTINATION_ID","DESTINATION_NAME" = DBT_INTERNAL_SOURCE."DESTINATION_NAME","WRITE_TO_TABLE_START" = DBT_INTERNAL_SOURCE."WRITE_TO_TABLE_START","WRITE_TO_TABLE_END" = DBT_INTERNAL_SOURCE."WRITE_TO_TABLE_END","SYNC_START" = DBT_INTERNAL_SOURCE."SYNC_START","SYNC_END" = DBT_INTERNAL_SOURCE."SYNC_END","SUM_ROWS_REPLACED_OR_INSERTED" = DBT_INTERNAL_SOURCE."SUM_ROWS_REPLACED_OR_INSERTED","SUM_ROWS_UPDATED" = DBT_INTERNAL_SOURCE."SUM_ROWS_UPDATED","SUM_ROWS_DELETED" = DBT_INTERNAL_SOURCE."SUM_ROWS_DELETED","UNIQUE_TABLE_SYNC_KEY" = DBT_INTERNAL_SOURCE."UNIQUE_TABLE_SYNC_KEY"
    

    when not matched then insert
        ("CONNECTOR_ID", "CONNECTOR_NAME", "TABLE_NAME", "DESTINATION_ID", "DESTINATION_NAME", "WRITE_TO_TABLE_START", "WRITE_TO_TABLE_END", "SYNC_START", "SYNC_END", "SUM_ROWS_REPLACED_OR_INSERTED", "SUM_ROWS_UPDATED", "SUM_ROWS_DELETED", "UNIQUE_TABLE_SYNC_KEY")
    values
        ("CONNECTOR_ID", "CONNECTOR_NAME", "TABLE_NAME", "DESTINATION_ID", "DESTINATION_NAME", "WRITE_TO_TABLE_START", "WRITE_TO_TABLE_END", "SYNC_START", "SYNC_END", "SUM_ROWS_REPLACED_OR_INSERTED", "SUM_ROWS_UPDATED", "SUM_ROWS_DELETED", "UNIQUE_TABLE_SYNC_KEY")

;
00:50:40.740515 [debug] [Thread-1  ]: SQL status: SUCCESS 31 in 0.81 seconds
00:50:40.741030 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
00:50:40.741363 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: commit;
00:50:41.806707 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.07 seconds
00:50:41.809533 [debug] [Thread-1  ]: finished collecting timing info
00:50:41.809836 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: Close
00:50:42.266458 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120535100>]}
00:50:42.267040 [info ] [Thread-1  ]: 15 of 18 OK created incremental model workshop_live_fivetran_log.fivetran_log__audit_table [[32mSUCCESS 1[0m in 6.39s]
00:50:42.267553 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__audit_table
00:50:42.267893 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_daily_events
00:50:42.268256 [info ] [Thread-1  ]: 16 of 18 START table model workshop_live_fivetran_log.fivetran_log__connector_daily_events [RUN]
00:50:42.268987 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
00:50:42.269358 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_daily_events
00:50:42.269641 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_daily_events
00:50:42.285649 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
00:50:42.285920 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */

    
        select  min( signed_up ) as min_date from angel.fivetran_log.connector
00:50:42.286119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:43.022711 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.74 seconds
00:50:43.030741 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
00:50:43.030977 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


        select 

    datediff(
        day,
        cast('2020-08-12' as date),
        

    dateadd(
        week,
        1,
        
    date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)

        )


        )
00:50:43.307528 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.28 seconds
00:50:43.314389 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
00:50:43.315067 [debug] [Thread-1  ]: finished collecting timing info
00:50:43.315344 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_daily_events
00:50:43.319391 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
00:50:43.329436 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
00:50:43.329664 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__connector_daily_events  as
      (-- depends_on: angel.fivetran_log.connector

with connector as (
    
    select * 
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status
),

-- grab api calls, schema changes, and record modifications
log_events as (

    select 
        connector_id,
        cast( 
    date_trunc('day', created_at)
 as date) as date_day,
        case 
            when event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config') then 'schema_change' 
            else event_subtype end as event_subtype,

        sum(case when event_subtype = 'records_modified' then cast( 

  parse_json( message_data )['count'] as 
    int
 )
        else 1 end) as count_events 

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('api_call', 
                            'records_modified', 
                            'create_table', 'alter_table', 'create_schema', 'change_schema_config') -- all schema changes
                            
        and connector_id is not null

    group by 1,2,3
),

pivot_out_events as (

    select
        connector_id,
        date_day,
        max(case when event_subtype = 'api_call' then count_events else 0 end) as count_api_calls,
        max(case when event_subtype = 'records_modified' then count_events else 0 end) as count_record_modifications,
        max(case when event_subtype = 'schema_change' then count_events else 0 end) as count_schema_changes

    from log_events
    group by 1,2
),

connector_event_counts as (

    select
        pivot_out_events.date_day,
        pivot_out_events.count_api_calls,
        pivot_out_events.count_record_modifications,
        pivot_out_events.count_schema_changes,
        connector.connector_name,
        connector.connector_id,
        connector.connector_type,
        connector.destination_name,
        connector.destination_id,
        connector.set_up_at
    from
    connector left join pivot_out_events 
        on pivot_out_events.connector_id = connector.connector_id
),

spine as (

    
    
    
    
    

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 581
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2020-08-12' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= 

    dateadd(
        week,
        1,
        
    date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)

        )



)

select * from filtered

 
),

connector_event_history as (

    select
        cast(spine.date_day as date) as date_day,
        connector_event_counts.connector_name,
        connector_event_counts.connector_id,
        connector_event_counts.connector_type,
        connector_event_counts.destination_name,
        connector_event_counts.destination_id,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_api_calls
            else 0
        end) as count_api_calls,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_record_modifications
            else 0
        end) as count_record_modifications,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_schema_changes
            else 0
        end) as count_schema_changes
    from
    spine join connector_event_counts
        on spine.date_day  >= cast( 
    date_trunc('day', connector_event_counts.set_up_at)
 as date)

    group by 1,2,3,4,5,6
),

-- now rejoin spine to get a complete calendar
join_event_history as (
    
    select
        spine.date_day,
        connector_event_history.connector_name,
        connector_event_history.connector_id,
        connector_event_history.connector_type,
        connector_event_history.destination_name,
        connector_event_history.destination_id,
        max(connector_event_history.count_api_calls) as count_api_calls,
        max(connector_event_history.count_record_modifications) as count_record_modifications,
        max(connector_event_history.count_schema_changes) as count_schema_changes

    from
    spine left join connector_event_history
        on cast(spine.date_day as date) = connector_event_history.date_day

    group by 1,2,3,4,5,6
),

final as (

    select *
    from join_event_history

    where cast(date_day as timestamp) <= 
    current_timestamp::
    timestamp_ntz



    order by date_day desc
)

select *
from final
      );
00:50:45.541441 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.21 seconds
00:50:45.544103 [debug] [Thread-1  ]: finished collecting timing info
00:50:45.544399 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: Close
00:50:45.732293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207ed310>]}
00:50:45.732913 [info ] [Thread-1  ]: 16 of 18 OK created table model workshop_live_fivetran_log.fivetran_log__connector_daily_events [[32mSUCCESS 1[0m in 3.46s]
00:50:45.733433 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_daily_events
00:50:45.733739 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__schema_changelog
00:50:45.734203 [info ] [Thread-1  ]: 17 of 18 START table model workshop_live_fivetran_log.fivetran_log__schema_changelog [RUN]
00:50:45.734892 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
00:50:45.735166 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__schema_changelog
00:50:45.735386 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__schema_changelog
00:50:45.743197 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
00:50:45.743904 [debug] [Thread-1  ]: finished collecting timing info
00:50:45.744261 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__schema_changelog
00:50:45.747704 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
00:50:45.750493 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
00:50:45.750716 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__schema_changelog: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__schema_changelog"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__schema_changelog  as
      (with schema_changes as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config')
),

connector as (

    select *
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status
),

add_connector_info as (

    select 
        schema_changes.*,
        connector.connector_name,
        connector.destination_id,
        connector.destination_name

    from schema_changes join connector using(connector_id)
),

final as (

    select
        connector_id,
        connector_name,
        destination_id,
        destination_name,
        created_at,
        event_subtype,
        message_data,

        case 
        when event_subtype = 'alter_table' then 

  parse_json( message_data )['table'] 
        when event_subtype = 'create_table' then 

  parse_json( message_data )['name'] 
        else null end as table_name,

        case 
        when event_subtype = 'create_schema' or event_subtype = 'create_table' then 

  parse_json( message_data )['schema'] 
        else null end as schema_name
    
    from add_connector_info
)

select * from final
order by created_at desc, connector_id
      );
00:50:45.750923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:48.612867 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.86 seconds
00:50:48.615450 [debug] [Thread-1  ]: finished collecting timing info
00:50:48.615751 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__schema_changelog: Close
00:50:48.841300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120691160>]}
00:50:48.841882 [info ] [Thread-1  ]: 17 of 18 OK created table model workshop_live_fivetran_log.fivetran_log__schema_changelog [[32mSUCCESS 1[0m in 3.11s]
00:50:48.842402 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__schema_changelog
00:50:48.842705 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__credit_mar_destination_history
00:50:48.843050 [info ] [Thread-1  ]: 18 of 18 START table model workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history [RUN]
00:50:48.843894 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
00:50:48.844173 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__credit_mar_destination_history
00:50:48.844431 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__credit_mar_destination_history
00:50:48.848908 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
00:50:48.849596 [debug] [Thread-1  ]: finished collecting timing info
00:50:48.849847 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__credit_mar_destination_history
00:50:48.853598 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
00:50:48.857062 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
00:50:48.857302 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__credit_mar_destination_history: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__credit_mar_destination_history"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history  as
      (with table_mar as (
    
    select *
    from angel.workshop_live_fivetran_log.fivetran_log__mar_table_history
),

destination_mar as (

    select 
        measured_month,
        destination_id,
        destination_name,
        sum(monthly_active_rows) as monthly_active_rows
    
    from table_mar
    group by 1,2,3
),

credits_used as (

    select 
        destination_id,
        credits_consumed,
        cast(concat(measured_month, '-01') as date) as measured_month -- match date format to join with MAR table

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used
),

join_credits_mar as (

    select 
        destination_mar.measured_month,
        destination_mar.destination_id,
        destination_mar.destination_name,
        credits_used.credits_consumed,
        destination_mar.monthly_active_rows,
        round( nullif(credits_used.credits_consumed,0) * 1000000.0 / nullif(destination_mar.monthly_active_rows,0), 2) as credits_per_million_mar,
        round( nullif(destination_mar.monthly_active_rows,0) * 1.0 / nullif(credits_used.credits_consumed,0), 0) as mar_per_credit

    from 
    destination_mar left join credits_used 
        on destination_mar.measured_month = cast(credits_used.measured_month as timestamp)
        and destination_mar.destination_id = credits_used.destination_id

)

select * from join_credits_mar
order by measured_month desc
      );
00:50:48.857513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:50.865115 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.01 seconds
00:50:50.867893 [debug] [Thread-1  ]: finished collecting timing info
00:50:50.868196 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__credit_mar_destination_history: Close
00:50:51.001137 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ba4e8ce-df9b-4a85-8158-aee9e8495bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120319970>]}
00:50:51.001849 [info ] [Thread-1  ]: 18 of 18 OK created table model workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history [[32mSUCCESS 1[0m in 2.16s]
00:50:51.002391 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__credit_mar_destination_history
00:50:51.003925 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:50:51.004584 [info ] [MainThread]: 
00:50:51.005040 [info ] [MainThread]: Finished running 15 table models, 2 view models, 1 incremental model in 59.28s.
00:50:51.005415 [debug] [MainThread]: Connection 'master' was properly closed.
00:50:51.005617 [debug] [MainThread]: Connection 'model.fivetran_log.fivetran_log__credit_mar_destination_history' was properly closed.
00:50:51.025884 [info ] [MainThread]: 
00:50:51.026367 [info ] [MainThread]: [32mCompleted successfully[0m
00:50:51.027095 [info ] [MainThread]: 
00:50:51.027559 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
00:50:51.028100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206a82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120323190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12074b6a0>]}


============================== 2022-03-10 17:04:44.949379 | f4cd9949-1cb9-4866-b498-367834940327 ==============================
17:04:44.949379 [info ] [MainThread]: Running with dbt=1.0.1
17:04:44.950153 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:04:44.950421 [debug] [MainThread]: Tracking: tracking
17:04:44.980212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e65de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e663490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e766a00>]}
17:04:46.146053 [debug] [MainThread]: Executing "git --help"
17:04:46.159375 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:04:46.160421 [debug] [MainThread]: STDERR: "b''"
17:04:46.169115 [debug] [MainThread]: Acquiring new snowflake connection "debug"
17:04:46.171928 [debug] [MainThread]: Using snowflake connection "debug"
17:04:46.172272 [debug] [MainThread]: On debug: select 1 as id
17:04:46.172556 [debug] [MainThread]: Opening a new connection, currently in state init
17:04:47.084352 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.91 seconds
17:04:47.085919 [debug] [MainThread]: On debug: Close
17:04:47.246396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224fbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12250dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e65db50>]}
17:04:47.602899 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-03-10 17:18:14.955531 | d79595ee-72a3-4c5c-aadd-efc94678179e ==============================
17:18:14.955531 [info ] [MainThread]: Running with dbt=1.0.1
17:18:14.955969 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:18:14.956197 [debug] [MainThread]: Tracking: tracking
17:18:14.978754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104322b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104329040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442c8e0>]}
17:18:15.900533 [debug] [MainThread]: Executing "git --help"
17:18:15.914532 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:18:15.915534 [debug] [MainThread]: STDERR: "b''"
17:18:15.923330 [debug] [MainThread]: Acquiring new snowflake connection "debug"
17:18:15.926066 [debug] [MainThread]: Using snowflake connection "debug"
17:18:15.926432 [debug] [MainThread]: On debug: select 1 as id
17:18:15.926805 [debug] [MainThread]: Opening a new connection, currently in state init
17:18:17.340241 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.41 seconds
17:18:17.341612 [debug] [MainThread]: On debug: Close
17:18:17.571457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e11ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104444b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e060c10>]}
17:18:17.897443 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-03-10 17:22:53.043847 | da0b0b95-a811-43f2-8ce6-86e65243ba64 ==============================
17:22:53.043847 [info ] [MainThread]: Running with dbt=1.0.1
17:22:53.044325 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
17:22:53.044575 [debug] [MainThread]: Tracking: tracking
17:22:53.044842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88df0>]}
17:22:53.046481 [debug] [MainThread]: Set downloads directory='/var/folders/mk/2ztnrxy17z11rwb071p5c8c80000gp/T/dbt-downloads-xok48pvj'
17:22:53.047056 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
17:22:53.105060 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
17:22:53.105499 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json
17:22:53.138462 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json 200
17:22:53.141578 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json
17:22:53.172734 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json 200
17:22:53.173347 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
17:22:53.211215 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
17:22:53.221430 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json
17:22:53.257802 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json 200
17:22:53.258450 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
17:22:53.300060 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
17:22:53.303472 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json
17:22:53.338190 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json 200
17:22:53.338722 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:22:53.370087 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:22:53.405087 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json
17:22:53.440939 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json 200
17:22:53.441315 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json
17:22:53.476013 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json 200
17:22:53.479130 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
17:22:53.513374 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
17:22:53.523520 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
17:22:53.555079 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
17:22:53.558948 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:22:53.589820 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:22:53.623866 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json
17:22:53.658730 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.2.json 200
17:22:53.659135 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json
17:22:53.693213 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.4.json 200
17:22:53.693582 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json
17:22:53.729828 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json 200
17:22:53.730157 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json
17:22:53.761948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.2.json 200
17:22:53.762420 [info ] [MainThread]: Installing fivetran/fivetran_log
17:22:54.264652 [info ] [MainThread]:   Installed from version 0.5.2
17:22:54.265496 [info ] [MainThread]:   Up to date!
17:22:54.266305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da0b0b95-a811-43f2-8ce6-86e65243ba64', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca882e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88cd0>]}
17:22:54.266910 [info ] [MainThread]: Installing fivetran/fivetran_utils
17:22:54.591184 [info ] [MainThread]:   Installed from version 0.3.4
17:22:54.591649 [info ] [MainThread]:   Up to date!
17:22:54.592033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da0b0b95-a811-43f2-8ce6-86e65243ba64', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a6c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a6eb0>]}
17:22:54.592333 [info ] [MainThread]: Installing dbt-labs/spark_utils
17:22:54.854613 [info ] [MainThread]:   Installed from version 0.3.0
17:22:54.855031 [info ] [MainThread]:   Up to date!
17:22:54.855441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da0b0b95-a811-43f2-8ce6-86e65243ba64', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a6400>]}
17:22:54.855728 [info ] [MainThread]: Installing dbt-labs/dbt_utils
17:22:55.325000 [info ] [MainThread]:   Installed from version 0.8.2
17:22:55.325575 [info ] [MainThread]:   Up to date!
17:22:55.326116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da0b0b95-a811-43f2-8ce6-86e65243ba64', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a6e20>]}
17:22:55.329340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a6340>]}


============================== 2022-03-10 17:26:09.949864 | 5d09d008-96f4-4397-8520-44b8f60047bf ==============================
17:26:09.949864 [info ] [MainThread]: Running with dbt=1.0.1
17:26:09.951077 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
17:26:09.951389 [debug] [MainThread]: Tracking: tracking
17:26:09.951894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d34a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d34a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d34a8b0>]}
17:26:10.112788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:26:10.113090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:26:10.124668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d09d008-96f4-4397-8520-44b8f60047bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ded40d0>]}
17:26:10.148732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d09d008-96f4-4397-8520-44b8f60047bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d765790>]}
17:26:10.149127 [info ] [MainThread]: Found 18 models, 23 tests, 0 snapshots, 0 analyses, 479 macros, 0 operations, 0 seed files, 11 sources, 0 exposures, 0 metrics
17:26:10.153472 [info ] [MainThread]: 
17:26:10.154124 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:26:10.156229 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live"
17:26:10.174438 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live"
17:26:10.174744 [debug] [ThreadPool]: On list_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live"} */

    show terse objects in angel.workshop_live
17:26:10.174962 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:26:11.010415 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.84 seconds
17:26:11.012523 [debug] [ThreadPool]: On list_angel_workshop_live: Close
17:26:11.221446 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_fivetran_log"
17:26:11.224797 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_fivetran_log"
17:26:11.225031 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_fivetran_log"} */

    show terse objects in angel.workshop_live_fivetran_log
17:26:11.225223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:26:11.946753 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.72 seconds
17:26:11.948740 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: Close
17:26:12.133776 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_stg_fivetran_log"
17:26:12.138213 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_stg_fivetran_log"
17:26:12.138498 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_stg_fivetran_log"} */

    show terse objects in angel.workshop_live_stg_fivetran_log
17:26:12.138709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:26:12.923539 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.78 seconds
17:26:12.925758 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: Close
17:26:13.207272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:26:13.207733 [info ] [MainThread]: 
17:26:13.212892 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account
17:26:13.213737 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account"
17:26:13.213980 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account
17:26:13.214230 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account
17:26:13.223085 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account"
17:26:13.223815 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.224105 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account
17:26:13.224369 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.224818 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account
17:26:13.225078 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account_membership
17:26:13.225606 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
17:26:13.225961 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account_membership
17:26:13.226212 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account_membership
17:26:13.232536 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
17:26:13.233575 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.233816 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account_membership
17:26:13.234086 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.234673 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account_membership
17:26:13.234960 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__active_volume
17:26:13.235736 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
17:26:13.236159 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__active_volume
17:26:13.236489 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__active_volume
17:26:13.243541 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
17:26:13.244200 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.244431 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__active_volume
17:26:13.244651 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.245071 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__active_volume
17:26:13.245323 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector_tmp
17:26:13.245895 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
17:26:13.246132 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector_tmp
17:26:13.246338 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector_tmp
17:26:13.250732 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
17:26:13.251356 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.251590 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector_tmp
17:26:13.251815 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.252245 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector_tmp
17:26:13.252501 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__credits_used
17:26:13.253115 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
17:26:13.253333 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__credits_used
17:26:13.253545 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__credits_used
17:26:13.258269 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
17:26:13.259576 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.259836 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__credits_used
17:26:13.260064 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.260501 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__credits_used
17:26:13.260757 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination
17:26:13.261392 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
17:26:13.261671 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination
17:26:13.261893 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination
17:26:13.268078 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination"
17:26:13.268742 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.268984 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination
17:26:13.269211 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.269664 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination
17:26:13.269927 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination_membership
17:26:13.270566 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
17:26:13.270840 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination_membership
17:26:13.271138 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination_membership
17:26:13.277412 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
17:26:13.277999 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.278242 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination_membership
17:26:13.278459 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.278868 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination_membership
17:26:13.279132 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__log
17:26:13.279726 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__log"
17:26:13.279956 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__log
17:26:13.280159 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__log
17:26:13.285314 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__log"
17:26:13.285874 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.286090 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__log
17:26:13.286299 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.286718 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__log
17:26:13.286969 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__user
17:26:13.287344 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__user"
17:26:13.287869 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__user
17:26:13.288110 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__user
17:26:13.293621 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__user"
17:26:13.294340 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.294707 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__user
17:26:13.294938 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.295382 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__user
17:26:13.295630 [debug] [Thread-1  ]: Began running node model.workshop_live.my_first_dbt_model
17:26:13.296462 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_first_dbt_model"
17:26:13.296808 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_first_dbt_model
17:26:13.297046 [debug] [Thread-1  ]: Compiling model.workshop_live.my_first_dbt_model
17:26:13.302666 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_first_dbt_model"
17:26:13.303404 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.303655 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_first_dbt_model
17:26:13.303881 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.304341 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_first_dbt_model
17:26:13.304651 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
17:26:13.305426 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
17:26:13.305673 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
17:26:13.305887 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
17:26:13.319606 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
17:26:13.320329 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.320548 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
17:26:13.320757 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.321164 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
17:26:13.321422 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
17:26:13.321947 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
17:26:13.322160 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
17:26:13.322360 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
17:26:13.331211 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
17:26:13.331855 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.332078 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
17:26:13.332280 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.332704 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
17:26:13.332945 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
17:26:13.333396 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
17:26:13.333593 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
17:26:13.333784 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
17:26:13.348157 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
17:26:13.348773 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.348994 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
17:26:13.349228 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.349666 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
17:26:13.349916 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
17:26:13.350504 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
17:26:13.350728 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
17:26:13.350929 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
17:26:13.357307 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
17:26:13.357999 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.358220 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
17:26:13.358430 [debug] [Thread-1  ]: finished collecting timing info
17:26:13.358828 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
17:26:13.359067 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector
17:26:13.359587 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
17:26:13.359798 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector
17:26:13.359995 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector
17:26:13.377595 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
17:26:13.377870 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */

    describe table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp
17:26:13.378062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:26:13.970824 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.59 seconds
17:26:14.006056 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector"
17:26:14.006625 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.006834 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector
17:26:14.007045 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.007276 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: Close
17:26:14.190684 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector
17:26:14.191024 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
17:26:14.191681 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
17:26:14.191929 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
17:26:14.192161 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
17:26:14.201266 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
17:26:14.202013 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.202370 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
17:26:14.202605 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.203056 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
17:26:14.203321 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
17:26:14.203804 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
17:26:14.204036 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
17:26:14.204334 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
17:26:14.210694 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
17:26:14.211287 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.211521 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
17:26:14.211745 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.212290 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
17:26:14.212696 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
17:26:14.213197 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
17:26:14.213435 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
17:26:14.213650 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
17:26:14.220066 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
17:26:14.220697 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.220918 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
17:26:14.221128 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.221559 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
17:26:14.221815 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
17:26:14.222351 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
17:26:14.222577 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
17:26:14.222839 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
17:26:14.232327 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
17:26:14.232974 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.233208 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
17:26:14.233432 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.233869 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
17:26:14.234129 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
17:26:14.234645 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
17:26:14.234882 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
17:26:14.235272 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
17:26:14.297806 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
17:26:14.298753 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.299048 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
17:26:14.299285 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.299769 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
17:26:14.300094 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
17:26:14.300689 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
17:26:14.300997 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
17:26:14.301217 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
17:26:14.308059 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
17:26:14.308784 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.309038 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
17:26:14.309430 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.310079 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
17:26:14.310346 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
17:26:14.310873 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
17:26:14.311098 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
17:26:14.311310 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
17:26:14.317287 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
17:26:14.318167 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.318439 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
17:26:14.318737 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.319235 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
17:26:14.319500 [debug] [Thread-1  ]: Began running node model.workshop_live.my_second_dbt_model
17:26:14.319882 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_second_dbt_model"
17:26:14.320101 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_second_dbt_model
17:26:14.320310 [debug] [Thread-1  ]: Compiling model.workshop_live.my_second_dbt_model
17:26:14.323937 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_second_dbt_model"
17:26:14.324524 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.324749 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_second_dbt_model
17:26:14.324967 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.325381 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_second_dbt_model
17:26:14.325632 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
17:26:14.325998 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
17:26:14.326207 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
17:26:14.326622 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
17:26:14.332213 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
17:26:14.333436 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.333677 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
17:26:14.333900 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.334412 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
17:26:14.334673 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
17:26:14.335191 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
17:26:14.335625 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
17:26:14.335860 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_first_dbt_model_id.16e066b321
17:26:14.341762 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
17:26:14.342582 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.342984 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
17:26:14.343362 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.343868 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
17:26:14.344129 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_status
17:26:14.344507 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_status"
17:26:14.344719 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_status
17:26:14.344927 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_status
17:26:14.396069 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_status"
17:26:14.397002 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.397539 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_status
17:26:14.397897 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.398490 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_status
17:26:14.398771 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__mar_table_history
17:26:14.399365 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
17:26:14.399901 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__mar_table_history
17:26:14.400355 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__mar_table_history
17:26:14.414591 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
17:26:14.415684 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.416111 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__mar_table_history
17:26:14.416494 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.417279 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__mar_table_history
17:26:14.417766 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
17:26:14.418508 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
17:26:14.418950 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
17:26:14.419430 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
17:26:14.431974 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
17:26:14.433018 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.433533 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
17:26:14.434205 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.434946 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
17:26:14.435411 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
17:26:14.436414 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
17:26:14.436784 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
17:26:14.437040 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
17:26:14.445075 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
17:26:14.445910 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.446237 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
17:26:14.446472 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.446931 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
17:26:14.447255 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
17:26:14.447692 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
17:26:14.447914 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
17:26:14.448361 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
17:26:14.455637 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
17:26:14.456790 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.457351 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
17:26:14.457814 [debug] [Thread-1  ]: finished collecting timing info
17:26:14.458639 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
17:26:14.459097 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__audit_table
17:26:14.460009 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:26:14.460404 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__audit_table
17:26:14.460787 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__audit_table
17:26:14.499544 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:26:14.499843 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
select date(max(sync_start)) from angel.workshop_live_fivetran_log.fivetran_log__audit_table
17:26:14.500049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:26:15.255634 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.76 seconds
17:26:15.279386 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__audit_table"
17:26:15.280023 [debug] [Thread-1  ]: finished collecting timing info
17:26:15.280246 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__audit_table
17:26:15.280463 [debug] [Thread-1  ]: finished collecting timing info
17:26:15.280675 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: Close
17:26:15.412570 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__audit_table
17:26:15.412899 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_daily_events
17:26:15.413554 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
17:26:15.413793 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_daily_events
17:26:15.414002 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_daily_events
17:26:15.430726 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
17:26:15.431083 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */

    
        select  min( signed_up ) as min_date from angel.fivetran_log.connector
17:26:15.431358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:26:16.364334 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
17:26:16.386015 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
17:26:16.386284 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


        select 

    datediff(
        day,
        cast('2020-08-12' as date),
        

    dateadd(
        week,
        1,
        
    date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)

        )


        )
17:26:16.616845 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.23 seconds
17:26:16.633546 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
17:26:16.634378 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.634656 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_daily_events
17:26:16.634899 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.635145 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: Close
17:26:16.787320 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_daily_events
17:26:16.787647 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__schema_changelog
17:26:16.788237 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
17:26:16.788464 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__schema_changelog
17:26:16.788667 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__schema_changelog
17:26:16.796211 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
17:26:16.796871 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.797101 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__schema_changelog
17:26:16.797357 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.797784 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__schema_changelog
17:26:16.798138 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
17:26:16.798742 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
17:26:16.798988 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
17:26:16.799310 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
17:26:16.807556 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
17:26:16.808290 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.808530 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
17:26:16.808756 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.809204 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
17:26:16.809474 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__credit_mar_destination_history
17:26:16.809944 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
17:26:16.810154 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__credit_mar_destination_history
17:26:16.810353 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__credit_mar_destination_history
17:26:16.814627 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
17:26:16.815209 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.815434 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__credit_mar_destination_history
17:26:16.815647 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.816066 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__credit_mar_destination_history
17:26:16.816317 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
17:26:16.816883 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
17:26:16.817099 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
17:26:16.817314 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
17:26:16.824873 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
17:26:16.825611 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.825953 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
17:26:16.826179 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.826598 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
17:26:16.826845 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
17:26:16.827371 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
17:26:16.827587 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
17:26:16.827786 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
17:26:16.833527 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
17:26:16.834154 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.834392 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
17:26:16.834604 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.835042 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
17:26:16.835299 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
17:26:16.835806 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
17:26:16.836053 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
17:26:16.836296 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
17:26:16.842470 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
17:26:16.843173 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.843413 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
17:26:16.843631 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.844049 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
17:26:16.844294 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
17:26:16.844740 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
17:26:16.844951 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
17:26:16.845152 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
17:26:16.853028 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
17:26:16.853677 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.853900 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
17:26:16.854127 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.854608 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
17:26:16.854891 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
17:26:16.855361 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a"
17:26:16.855574 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
17:26:16.855778 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
17:26:16.863365 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a"
17:26:16.864039 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.864289 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
17:26:16.864511 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.864956 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
17:26:16.865209 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
17:26:16.865666 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
17:26:16.865876 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
17:26:16.866080 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
17:26:16.874961 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
17:26:16.875607 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.875825 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
17:26:16.876038 [debug] [Thread-1  ]: finished collecting timing info
17:26:16.876447 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
17:26:16.877586 [debug] [MainThread]: Connection 'master' was properly closed.
17:26:16.877826 [debug] [MainThread]: Connection 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2' was properly closed.
17:26:16.897546 [info ] [MainThread]: Done.
17:26:16.900903 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
17:26:16.901222 [info ] [MainThread]: Building catalog
17:26:16.907420 [debug] [ThreadPool]: Acquiring new snowflake connection "angel.information_schema"
17:26:16.918679 [debug] [ThreadPool]: Using snowflake connection "angel.information_schema"
17:26:16.918982 [debug] [ThreadPool]: On angel.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "angel.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from angel.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from angel.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('workshop_live_stg_fivetran_log') or upper("table_schema") = upper('fivetran_log') or upper("table_schema") = upper('workshop_live') or upper("table_schema") = upper('workshop_live_fivetran_log'))
      order by "column_index"
17:26:16.919193 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:26:37.945422 [debug] [ThreadPool]: SQL status: SUCCESS 227 in 21.03 seconds
17:26:38.383431 [debug] [ThreadPool]: On angel.information_schema: Close
17:26:38.605303 [info ] [MainThread]: Catalog written to /Users/angel.hernandez/Fivetran/dbt/workshop_live/target/catalog.json
17:26:38.606096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d34a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e28c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0468e0>]}
17:26:38.935309 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
17:26:38.935654 [debug] [MainThread]: Connection 'angel.information_schema' was properly closed.


============================== 2022-03-10 17:26:42.837181 | 061ceb8f-2616-4d19-8066-0034f53cf3bc ==============================
17:26:42.837181 [info ] [MainThread]: Running with dbt=1.0.1
17:26:42.838293 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
17:26:42.838606 [debug] [MainThread]: Tracking: tracking
17:26:42.839103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb73fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb73460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb732e0>]}
17:26:42.841778 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
17:26:42.842529 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
17:26:42.843183 [info ] [MainThread]: 
17:26:42.843587 [info ] [MainThread]: 
17:26:42.843948 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-03-10 17:38:23.652268 | 482c4be5-88f4-4a81-ac60-b13a9cbb5988 ==============================
17:38:23.652268 [info ] [MainThread]: Running with dbt=1.0.1
17:38:23.653312 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fivetran_log'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:38:23.653628 [debug] [MainThread]: Tracking: tracking
17:38:23.654161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236259a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123625550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123625c70>]}
17:38:23.810030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:38:23.810321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:38:23.822097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241d50d0>]}
17:38:23.845200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236fe0d0>]}
17:38:23.845622 [info ] [MainThread]: Found 18 models, 23 tests, 0 snapshots, 0 analyses, 479 macros, 0 operations, 0 seed files, 11 sources, 0 exposures, 0 metrics
17:38:23.849021 [info ] [MainThread]: 
17:38:23.849658 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:38:23.851528 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel"
17:38:23.870466 [debug] [ThreadPool]: Using snowflake connection "list_angel"
17:38:23.870751 [debug] [ThreadPool]: On list_angel: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel"} */

    show terse schemas in database angel
    limit 10000
17:38:23.870961 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:38:25.090363 [debug] [ThreadPool]: SQL status: SUCCESS 102 in 1.22 seconds
17:38:25.096105 [debug] [ThreadPool]: On list_angel: Close
17:38:25.255630 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel"
17:38:25.258807 [debug] [ThreadPool]: Using snowflake connection "list_angel"
17:38:25.259041 [debug] [ThreadPool]: On list_angel: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel"} */

    show terse schemas in database angel
    limit 10000
17:38:25.259230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:38:26.246873 [debug] [ThreadPool]: SQL status: SUCCESS 102 in 0.99 seconds
17:38:26.252299 [debug] [ThreadPool]: On list_angel: Close
17:38:26.439816 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_fivetran_log"
17:38:26.449770 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_fivetran_log"
17:38:26.450048 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_fivetran_log"} */

    show terse objects in angel.workshop_live_fivetran_log
17:38:26.450249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:38:27.293948 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.84 seconds
17:38:27.295916 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: Close
17:38:27.510560 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live"
17:38:27.514350 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live"
17:38:27.514626 [debug] [ThreadPool]: On list_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live"} */

    show terse objects in angel.workshop_live
17:38:27.514828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:38:28.114092 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.6 seconds
17:38:28.116035 [debug] [ThreadPool]: On list_angel_workshop_live: Close
17:38:28.346842 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_stg_fivetran_log"
17:38:28.350838 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_stg_fivetran_log"
17:38:28.351115 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_stg_fivetran_log"} */

    show terse objects in angel.workshop_live_stg_fivetran_log
17:38:28.351315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:38:29.051201 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.7 seconds
17:38:29.053252 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: Close
17:38:29.185086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:38:29.185532 [info ] [MainThread]: 
17:38:29.190587 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account
17:38:29.190993 [info ] [Thread-1  ]: 1 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__account [RUN]
17:38:29.191590 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account"
17:38:29.191806 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account
17:38:29.192029 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account
17:38:29.201635 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account"
17:38:29.202611 [debug] [Thread-1  ]: finished collecting timing info
17:38:29.202903 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account
17:38:29.244581 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__account"
17:38:29.246292 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__account"
17:38:29.246546 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__account"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__account  as
      (with account as (
    
    select * from angel.fivetran_log.account

),

fields as (

    select
        id as account_id,
        country,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        name as account_name,
        status
        
    from account

)

select * from fields
      );
17:38:29.246744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:31.000527 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.75 seconds
17:38:31.015305 [debug] [Thread-1  ]: finished collecting timing info
17:38:31.015625 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account: Close
17:38:31.186341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244f8a00>]}
17:38:31.186906 [info ] [Thread-1  ]: 1 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__account [[32mSUCCESS 1[0m in 1.99s]
17:38:31.187465 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account
17:38:31.187783 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account_membership
17:38:31.188323 [info ] [Thread-1  ]: 2 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership [RUN]
17:38:31.189185 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
17:38:31.189489 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account_membership
17:38:31.189722 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account_membership
17:38:31.196624 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
17:38:31.197361 [debug] [Thread-1  ]: finished collecting timing info
17:38:31.197618 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account_membership
17:38:31.203033 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
17:38:31.204797 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
17:38:31.205110 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account_membership: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__account_membership"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership  as
      (with account_membership as (
    
    select * from angel.fivetran_log.account_membership

),

fields as (

    select
        account_id,
        user_id,
        cast(activated_at as 
    timestamp_ntz
) as activated_at,
        cast(joined_at as 
    timestamp_ntz
) as joined_at,
        role as account_role
        
    from account_membership
    
)

select * from fields
      );
17:38:31.205332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:33.391876 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.19 seconds
17:38:33.394114 [debug] [Thread-1  ]: finished collecting timing info
17:38:33.394394 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account_membership: Close
17:38:33.583727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245712b0>]}
17:38:33.584219 [info ] [Thread-1  ]: 2 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership [[32mSUCCESS 1[0m in 2.39s]
17:38:33.584676 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account_membership
17:38:33.584945 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__active_volume
17:38:33.585237 [info ] [Thread-1  ]: 3 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume [RUN]
17:38:33.585812 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
17:38:33.586126 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__active_volume
17:38:33.586344 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__active_volume
17:38:33.592677 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
17:38:33.593535 [debug] [Thread-1  ]: finished collecting timing info
17:38:33.594023 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__active_volume
17:38:33.598374 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
17:38:33.600332 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
17:38:33.600585 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__active_volume: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__active_volume"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume  as
      (with active_volume as (

    select * from angel.fivetran_log.active_volume

),

fields as (

    select
        id as active_volume_id,
        connector_id as connector_name, -- Note: this misnomer will be changed by Fivetran soon
        destination_id,
        cast(measured_at as 
    timestamp_ntz
) as measured_at,
        monthly_active_rows,
        schema_name,
        table_name
    
    from active_volume
)

select * from fields
      );
17:38:33.600793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:35.420353 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.82 seconds
17:38:35.422461 [debug] [Thread-1  ]: finished collecting timing info
17:38:35.422749 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__active_volume: Close
17:38:35.598629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12453b0a0>]}
17:38:35.599161 [info ] [Thread-1  ]: 3 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume [[32mSUCCESS 1[0m in 2.01s]
17:38:35.599668 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__active_volume
17:38:35.600060 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector_tmp
17:38:35.600595 [info ] [Thread-1  ]: 4 of 16 START view model workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp [RUN]
17:38:35.601247 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
17:38:35.601563 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector_tmp
17:38:35.601907 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector_tmp
17:38:35.607162 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
17:38:35.608191 [debug] [Thread-1  ]: finished collecting timing info
17:38:35.608490 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector_tmp
17:38:35.638975 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
17:38:35.640120 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
17:38:35.640351 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector_tmp: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector_tmp"} */

  create or replace  view angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp 
  
   as (
    select *
from angel.fivetran_log.connector
  );
17:38:35.640551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:36.647100 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.01 seconds
17:38:36.649373 [debug] [Thread-1  ]: finished collecting timing info
17:38:36.649680 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector_tmp: Close
17:38:36.808314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124594100>]}
17:38:36.808828 [info ] [Thread-1  ]: 4 of 16 OK created view model workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp [[32mSUCCESS 1[0m in 1.21s]
17:38:36.809269 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector_tmp
17:38:36.809582 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__credits_used
17:38:36.810067 [info ] [Thread-1  ]: 5 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used [RUN]
17:38:36.810769 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
17:38:36.810983 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__credits_used
17:38:36.811195 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__credits_used
17:38:36.817222 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
17:38:36.817976 [debug] [Thread-1  ]: finished collecting timing info
17:38:36.818216 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__credits_used
17:38:36.821874 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
17:38:36.823249 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
17:38:36.823469 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__credits_used: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__credits_used"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used  as
      (with  credits_used as (

    select * from angel.fivetran_log.credits_used

),

fields as (
    
    select 
        destination_id,
        measured_month,
        credits_consumed
    
    from credits_used
)

select * from fields
      );
17:38:36.823666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:38.333458 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.51 seconds
17:38:38.335854 [debug] [Thread-1  ]: finished collecting timing info
17:38:38.336152 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__credits_used: Close
17:38:38.518401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124594a00>]}
17:38:38.518890 [info ] [Thread-1  ]: 5 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used [[32mSUCCESS 1[0m in 1.71s]
17:38:38.519323 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__credits_used
17:38:38.519583 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination
17:38:38.519999 [info ] [Thread-1  ]: 6 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination [RUN]
17:38:38.520575 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
17:38:38.520796 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination
17:38:38.521008 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination
17:38:38.526723 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination"
17:38:38.527457 [debug] [Thread-1  ]: finished collecting timing info
17:38:38.527719 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination
17:38:38.532436 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__destination"
17:38:38.534212 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
17:38:38.534504 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__destination"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination  as
      (with destination as (

    select * from angel.fivetran_log.destination

),

fields as (

    select
        id as destination_id,
        account_id,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        name as destination_name,
        region
    
    from destination
)

select * from fields
      );
17:38:38.534734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:40.689517 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.15 seconds
17:38:40.691789 [debug] [Thread-1  ]: finished collecting timing info
17:38:40.692104 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination: Close
17:38:40.917006 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236f27f0>]}
17:38:40.917602 [info ] [Thread-1  ]: 6 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination [[32mSUCCESS 1[0m in 2.40s]
17:38:40.918052 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination
17:38:40.918308 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination_membership
17:38:40.918813 [info ] [Thread-1  ]: 7 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership [RUN]
17:38:40.919451 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
17:38:40.919673 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination_membership
17:38:40.919889 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination_membership
17:38:40.926364 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
17:38:40.927208 [debug] [Thread-1  ]: finished collecting timing info
17:38:40.927636 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination_membership
17:38:40.931413 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
17:38:40.933188 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
17:38:40.933438 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination_membership: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__destination_membership"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership  as
      (with destination_membership as (
    
    select * from angel.fivetran_log.destination_membership

),

fields as (

    select
        destination_id,
        user_id,
        cast(activated_at as 
    timestamp_ntz
) as activated_at,
        cast(joined_at as 
    timestamp_ntz
) as joined_at,
        role as destination_role
        
    from destination_membership
)

select * from fields
      );
17:38:40.933648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:43.061793 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.13 seconds
17:38:43.063821 [debug] [Thread-1  ]: finished collecting timing info
17:38:43.064082 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination_membership: Close
17:38:43.248358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236f2310>]}
17:38:43.248867 [info ] [Thread-1  ]: 7 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership [[32mSUCCESS 1[0m in 2.33s]
17:38:43.249325 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination_membership
17:38:43.249587 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__log
17:38:43.249879 [info ] [Thread-1  ]: 8 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__log.. [RUN]
17:38:43.250545 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__log"
17:38:43.250759 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__log
17:38:43.250969 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__log
17:38:43.257134 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__log"
17:38:43.257850 [debug] [Thread-1  ]: finished collecting timing info
17:38:43.258096 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__log
17:38:43.262307 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__log"
17:38:43.264817 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__log"
17:38:43.265239 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__log"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log  as
      (with log as (

    select * from angel.fivetran_log.log
    
),

fields as (

    select
        id as log_id, 
        cast(time_stamp as 
    timestamp_ntz
) as created_at,
        connector_id, -- Note: the connector_id column used to erroneously equal the connector_name, NOT its id.
        case when transformation_id is not null and event is null then 'TRANSFORMATION'
        else event end as event_type, 
        message_data,
        case 
        when transformation_id is not null and message_data like '%has succeeded%' then 'transformation run success'
        when transformation_id is not null and message_data like '%has failed%' then 'transformation run failed'
        else message_event end as event_subtype,
        transformation_id

    from log
)

select * from fields
      );
17:38:43.265465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:45.493059 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.23 seconds
17:38:45.495428 [debug] [Thread-1  ]: finished collecting timing info
17:38:45.495718 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__log: Close
17:38:45.676695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243d9ca0>]}
17:38:45.677229 [info ] [Thread-1  ]: 8 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__log [[32mSUCCESS 1[0m in 2.43s]
17:38:45.677675 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__log
17:38:45.677937 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__user
17:38:45.678497 [info ] [Thread-1  ]: 9 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__user. [RUN]
17:38:45.679219 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__user"
17:38:45.679465 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__user
17:38:45.679684 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__user
17:38:45.685495 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__user"
17:38:45.686143 [debug] [Thread-1  ]: finished collecting timing info
17:38:45.686376 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__user
17:38:45.690432 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__user"
17:38:45.692323 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__user"
17:38:45.692562 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__user"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__user  as
      (with fivetran_user as (

    select * from angel.fivetran_log.user

),

fields as (

    select
        id as user_id,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        email,
        email_disabled as has_disabled_email_notifications,
        family_name as last_name,
        given_name as first_name,
        phone,
        verified as is_verified
        
    from fivetran_user

)

select * from fields
      );
17:38:45.692769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:47.504055 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.81 seconds
17:38:47.506538 [debug] [Thread-1  ]: finished collecting timing info
17:38:47.506827 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__user: Close
17:38:47.656181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243f22e0>]}
17:38:47.656695 [info ] [Thread-1  ]: 9 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__user [[32mSUCCESS 1[0m in 1.98s]
17:38:47.657158 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__user
17:38:47.657427 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector
17:38:47.657833 [info ] [Thread-1  ]: 10 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__connector [RUN]
17:38:47.658414 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
17:38:47.658628 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector
17:38:47.658840 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector
17:38:47.676167 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
17:38:47.676460 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */

    describe table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp
17:38:47.676661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:48.507572 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.83 seconds
17:38:48.544441 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector"
17:38:48.545138 [debug] [Thread-1  ]: finished collecting timing info
17:38:48.545358 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector
17:38:48.548988 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__connector"
17:38:48.552112 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
17:38:48.552381 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector  as
      (with connector as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp

),

fields as (
    select
        
    
    
    _fivetran_deleted
    
 as 
    
    _fivetran_deleted
    
, 
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    connecting_user_id
    
 as 
    
    connecting_user_id
    
, 
    
    
    connector_id
    
 as 
    
    connector_id
    
, 
    
    
    connector_name
    
 as 
    
    connector_name
    
, 
    
    
    connector_type
    
 as 
    
    connector_type
    
, 
    
    
    connector_type_id
    
 as 
    
    connector_type_id
    
, 
    
    
    destination_id
    
 as 
    
    destination_id
    
, 
    
    
    paused
    
 as 
    
    paused
    
, 
    cast(null as 
    int
) as 
    
    service_version
    
 , 
    
    
    signed_up
    
 as 
    
    signed_up
    



        ,row_number() over ( partition by connector_name, destination_id order by _fivetran_synced desc ) as nth_last_record
    from connector

),

final as (

    select 
        connector_id,
        connector_name,
        coalesce(connector_type_id, connector_type) as connector_type,
        destination_id,
        connecting_user_id,
        paused as is_paused,
        signed_up as set_up_at

    from fields

    -- Only look at the most recent one
    where nth_last_record = 1
)

select * 
from final
      );
17:38:50.121636 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.57 seconds
17:38:50.123621 [debug] [Thread-1  ]: finished collecting timing info
17:38:50.123889 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: Close
17:38:50.282396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245104f0>]}
17:38:50.282896 [info ] [Thread-1  ]: 10 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__connector [[32mSUCCESS 1[0m in 2.62s]
17:38:50.283334 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector
17:38:50.284023 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_status
17:38:50.284408 [info ] [Thread-1  ]: 11 of 16 START table model workshop_live_fivetran_log.fivetran_log__connector_status [RUN]
17:38:50.285073 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_status"
17:38:50.285297 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_status
17:38:50.285514 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_status
17:38:50.325146 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_status"
17:38:50.325856 [debug] [Thread-1  ]: finished collecting timing info
17:38:50.326095 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_status
17:38:50.330224 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__connector_status"
17:38:50.341679 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_status"
17:38:50.342001 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_status: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_status"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__connector_status  as
      (with connector_log as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    -- only looking at errors, warnings, and syncs here
    where event_type = 'SEVERE'
        or event_type = 'WARNING'
        or event_subtype like 'sync%'
        or (event_subtype = 'status' 
            and 

  parse_json( message_data )['status'] ='RESCHEDULED'
            and 

  parse_json( message_data )['reason'] like '%intended behavior%'
            ) -- for priority-first syncs. these should be captured by event_type = 'WARNING' but let's make sure

        -- whole reason is "We have rescheduled the connector to force flush data from the forward sync into your destination. This is intended behavior and means that the connector is working as expected."
),

schema_changes as (

    select
        connector_id,
        count(*) as number_of_schema_changes_last_month

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where 
        

    datediff(
        day,
        created_at,
        
    current_timestamp::
    timestamp_ntz


        )

 <= 30
        and event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config')

    group by 1

),

connector as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector

),

destination as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination
),

connector_metrics as (

    select
        connector.connector_id,
        connector.connector_name,
        connector.connector_type,
        connector.destination_id,
        connector.is_paused,
        connector.set_up_at,
        max(case when connector_log.event_subtype = 'sync_start' then connector_log.created_at else null end) as last_sync_started_at,

        max(case when connector_log.event_subtype = 'sync_end' 
            then connector_log.created_at else null end) as last_sync_completed_at,

        max(case when connector_log.event_subtype = 'status'
                and 

  parse_json( connector_log.message_data )['status'] ='RESCHEDULED'
                and 

  parse_json( connector_log.message_data )['reason'] like '%intended behavior%'
            then connector_log.created_at else null end) as last_priority_first_sync_completed_at,
                

        max(case when connector_log.event_type = 'SEVERE' then connector_log.created_at else null end) as last_error_at,
        max(case when event_type = 'WARNING' then connector_log.created_at else null end) as last_warning_at

    from connector 
    left join connector_log 
        on connector_log.connector_id = connector.connector_id
    group by 1,2,3,4,5,6

),

connector_health as (

    select
        *,
        case 
            -- connector is paused
            when is_paused then 'paused'

            -- a sync has never been attempted
            when last_sync_started_at is null then 'incomplete'

            -- a priority-first sync has occurred, but a normal sync has not
            when last_priority_first_sync_completed_at is not null and last_sync_completed_at is null then 'priority first sync'

            -- a priority sync has occurred more recently than a normal one (may occurr if the connector has been paused and resumed)
            when last_priority_first_sync_completed_at > last_sync_completed_at then 'priority first sync'

            -- a sync has been attempted, but not completed, and it's not due to errors. also a priority-first sync hasn't
            when last_sync_completed_at is null and last_error_at is null then 'initial sync in progress'

            -- there's been an error since the connector last completed a sync
            when last_error_at > last_sync_completed_at then 'broken'

            -- there's never been a successful sync and there have been errors
            when last_sync_completed_at is null and last_error_at is not null then 'broken'

        else 'connected' end as connector_health

    from connector_metrics
),

-- Joining with log to grab pertinent error/warning messagees
connector_recent_logs as (

    select 
        connector_health.connector_id,
        connector_health.connector_name,
        connector_health.connector_type,
        connector_health.destination_id,
        connector_health.connector_health,
        connector_health.last_sync_started_at,
        connector_health.last_sync_completed_at,
        connector_health.set_up_at,
        connector_log.event_subtype,
        connector_log.event_type,
        connector_log.message_data

    from connector_health 
    left join connector_log 
        on connector_log.connector_id = connector_health.connector_id
        -- limiting relevance to since the last successful sync completion (if there has been one)
        and connector_log.created_at > coalesce(connector_health.last_sync_completed_at, connector_health.last_priority_first_sync_completed_at, '2000-01-01') 
        -- only looking at errors and warnings (excluding syncs - both normal and priority first)
        and connector_log.event_type != 'INFO' 
        -- need to explicitly avoid priority first statuses because they are of event_type WARNING
        and not (connector_log.event_subtype = 'status' 
            and 

  parse_json( connector_log.message_data )['status'] ='RESCHEDULED'
            and 

  parse_json( connector_log.message_data )['reason'] like '%intended behavior%')

    group by 1,2,3,4,5,6,7,8,9,10,11 -- de-duping error messages
    

),

final as (

    select
        connector_recent_logs.connector_id,
        connector_recent_logs.connector_name,
        connector_recent_logs.connector_type,
        connector_recent_logs.destination_id,
        destination.destination_name,
        connector_recent_logs.connector_health,
        connector_recent_logs.last_sync_started_at,
        connector_recent_logs.last_sync_completed_at,
        connector_recent_logs.set_up_at,
        coalesce(schema_changes.number_of_schema_changes_last_month, 0) as number_of_schema_changes_last_month
        
        
        , 
    listagg(distinct case when connector_recent_logs.event_type = 'SEVERE' then connector_recent_logs.message_data else null end, '\n')

 as errors_since_last_completed_sync
        , 
    listagg(distinct case when connector_recent_logs.event_type = 'WARNING' then connector_recent_logs.message_data else null end, '\n')

 as warnings_since_last_completed_sync
        

    from connector_recent_logs
    left join schema_changes 
        on connector_recent_logs.connector_id = schema_changes.connector_id 

    join destination on destination.destination_id = connector_recent_logs.destination_id
    group by 1,2,3,4,5,6,7,8,9,10
)

select * from final
      );
17:38:50.342218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:53.127326 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.79 seconds
17:38:53.129400 [debug] [Thread-1  ]: finished collecting timing info
17:38:53.129661 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_status: Close
17:38:53.291777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243e0c70>]}
17:38:53.292289 [info ] [Thread-1  ]: 11 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__connector_status [[32mSUCCESS 1[0m in 3.01s]
17:38:53.292769 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_status
17:38:53.293273 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__mar_table_history
17:38:53.293907 [info ] [Thread-1  ]: 12 of 16 START table model workshop_live_fivetran_log.fivetran_log__mar_table_history [RUN]
17:38:53.294751 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
17:38:53.295078 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__mar_table_history
17:38:53.295312 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__mar_table_history
17:38:53.307570 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
17:38:53.308255 [debug] [Thread-1  ]: finished collecting timing info
17:38:53.308485 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__mar_table_history
17:38:53.312303 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
17:38:53.316249 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
17:38:53.316508 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__mar_table_history: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__mar_table_history"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__mar_table_history  as
      (with active_volume as (

    select 
        *, 
        
    date_trunc('month', measured_at)
 as measured_month

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume 

    where schema_name != 'fivetran_log' -- it's free! 

),

connector as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector
),

destination as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination
),

ordered_mar as (

    select
        connector_name,
        schema_name,
        table_name,
        destination_id,
        measured_at,
        measured_month,
        monthly_active_rows,

        -- each measurement is cumulative for the month, so we'll only look at the latest date for each month
        row_number() over(partition by table_name, connector_name, destination_id, measured_month order by measured_at desc) as n

    from active_volume

),

latest_mar as (
    select 
        connector_name,
        schema_name,
        table_name,
        destination_id,
        measured_month,
        date(measured_at) as last_measured_at,
        monthly_active_rows
      
    from ordered_mar
    where n = 1

),

mar_join as (

    select 
        latest_mar.*,
        connector.connector_type,
        connector.connector_id,
        destination.destination_name

    from latest_mar
    join connector 
        on latest_mar.connector_name = connector.connector_name
        and latest_mar.destination_id = connector.destination_id
    join destination on latest_mar.destination_id = destination.destination_id
)

select * from mar_join
order by measured_month desc, destination_id, connector_name
      );
17:38:53.316743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:55.217549 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.9 seconds
17:38:55.220237 [debug] [Thread-1  ]: finished collecting timing info
17:38:55.220567 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__mar_table_history: Close
17:38:55.418939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12453a220>]}
17:38:55.419569 [info ] [Thread-1  ]: 12 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__mar_table_history [[32mSUCCESS 1[0m in 2.12s]
17:38:55.420033 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__mar_table_history
17:38:55.420290 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__audit_table
17:38:55.420826 [info ] [Thread-1  ]: 13 of 16 START incremental model workshop_live_fivetran_log.fivetran_log__audit_table [RUN]
17:38:55.421419 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:55.421635 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__audit_table
17:38:55.421846 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__audit_table
17:38:55.446262 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:55.446551 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
select date(max(sync_start)) from angel.workshop_live_fivetran_log.fivetran_log__audit_table
17:38:55.446750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:56.064548 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
17:38:56.089589 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__audit_table"
17:38:56.090329 [debug] [Thread-1  ]: finished collecting timing info
17:38:56.090550 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__audit_table
17:38:56.132620 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:56.132955 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    

      create or replace temporary table angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp  as
      (

with sync_log as (
    
    select 
        *,
        

  parse_json( message_data )['table'] as table_name

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('sync_start', 'sync_end', 'write_to_table_start', 'write_to_table_end', 'records_modified')

    

    -- Capture the latest timestamp in a call statement instead of a subquery for optimizing BQ costs on incremental runs-- load the result from the above query into a new variable-- the query_result is stored as a dataframe. Therefore, we want to now store it as a singular value.-- compare the new batch of data to the latest sync already stored in this model
        and date(created_at) >= '2022-03-10'

    
),


connector as (

    select *
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status

),

add_connector_info as (

    select 
        sync_log.*,
        connector.connector_name,
        connector.destination_id,
        connector.destination_name

    from sync_log join connector using(connector_id)
),

sync_timestamps as (

    select
        connector_id,
        connector_name,
        table_name,
        event_subtype,
        destination_id,
        destination_name,

        created_at as write_to_table_start,
        
        min(case when event_subtype = 'write_to_table_end' then created_at else null end) 
            over (partition by connector_id, table_name order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as write_to_table_end,

        max(case when event_subtype = 'sync_start' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between UNBOUNDED PRECEDING and CURRENT ROW) as sync_start,

        min(case when event_subtype = 'sync_end' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as sync_end, -- coalesce with next_sync_start

        min(case when event_subtype = 'sync_start' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as next_sync_start

    from add_connector_info

),

-- this will be the base for every record in the final CTE
limit_to_table_starts as (

    select *

    from sync_timestamps 
    where event_subtype = 'write_to_table_start'

),

records_modified_log as (

    select 
        connector_id,
        created_at,
        

  parse_json( message_data )['table'] as table_name,
        

  parse_json( message_data )['schema'] as schema_name,
        

  parse_json( message_data )['operationType'] as operation_type,
        cast (

  parse_json( message_data )['count'] as 
    int
) as row_count

    from sync_log 
    where event_subtype = 'records_modified'

),

sum_records_modified as (

    select
        limit_to_table_starts.connector_id,
        limit_to_table_starts.connector_name,
        limit_to_table_starts.table_name,
        limit_to_table_starts.destination_id,
        limit_to_table_starts.destination_name,
        limit_to_table_starts.write_to_table_start,
        limit_to_table_starts.write_to_table_end,
        limit_to_table_starts.sync_start,
        case when limit_to_table_starts.sync_end > limit_to_table_starts.next_sync_start then null else limit_to_table_starts.sync_end end as sync_end,

        sum(case when records_modified_log.operation_type = 'REPLACED_OR_INSERTED' then records_modified_log.row_count else 0 end) as sum_rows_replaced_or_inserted,
        sum(case when records_modified_log.operation_type = 'UPDATED' then records_modified_log.row_count else 0 end) as sum_rows_updated,
        sum(case when records_modified_log.operation_type = 'DELETED' then records_modified_log.row_count else 0 end) as sum_rows_deleted

    from limit_to_table_starts

    left join records_modified_log on 
        limit_to_table_starts.connector_id = records_modified_log.connector_id
        and limit_to_table_starts.table_name = records_modified_log.table_name
        -- confine it to one sync
        and records_modified_log.created_at > limit_to_table_starts.sync_start 
        and records_modified_log.created_at < coalesce(limit_to_table_starts.sync_end, limit_to_table_starts.next_sync_start) 

    group by 1,2,3,4,5,6,7,8,9

),

surrogate_key as (

    select 
        *,
        md5(cast(coalesce(cast(connector_id as 
    varchar
), '') || '-' || coalesce(cast(destination_id as 
    varchar
), '') || '-' || coalesce(cast(table_name as 
    varchar
), '') || '-' || coalesce(cast(write_to_table_start as 
    varchar
), '') as 
    varchar
)) as unique_table_sync_key

    from sum_records_modified
)

select *
from surrogate_key
      );
17:38:57.860203 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.73 seconds
17:38:57.865336 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:57.865653 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp
17:38:58.036613 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.17 seconds
17:38:58.042513 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:58.042781 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table angel.workshop_live_fivetran_log.fivetran_log__audit_table
17:38:58.127397 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.08 seconds
17:38:58.140210 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:58.140501 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table "ANGEL"."WORKSHOP_LIVE_FIVETRAN_LOG"."FIVETRAN_LOG__AUDIT_TABLE"
17:38:58.297733 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.16 seconds
17:38:58.330560 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__audit_table"
17:38:58.333624 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:58.333919 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
begin;
17:38:58.493315 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
17:38:58.493778 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:58.493995 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: merge into angel.workshop_live_fivetran_log.fivetran_log__audit_table as DBT_INTERNAL_DEST
        using angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.unique_table_sync_key = DBT_INTERNAL_DEST.unique_table_sync_key
        

    
    when matched then update set
        "CONNECTOR_ID" = DBT_INTERNAL_SOURCE."CONNECTOR_ID","CONNECTOR_NAME" = DBT_INTERNAL_SOURCE."CONNECTOR_NAME","TABLE_NAME" = DBT_INTERNAL_SOURCE."TABLE_NAME","DESTINATION_ID" = DBT_INTERNAL_SOURCE."DESTINATION_ID","DESTINATION_NAME" = DBT_INTERNAL_SOURCE."DESTINATION_NAME","WRITE_TO_TABLE_START" = DBT_INTERNAL_SOURCE."WRITE_TO_TABLE_START","WRITE_TO_TABLE_END" = DBT_INTERNAL_SOURCE."WRITE_TO_TABLE_END","SYNC_START" = DBT_INTERNAL_SOURCE."SYNC_START","SYNC_END" = DBT_INTERNAL_SOURCE."SYNC_END","SUM_ROWS_REPLACED_OR_INSERTED" = DBT_INTERNAL_SOURCE."SUM_ROWS_REPLACED_OR_INSERTED","SUM_ROWS_UPDATED" = DBT_INTERNAL_SOURCE."SUM_ROWS_UPDATED","SUM_ROWS_DELETED" = DBT_INTERNAL_SOURCE."SUM_ROWS_DELETED","UNIQUE_TABLE_SYNC_KEY" = DBT_INTERNAL_SOURCE."UNIQUE_TABLE_SYNC_KEY"
    

    when not matched then insert
        ("CONNECTOR_ID", "CONNECTOR_NAME", "TABLE_NAME", "DESTINATION_ID", "DESTINATION_NAME", "WRITE_TO_TABLE_START", "WRITE_TO_TABLE_END", "SYNC_START", "SYNC_END", "SUM_ROWS_REPLACED_OR_INSERTED", "SUM_ROWS_UPDATED", "SUM_ROWS_DELETED", "UNIQUE_TABLE_SYNC_KEY")
    values
        ("CONNECTOR_ID", "CONNECTOR_NAME", "TABLE_NAME", "DESTINATION_ID", "DESTINATION_NAME", "WRITE_TO_TABLE_START", "WRITE_TO_TABLE_END", "SYNC_START", "SYNC_END", "SUM_ROWS_REPLACED_OR_INSERTED", "SUM_ROWS_UPDATED", "SUM_ROWS_DELETED", "UNIQUE_TABLE_SYNC_KEY")

;
17:38:59.405962 [debug] [Thread-1  ]: SQL status: SUCCESS 646 in 0.91 seconds
17:38:59.406317 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
17:38:59.406577 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: commit;
17:38:59.904323 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.5 seconds
17:38:59.906480 [debug] [Thread-1  ]: finished collecting timing info
17:38:59.906750 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: Close
17:39:00.334605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245ca9a0>]}
17:39:00.335119 [info ] [Thread-1  ]: 13 of 16 OK created incremental model workshop_live_fivetran_log.fivetran_log__audit_table [[32mSUCCESS 1[0m in 4.91s]
17:39:00.335556 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__audit_table
17:39:00.335809 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_daily_events
17:39:00.336217 [info ] [Thread-1  ]: 14 of 16 START table model workshop_live_fivetran_log.fivetran_log__connector_daily_events [RUN]
17:39:00.336820 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
17:39:00.337045 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_daily_events
17:39:00.337323 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_daily_events
17:39:00.356028 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
17:39:00.356325 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */

    
        select  min( signed_up ) as min_date from angel.fivetran_log.connector
17:39:00.356544 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:39:01.336449 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.98 seconds
17:39:01.359859 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
17:39:01.360152 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


        select 

    datediff(
        day,
        cast('2020-08-12' as date),
        

    dateadd(
        week,
        1,
        
    date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)

        )


        )
17:39:01.556939 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
17:39:01.573494 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
17:39:01.574280 [debug] [Thread-1  ]: finished collecting timing info
17:39:01.574534 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_daily_events
17:39:01.579219 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
17:39:01.589018 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
17:39:01.589266 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__connector_daily_events  as
      (-- depends_on: angel.fivetran_log.connector

with connector as (
    
    select * 
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status
),

-- grab api calls, schema changes, and record modifications
log_events as (

    select 
        connector_id,
        cast( 
    date_trunc('day', created_at)
 as date) as date_day,
        case 
            when event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config') then 'schema_change' 
            else event_subtype end as event_subtype,

        sum(case when event_subtype = 'records_modified' then cast( 

  parse_json( message_data )['count'] as 
    int
 )
        else 1 end) as count_events 

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('api_call', 
                            'records_modified', 
                            'create_table', 'alter_table', 'create_schema', 'change_schema_config') -- all schema changes
                            
        and connector_id is not null

    group by 1,2,3
),

pivot_out_events as (

    select
        connector_id,
        date_day,
        max(case when event_subtype = 'api_call' then count_events else 0 end) as count_api_calls,
        max(case when event_subtype = 'records_modified' then count_events else 0 end) as count_record_modifications,
        max(case when event_subtype = 'schema_change' then count_events else 0 end) as count_schema_changes

    from log_events
    group by 1,2
),

connector_event_counts as (

    select
        pivot_out_events.date_day,
        pivot_out_events.count_api_calls,
        pivot_out_events.count_record_modifications,
        pivot_out_events.count_schema_changes,
        connector.connector_name,
        connector.connector_id,
        connector.connector_type,
        connector.destination_name,
        connector.destination_id,
        connector.set_up_at
    from
    connector left join pivot_out_events 
        on pivot_out_events.connector_id = connector.connector_id
),

spine as (

    
    
    
    
    

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 582
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2020-08-12' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= 

    dateadd(
        week,
        1,
        
    date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)

        )



)

select * from filtered

 
),

connector_event_history as (

    select
        cast(spine.date_day as date) as date_day,
        connector_event_counts.connector_name,
        connector_event_counts.connector_id,
        connector_event_counts.connector_type,
        connector_event_counts.destination_name,
        connector_event_counts.destination_id,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_api_calls
            else 0
        end) as count_api_calls,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_record_modifications
            else 0
        end) as count_record_modifications,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_schema_changes
            else 0
        end) as count_schema_changes
    from
    spine join connector_event_counts
        on spine.date_day  >= cast( 
    date_trunc('day', connector_event_counts.set_up_at)
 as date)

    group by 1,2,3,4,5,6
),

-- now rejoin spine to get a complete calendar
join_event_history as (
    
    select
        spine.date_day,
        connector_event_history.connector_name,
        connector_event_history.connector_id,
        connector_event_history.connector_type,
        connector_event_history.destination_name,
        connector_event_history.destination_id,
        max(connector_event_history.count_api_calls) as count_api_calls,
        max(connector_event_history.count_record_modifications) as count_record_modifications,
        max(connector_event_history.count_schema_changes) as count_schema_changes

    from
    spine left join connector_event_history
        on cast(spine.date_day as date) = connector_event_history.date_day

    group by 1,2,3,4,5,6
),

final as (

    select *
    from join_event_history

    where cast(date_day as timestamp) <= 
    current_timestamp::
    timestamp_ntz



    order by date_day desc
)

select *
from final
      );
17:39:03.307250 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.72 seconds
17:39:03.309263 [debug] [Thread-1  ]: finished collecting timing info
17:39:03.309542 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: Close
17:39:03.471621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124594580>]}
17:39:03.472100 [info ] [Thread-1  ]: 14 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__connector_daily_events [[32mSUCCESS 1[0m in 3.13s]
17:39:03.472529 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_daily_events
17:39:03.472782 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__schema_changelog
17:39:03.473063 [info ] [Thread-1  ]: 15 of 16 START table model workshop_live_fivetran_log.fivetran_log__schema_changelog [RUN]
17:39:03.473613 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
17:39:03.473945 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__schema_changelog
17:39:03.474177 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__schema_changelog
17:39:03.482938 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
17:39:03.483649 [debug] [Thread-1  ]: finished collecting timing info
17:39:03.484052 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__schema_changelog
17:39:03.487779 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
17:39:03.490921 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
17:39:03.491192 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__schema_changelog: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__schema_changelog"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__schema_changelog  as
      (with schema_changes as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config')
),

connector as (

    select *
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status
),

add_connector_info as (

    select 
        schema_changes.*,
        connector.connector_name,
        connector.destination_id,
        connector.destination_name

    from schema_changes join connector using(connector_id)
),

final as (

    select
        connector_id,
        connector_name,
        destination_id,
        destination_name,
        created_at,
        event_subtype,
        message_data,

        case 
        when event_subtype = 'alter_table' then 

  parse_json( message_data )['table'] 
        when event_subtype = 'create_table' then 

  parse_json( message_data )['name'] 
        else null end as table_name,

        case 
        when event_subtype = 'create_schema' or event_subtype = 'create_table' then 

  parse_json( message_data )['schema'] 
        else null end as schema_name
    
    from add_connector_info
)

select * from final
order by created_at desc, connector_id
      );
17:39:03.491395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:39:06.160720 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.67 seconds
17:39:06.163113 [debug] [Thread-1  ]: finished collecting timing info
17:39:06.163483 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__schema_changelog: Close
17:39:06.395950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246a3c40>]}
17:39:06.396668 [info ] [Thread-1  ]: 15 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__schema_changelog [[32mSUCCESS 1[0m in 2.92s]
17:39:06.397111 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__schema_changelog
17:39:06.397360 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__credit_mar_destination_history
17:39:06.397826 [info ] [Thread-1  ]: 16 of 16 START table model workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history [RUN]
17:39:06.398445 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
17:39:06.398663 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__credit_mar_destination_history
17:39:06.398874 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__credit_mar_destination_history
17:39:06.403571 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
17:39:06.404340 [debug] [Thread-1  ]: finished collecting timing info
17:39:06.404580 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__credit_mar_destination_history
17:39:06.408580 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
17:39:06.412114 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
17:39:06.412476 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__credit_mar_destination_history: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__credit_mar_destination_history"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history  as
      (with table_mar as (
    
    select *
    from angel.workshop_live_fivetran_log.fivetran_log__mar_table_history
),

destination_mar as (

    select 
        measured_month,
        destination_id,
        destination_name,
        sum(monthly_active_rows) as monthly_active_rows
    
    from table_mar
    group by 1,2,3
),

credits_used as (

    select 
        destination_id,
        credits_consumed,
        cast(concat(measured_month, '-01') as date) as measured_month -- match date format to join with MAR table

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used
),

join_credits_mar as (

    select 
        destination_mar.measured_month,
        destination_mar.destination_id,
        destination_mar.destination_name,
        credits_used.credits_consumed,
        destination_mar.monthly_active_rows,
        round( nullif(credits_used.credits_consumed,0) * 1000000.0 / nullif(destination_mar.monthly_active_rows,0), 2) as credits_per_million_mar,
        round( nullif(destination_mar.monthly_active_rows,0) * 1.0 / nullif(credits_used.credits_consumed,0), 0) as mar_per_credit

    from 
    destination_mar left join credits_used 
        on destination_mar.measured_month = cast(credits_used.measured_month as timestamp)
        and destination_mar.destination_id = credits_used.destination_id

)

select * from join_credits_mar
order by measured_month desc
      );
17:39:06.412785 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:39:08.404255 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.99 seconds
17:39:08.406565 [debug] [Thread-1  ]: finished collecting timing info
17:39:08.406858 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__credit_mar_destination_history: Close
17:39:08.585125 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482c4be5-88f4-4a81-ac60-b13a9cbb5988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246a39d0>]}
17:39:08.585659 [info ] [Thread-1  ]: 16 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history [[32mSUCCESS 1[0m in 2.19s]
17:39:08.586112 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__credit_mar_destination_history
17:39:08.587338 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:39:08.587838 [info ] [MainThread]: 
17:39:08.588223 [info ] [MainThread]: Finished running 14 table models, 1 view model, 1 incremental model in 44.74s.
17:39:08.588582 [debug] [MainThread]: Connection 'master' was properly closed.
17:39:08.588771 [debug] [MainThread]: Connection 'model.fivetran_log.fivetran_log__credit_mar_destination_history' was properly closed.
17:39:08.609297 [info ] [MainThread]: 
17:39:08.609719 [info ] [MainThread]: [32mCompleted successfully[0m
17:39:08.610152 [info ] [MainThread]: 
17:39:08.610519 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
17:39:08.610997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f51da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124516670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245e40a0>]}


============================== 2022-03-28 23:29:48.309735 | c7e2d0ad-b18e-4913-b4e5-b4b83d34cbb7 ==============================
23:29:48.309735 [info ] [MainThread]: Running with dbt=1.0.1
23:29:48.311003 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
23:29:48.311510 [debug] [MainThread]: Tracking: tracking
23:29:48.312097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120094340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200941c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120094be0>]}
23:29:48.408979 [info ] [MainThread]: Unable to do partial parsing because profile has changed
23:29:48.409510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7e2d0ad-b18e-4913-b4e5-b4b83d34cbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120092340>]}
23:29:48.527478 [debug] [MainThread]: Parsing macros/catalog.sql
23:29:48.530969 [debug] [MainThread]: Parsing macros/adapters.sql
23:29:48.589230 [debug] [MainThread]: Parsing macros/materializations/merge.sql
23:29:48.595265 [debug] [MainThread]: Parsing macros/materializations/seed.sql
23:29:48.602608 [debug] [MainThread]: Parsing macros/materializations/view.sql
23:29:48.604425 [debug] [MainThread]: Parsing macros/materializations/table.sql
23:29:48.609245 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
23:29:48.621547 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
23:29:48.623080 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:29:48.628446 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:29:48.631929 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:29:48.634515 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:29:48.662072 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:29:48.678550 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:29:48.694848 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:29:48.700532 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:29:48.702718 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:29:48.705110 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:29:48.711248 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:29:48.726144 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:29:48.728236 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:29:48.741847 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:29:48.759821 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:29:48.767727 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:29:48.770728 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:29:48.778563 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:29:48.780111 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:29:48.782986 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:29:48.785447 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:29:48.791916 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:29:48.809736 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:29:48.811366 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:29:48.813950 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:29:48.815593 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:29:48.816512 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:29:48.817088 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:29:48.817817 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:29:48.819255 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:29:48.824338 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:29:48.836977 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:29:48.840714 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:29:48.845897 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:29:48.862262 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:29:48.867103 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:29:48.874298 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:29:48.885358 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:29:48.899660 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:29:48.904121 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
23:29:48.906223 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
23:29:48.908216 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
23:29:48.909896 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
23:29:48.918435 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
23:29:48.920059 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
23:29:48.921778 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
23:29:48.926226 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
23:29:48.927801 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
23:29:48.930737 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
23:29:48.940019 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
23:29:48.985817 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
23:29:49.000068 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
23:29:49.004249 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
23:29:49.008339 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
23:29:49.013637 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
23:29:49.023454 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
23:29:49.027878 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
23:29:49.035683 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
23:29:49.047688 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
23:29:49.058255 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
23:29:49.061627 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
23:29:49.067698 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
23:29:49.070516 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
23:29:49.074445 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
23:29:49.078435 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
23:29:49.132870 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
23:29:49.135958 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
23:29:49.147561 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
23:29:49.150107 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
23:29:49.151733 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
23:29:49.153452 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
23:29:49.155131 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
23:29:49.157229 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
23:29:49.159917 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
23:29:49.162450 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
23:29:49.165848 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
23:29:49.168553 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
23:29:49.173139 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
23:29:49.178641 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
23:29:49.182447 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
23:29:49.184506 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
23:29:49.186274 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
23:29:49.190626 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
23:29:49.193772 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
23:29:49.196741 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
23:29:49.200253 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
23:29:49.204470 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
23:29:49.206781 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
23:29:49.211759 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
23:29:49.223477 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
23:29:49.228767 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
23:29:49.230784 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
23:29:49.235026 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
23:29:49.240379 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
23:29:49.245101 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
23:29:49.247287 [debug] [MainThread]: Parsing macros/sql/star.sql
23:29:49.252996 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
23:29:49.263280 [debug] [MainThread]: Parsing macros/sql/union.sql
23:29:49.275272 [debug] [MainThread]: Parsing macros/sql/groupby.sql
23:29:49.276674 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
23:29:49.280206 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
23:29:49.281864 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
23:29:49.283546 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
23:29:49.289994 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
23:29:49.295716 [debug] [MainThread]: Parsing macros/sql/pivot.sql
23:29:49.299980 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
23:29:49.302342 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
23:29:49.303624 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
23:29:49.310198 [debug] [MainThread]: Parsing macros/maintenance_operation.sql
23:29:49.329520 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/concat.sql
23:29:49.330145 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/datatypes.sql
23:29:49.330553 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/dateadd.sql
23:29:49.336394 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/datediff.sql
23:29:49.350658 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/current_timestamp.sql
23:29:49.351279 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/split_part.sql
23:29:49.352659 [debug] [MainThread]: Parsing macros/dbt_utils/sql/get_relations_by_prefix.sql
23:29:49.358150 [debug] [MainThread]: Parsing macros/etc/assert_not_null.sql
23:29:49.359513 [debug] [MainThread]: Parsing macros/snowplow/convert_timezone.sql
23:29:49.360150 [debug] [MainThread]: Parsing macros/enabled_vars.sql
23:29:49.361258 [debug] [MainThread]: Parsing macros/percentile.sql
23:29:49.365040 [debug] [MainThread]: Parsing macros/pivot_json_extract.sql
23:29:49.366162 [debug] [MainThread]: Parsing macros/persist_pass_through_columns.sql
23:29:49.367549 [debug] [MainThread]: Parsing macros/json_parse.sql
23:29:49.373598 [debug] [MainThread]: Parsing macros/max_bool.sql
23:29:49.375314 [debug] [MainThread]: Parsing macros/calculated_fields.sql
23:29:49.376362 [debug] [MainThread]: Parsing macros/seed_data_helper.sql
23:29:49.378030 [debug] [MainThread]: Parsing macros/fill_pass_through_columns.sql
23:29:49.379707 [debug] [MainThread]: Parsing macros/string_agg.sql
23:29:49.382059 [debug] [MainThread]: Parsing macros/timestamp_diff.sql
23:29:49.392642 [debug] [MainThread]: Parsing macros/generate_docs.sql
23:29:49.393669 [debug] [MainThread]: Parsing macros/generate_columns_macro.sql
23:29:49.397018 [debug] [MainThread]: Parsing macros/source_relation.sql
23:29:49.399554 [debug] [MainThread]: Parsing macros/first_value.sql
23:29:49.401931 [debug] [MainThread]: Parsing macros/add_dbt_source_relation.sql
23:29:49.402687 [debug] [MainThread]: Parsing macros/add_pass_through_columns.sql
23:29:49.404722 [debug] [MainThread]: Parsing macros/staging_models_automation.sql
23:29:49.408241 [debug] [MainThread]: Parsing macros/union_relations.sql
23:29:49.417636 [debug] [MainThread]: Parsing macros/snowflake_seed_data.sql
23:29:49.418671 [debug] [MainThread]: Parsing macros/get_columns_for_macro.sql
23:29:49.422621 [debug] [MainThread]: Parsing macros/fill_staging_columns.sql
23:29:49.427287 [debug] [MainThread]: Parsing macros/json_extract.sql
23:29:49.430461 [debug] [MainThread]: Parsing macros/collect_freshness.sql
23:29:49.434399 [debug] [MainThread]: Parsing macros/timestamp_add.sql
23:29:49.437896 [debug] [MainThread]: Parsing macros/ceiling.sql
23:29:49.439151 [debug] [MainThread]: Parsing macros/remove_prefix_from_columns.sql
23:29:49.441021 [debug] [MainThread]: Parsing macros/union_data.sql
23:29:49.448179 [debug] [MainThread]: Parsing macros/dummy_coalesce_value.sql
23:29:49.451549 [debug] [MainThread]: Parsing macros/array_agg.sql
23:29:49.452787 [debug] [MainThread]: Parsing macros/empty_variable_warning.sql
23:29:49.453829 [debug] [MainThread]: Parsing macros/enabled_vars_one_true.sql
23:29:49.454892 [debug] [MainThread]: Parsing macros/get_brand_columns.sql
23:29:50.006299 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
23:29:50.021418 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
23:29:50.078731 [debug] [MainThread]: 1603: static parser failed on fivetran_log__transformation_status.sql
23:29:50.090788 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__transformation_status.sql
23:29:50.092808 [debug] [MainThread]: 1603: static parser failed on fivetran_log__connector_status.sql
23:29:50.132260 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__connector_status.sql
23:29:50.133741 [debug] [MainThread]: 1699: static parser successfully parsed fivetran_log__credit_mar_destination_history.sql
23:29:50.137327 [debug] [MainThread]: 1603: static parser failed on fivetran_log__audit_table.sql
23:29:50.178843 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__audit_table.sql
23:29:50.180421 [debug] [MainThread]: 1603: static parser failed on fivetran_log__mar_table_history.sql
23:29:50.190532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__mar_table_history.sql
23:29:50.192547 [debug] [MainThread]: 1603: static parser failed on fivetran_log__schema_changelog.sql
23:29:50.200980 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__schema_changelog.sql
23:29:50.202444 [debug] [MainThread]: 1603: static parser failed on fivetran_log__connector_daily_events.sql
23:29:50.253822 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__connector_daily_events.sql
23:29:50.255682 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__credits_used.sql
23:29:50.263485 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__credits_used.sql
23:29:50.265164 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__destination_membership.sql
23:29:50.274342 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__destination_membership.sql
23:29:50.276211 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__transformation.sql
23:29:50.284720 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__transformation.sql
23:29:50.286359 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__account_membership.sql
23:29:50.296764 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__account_membership.sql
23:29:50.298933 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__connector.sql
23:29:50.336668 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__connector.sql
23:29:50.338249 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__destination.sql
23:29:50.346420 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__destination.sql
23:29:50.348146 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__active_volume.sql
23:29:50.357308 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__active_volume.sql
23:29:50.359834 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__user.sql
23:29:50.367214 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__user.sql
23:29:50.368795 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__log.sql
23:29:50.380223 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__log.sql
23:29:50.381926 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__account.sql
23:29:50.447325 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__account.sql
23:29:50.449055 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__trigger_table.sql
23:29:50.457887 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__trigger_table.sql
23:29:50.459878 [debug] [MainThread]: 1603: static parser failed on staging/tmp/stg_fivetran_log__connector_tmp.sql
23:29:50.467060 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/tmp/stg_fivetran_log__connector_tmp.sql
23:29:51.009290 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__transformation_status_destination_id__transformation_id.4c7bf174ec' (models/fivetran_log.yml) depends on a node named 'fivetran_log__transformation_status' which is disabled
23:29:51.011684 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__transformation_transformation_id__destination_id.53b3485eb3' (models/staging/stg_fivetran_log.yml) depends on a node named 'stg_fivetran_log__transformation' which is disabled
23:29:51.012406 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__trigger_table_trigger_table__transformation_id.124bb8d5ca' (models/staging/stg_fivetran_log.yml) depends on a node named 'stg_fivetran_log__trigger_table' which is disabled
23:29:51.086638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7e2d0ad-b18e-4913-b4e5-b4b83d34cbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ca00d0>]}
23:29:51.126307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7e2d0ad-b18e-4913-b4e5-b4b83d34cbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205574c0>]}
23:29:51.126760 [info ] [MainThread]: Found 18 models, 23 tests, 0 snapshots, 0 analyses, 479 macros, 0 operations, 0 seed files, 11 sources, 0 exposures, 0 metrics
23:29:51.131316 [info ] [MainThread]: 
23:29:51.133000 [debug] [MainThread]: Acquiring new snowflake connection "master"
23:29:51.135793 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_stg_fivetran_log"
23:29:51.155566 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_stg_fivetran_log"
23:29:51.156802 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_stg_fivetran_log"} */

    show terse objects in angel.workshop_live_stg_fivetran_log
23:29:51.157233 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:29:52.136267 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.98 seconds
23:29:52.138452 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: Close
23:29:52.263223 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live"
23:29:52.266122 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live"
23:29:52.266297 [debug] [ThreadPool]: On list_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live"} */

    show terse objects in angel.workshop_live
23:29:52.266443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:29:52.714032 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.45 seconds
23:29:52.715450 [debug] [ThreadPool]: On list_angel_workshop_live: Close
23:29:52.825020 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_fivetran_log"
23:29:52.828349 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_fivetran_log"
23:29:52.828549 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_fivetran_log"} */

    show terse objects in angel.workshop_live_fivetran_log
23:29:52.828697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:29:53.317368 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.49 seconds
23:29:53.318838 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: Close
23:29:53.420231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
23:29:53.420671 [info ] [MainThread]: 
23:29:53.425820 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account
23:29:53.426338 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account"
23:29:53.426587 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account
23:29:53.426811 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account
23:29:53.432629 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account"
23:29:53.434760 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.435026 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account
23:29:53.435267 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.435724 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account
23:29:53.435990 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account_membership
23:29:53.436525 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
23:29:53.436747 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account_membership
23:29:53.436959 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account_membership
23:29:53.443629 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
23:29:53.445773 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.446197 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account_membership
23:29:53.446503 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.446995 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account_membership
23:29:53.447294 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__active_volume
23:29:53.447848 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
23:29:53.448169 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__active_volume
23:29:53.448405 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__active_volume
23:29:53.453915 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
23:29:53.454916 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.455160 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__active_volume
23:29:53.455399 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.455844 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__active_volume
23:29:53.456172 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector_tmp
23:29:53.456553 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
23:29:53.456766 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector_tmp
23:29:53.456972 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector_tmp
23:29:53.461576 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
23:29:53.463148 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.463399 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector_tmp
23:29:53.463621 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.464050 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector_tmp
23:29:53.464303 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__credits_used
23:29:53.464673 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
23:29:53.464884 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__credits_used
23:29:53.465092 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__credits_used
23:29:53.469599 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
23:29:53.470269 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.470496 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__credits_used
23:29:53.470710 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.471118 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__credits_used
23:29:53.471368 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination
23:29:53.471739 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
23:29:53.471949 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination
23:29:53.472155 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination
23:29:53.478859 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination"
23:29:53.479825 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.480062 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination
23:29:53.480282 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.480698 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination
23:29:53.480949 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination_membership
23:29:53.481317 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
23:29:53.481529 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination_membership
23:29:53.481736 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination_membership
23:29:53.487610 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
23:29:53.488568 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.488823 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination_membership
23:29:53.489063 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.489519 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination_membership
23:29:53.489777 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__log
23:29:53.490487 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__log"
23:29:53.490717 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__log
23:29:53.490929 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__log
23:29:53.496528 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__log"
23:29:53.498075 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.498321 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__log
23:29:53.498545 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.498973 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__log
23:29:53.499227 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__user
23:29:53.499596 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__user"
23:29:53.499808 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__user
23:29:53.500136 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__user
23:29:53.505690 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__user"
23:29:53.506714 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.507001 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__user
23:29:53.507238 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.507778 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__user
23:29:53.508033 [debug] [Thread-1  ]: Began running node model.workshop_live.my_first_dbt_model
23:29:53.508407 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_first_dbt_model"
23:29:53.508618 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_first_dbt_model
23:29:53.508823 [debug] [Thread-1  ]: Compiling model.workshop_live.my_first_dbt_model
23:29:53.513160 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_first_dbt_model"
23:29:53.515072 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.515461 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_first_dbt_model
23:29:53.515694 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.516201 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_first_dbt_model
23:29:53.516493 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
23:29:53.517139 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
23:29:53.517420 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
23:29:53.517664 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
23:29:53.526894 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
23:29:53.528015 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.528246 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
23:29:53.528515 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.528952 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
23:29:53.529200 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
23:29:53.529701 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
23:29:53.529909 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
23:29:53.530106 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
23:29:53.539979 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
23:29:53.540606 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.540818 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
23:29:53.541019 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.541448 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
23:29:53.541692 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
23:29:53.542041 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
23:29:53.542338 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
23:29:53.542558 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
23:29:53.549001 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
23:29:53.549559 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.549761 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
23:29:53.549954 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.550358 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
23:29:53.550594 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
23:29:53.551044 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
23:29:53.551242 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
23:29:53.551456 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
23:29:53.557624 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
23:29:53.558498 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.558694 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
23:29:53.558881 [debug] [Thread-1  ]: finished collecting timing info
23:29:53.559263 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
23:29:53.559503 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector
23:29:53.559912 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
23:29:53.560095 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector
23:29:53.560292 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector
23:29:53.579158 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
23:29:53.579592 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */

    describe table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp
23:29:53.579806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:29:54.211236 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.63 seconds
23:29:54.226149 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector"
23:29:54.226743 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.226965 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector
23:29:54.227181 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.227400 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: Close
23:29:54.342090 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector
23:29:54.342480 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
23:29:54.343092 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
23:29:54.343543 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
23:29:54.343868 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
23:29:54.351285 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
23:29:54.351932 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.352164 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
23:29:54.352390 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.352801 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
23:29:54.353061 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
23:29:54.353436 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
23:29:54.353665 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
23:29:54.353873 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
23:29:54.358740 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
23:29:54.359580 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.359871 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
23:29:54.360089 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.360496 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
23:29:54.360748 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
23:29:54.361198 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
23:29:54.361413 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
23:29:54.361616 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
23:29:54.366560 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
23:29:54.367106 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.367331 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
23:29:54.367548 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.367948 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
23:29:54.368206 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
23:29:54.368575 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
23:29:54.368786 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
23:29:54.368991 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
23:29:54.375747 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
23:29:54.376456 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.376694 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
23:29:54.376913 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.377340 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
23:29:54.377670 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
23:29:54.378152 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
23:29:54.378382 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
23:29:54.378597 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
23:29:54.385364 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
23:29:54.385964 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.386185 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
23:29:54.386401 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.386806 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
23:29:54.387051 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
23:29:54.387405 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
23:29:54.387609 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
23:29:54.387809 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
23:29:54.392686 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
23:29:54.393317 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.393628 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
23:29:54.393849 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.394239 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
23:29:54.394477 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
23:29:54.394821 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
23:29:54.395022 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
23:29:54.395216 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
23:29:54.401154 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
23:29:54.401660 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.401869 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
23:29:54.402067 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.402436 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
23:29:54.402664 [debug] [Thread-1  ]: Began running node model.workshop_live.my_second_dbt_model
23:29:54.403001 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_second_dbt_model"
23:29:54.403194 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_second_dbt_model
23:29:54.403380 [debug] [Thread-1  ]: Compiling model.workshop_live.my_second_dbt_model
23:29:54.406477 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_second_dbt_model"
23:29:54.408202 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.408513 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_second_dbt_model
23:29:54.408739 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.409198 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_second_dbt_model
23:29:54.409461 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
23:29:54.409810 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
23:29:54.410237 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
23:29:54.410512 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
23:29:54.416448 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
23:29:54.417218 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.417452 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
23:29:54.417668 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.418399 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
23:29:54.418675 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
23:29:54.419074 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
23:29:54.419458 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
23:29:54.419698 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_first_dbt_model_id.16e066b321
23:29:54.425560 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
23:29:54.426699 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.426944 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
23:29:54.427164 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.427602 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
23:29:54.427903 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_status
23:29:54.428491 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_status"
23:29:54.428711 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_status
23:29:54.428914 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_status
23:29:54.445757 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_status"
23:29:54.448320 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.448538 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_status
23:29:54.448740 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.449135 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_status
23:29:54.449367 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__mar_table_history
23:29:54.449816 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
23:29:54.450011 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__mar_table_history
23:29:54.450199 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__mar_table_history
23:29:54.455170 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
23:29:54.455783 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.455979 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__mar_table_history
23:29:54.456172 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.456526 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__mar_table_history
23:29:54.456749 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
23:29:54.457215 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
23:29:54.457406 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
23:29:54.457590 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
23:29:54.468137 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
23:29:54.469378 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.469773 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
23:29:54.470137 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.470859 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
23:29:54.471334 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
23:29:54.472343 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
23:29:54.472698 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
23:29:54.473130 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
23:29:54.534330 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
23:29:54.535011 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.535241 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
23:29:54.535459 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.535916 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
23:29:54.536180 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
23:29:54.536559 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
23:29:54.536774 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
23:29:54.536983 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
23:29:54.542317 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
23:29:54.543050 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.543315 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
23:29:54.543533 [debug] [Thread-1  ]: finished collecting timing info
23:29:54.543958 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
23:29:54.544215 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__audit_table
23:29:54.544588 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__audit_table"
23:29:54.544801 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__audit_table
23:29:54.545008 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__audit_table
23:29:54.564115 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
23:29:54.564568 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
select date(max(sync_start)) from angel.workshop_live_fivetran_log.fivetran_log__audit_table
23:29:54.564934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:29:55.130376 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
23:29:55.149588 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__audit_table"
23:29:55.151390 [debug] [Thread-1  ]: finished collecting timing info
23:29:55.151778 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__audit_table
23:29:55.152081 [debug] [Thread-1  ]: finished collecting timing info
23:29:55.152359 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: Close
23:29:55.275612 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__audit_table
23:29:55.275996 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_daily_events
23:29:55.276728 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
23:29:55.277007 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_daily_events
23:29:55.277266 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_daily_events
23:29:55.293197 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
23:29:55.293433 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */

    
        select  min( signed_up ) as min_date from angel.fivetran_log.connector
23:29:55.293632 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:29:56.019896 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.73 seconds
23:29:56.027672 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
23:29:56.027917 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


        select 

    datediff(
        day,
        cast('2020-08-12' as date),
        

    dateadd(
        week,
        1,
        
    date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)

        )


        )
23:29:56.153474 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
23:29:56.160366 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
23:29:56.161185 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.161468 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_daily_events
23:29:56.161735 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.162005 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: Close
23:29:56.276177 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_daily_events
23:29:56.276786 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__schema_changelog
23:29:56.277414 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
23:29:56.277825 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__schema_changelog
23:29:56.278117 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__schema_changelog
23:29:56.285951 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
23:29:56.287166 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.287484 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__schema_changelog
23:29:56.287724 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.288206 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__schema_changelog
23:29:56.288473 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
23:29:56.288865 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
23:29:56.289093 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
23:29:56.289304 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
23:29:56.297955 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
23:29:56.298564 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.298787 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
23:29:56.299005 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.299413 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
23:29:56.299666 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__credit_mar_destination_history
23:29:56.300041 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
23:29:56.300254 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__credit_mar_destination_history
23:29:56.300460 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__credit_mar_destination_history
23:29:56.304535 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
23:29:56.306192 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.306459 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__credit_mar_destination_history
23:29:56.306683 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.307166 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__credit_mar_destination_history
23:29:56.307435 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
23:29:56.308018 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
23:29:56.308248 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
23:29:56.308459 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
23:29:56.319535 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
23:29:56.320333 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.320612 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
23:29:56.320847 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.321310 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
23:29:56.321577 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
23:29:56.322116 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
23:29:56.322341 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
23:29:56.322552 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
23:29:56.327949 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
23:29:56.329202 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.329519 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
23:29:56.329783 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.330262 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
23:29:56.330525 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
23:29:56.330899 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
23:29:56.331116 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
23:29:56.331327 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
23:29:56.336626 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
23:29:56.337291 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.337521 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
23:29:56.337736 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.338136 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
23:29:56.338387 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
23:29:56.338821 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
23:29:56.339048 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
23:29:56.339255 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
23:29:56.347507 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
23:29:56.348081 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.348291 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
23:29:56.348493 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.348877 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
23:29:56.349126 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
23:29:56.349466 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a"
23:29:56.349661 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
23:29:56.349850 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
23:29:56.356243 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a"
23:29:56.357279 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.357581 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
23:29:56.357794 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.358234 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
23:29:56.358474 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
23:29:56.358803 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
23:29:56.359075 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
23:29:56.359287 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
23:29:56.365509 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
23:29:56.366087 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.366288 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
23:29:56.366480 [debug] [Thread-1  ]: finished collecting timing info
23:29:56.366857 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
23:29:56.367770 [debug] [MainThread]: Connection 'master' was properly closed.
23:29:56.367972 [debug] [MainThread]: Connection 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2' was properly closed.
23:29:56.387800 [info ] [MainThread]: Done.
23:29:56.391916 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
23:29:56.392194 [info ] [MainThread]: Building catalog
23:29:56.397865 [debug] [ThreadPool]: Acquiring new snowflake connection "angel.information_schema"
23:29:56.408646 [debug] [ThreadPool]: Using snowflake connection "angel.information_schema"
23:29:56.408885 [debug] [ThreadPool]: On angel.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "angel.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from angel.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from angel.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('workshop_live_stg_fivetran_log') or upper("table_schema") = upper('fivetran_log') or upper("table_schema") = upper('workshop_live_fivetran_log') or upper("table_schema") = upper('workshop_live'))
      order by "column_index"
23:29:56.409076 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:30:17.566592 [debug] [ThreadPool]: SQL status: SUCCESS 227 in 21.16 seconds
23:30:18.022304 [debug] [ThreadPool]: On angel.information_schema: Close
23:30:18.211014 [info ] [MainThread]: Catalog written to /Users/angel.hernandez/Fivetran/dbt/workshop_live/target/catalog.json
23:30:18.211757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120094340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120459e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204598b0>]}
23:30:18.582039 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:30:18.582408 [debug] [MainThread]: Connection 'angel.information_schema' was properly closed.


============================== 2022-03-28 23:30:22.645031 | 039c76b5-8519-4aef-8374-d39beab24640 ==============================
23:30:22.645031 [info ] [MainThread]: Running with dbt=1.0.1
23:30:22.646017 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
23:30:22.646359 [debug] [MainThread]: Tracking: tracking
23:30:22.646894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d98d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d98dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d98dca0>]}
23:30:22.650301 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:30:22.650958 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:30:22.651363 [info ] [MainThread]: 
23:30:22.651687 [info ] [MainThread]: 
23:30:22.652001 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-04-01 21:06:14.362900 | 18d19332-efd5-4fa2-a2df-682a30b337c4 ==============================
21:06:14.362900 [info ] [MainThread]: Running with dbt=1.0.1
21:06:14.364215 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
21:06:14.364573 [debug] [MainThread]: Tracking: tracking
21:06:14.365039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb72130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb72df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb72250>]}
21:06:14.544996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:06:14.545279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:06:14.556910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18d19332-efd5-4fa2-a2df-682a30b337c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7140d0>]}
21:06:14.580816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18d19332-efd5-4fa2-a2df-682a30b337c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf8c820>]}
21:06:14.581276 [info ] [MainThread]: Found 18 models, 23 tests, 0 snapshots, 0 analyses, 479 macros, 0 operations, 0 seed files, 11 sources, 0 exposures, 0 metrics
21:06:14.585451 [info ] [MainThread]: 
21:06:14.586142 [debug] [MainThread]: Acquiring new snowflake connection "master"
21:06:14.588004 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_fivetran_log"
21:06:14.604598 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_fivetran_log"
21:06:14.604874 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_fivetran_log"} */

    show terse objects in angel.workshop_live_fivetran_log
21:06:14.605060 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:06:15.731682 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.13 seconds
21:06:15.734423 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: Close
21:06:15.908814 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live"
21:06:15.913068 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live"
21:06:15.913334 [debug] [ThreadPool]: On list_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live"} */

    show terse objects in angel.workshop_live
21:06:15.913547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:06:16.414667 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.5 seconds
21:06:16.417076 [debug] [ThreadPool]: On list_angel_workshop_live: Close
21:06:16.548855 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_stg_fivetran_log"
21:06:16.552796 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_stg_fivetran_log"
21:06:16.553029 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_stg_fivetran_log"} */

    show terse objects in angel.workshop_live_stg_fivetran_log
21:06:16.553231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:06:17.233300 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.68 seconds
21:06:17.236042 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: Close
21:06:17.359282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:06:17.359760 [info ] [MainThread]: 
21:06:17.365641 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account
21:06:17.366456 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account"
21:06:17.366740 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account
21:06:17.366990 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account
21:06:17.375064 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account"
21:06:17.377579 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.377889 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account
21:06:17.378133 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.378618 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account
21:06:17.378880 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account_membership
21:06:17.379254 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
21:06:17.379466 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account_membership
21:06:17.379674 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account_membership
21:06:17.386071 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
21:06:17.388094 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.388350 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account_membership
21:06:17.388573 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.389015 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account_membership
21:06:17.389271 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__active_volume
21:06:17.389648 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
21:06:17.389972 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__active_volume
21:06:17.390289 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__active_volume
21:06:17.396713 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
21:06:17.398577 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.398865 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__active_volume
21:06:17.399099 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.399577 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__active_volume
21:06:17.399856 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector_tmp
21:06:17.400247 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
21:06:17.400464 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector_tmp
21:06:17.400889 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector_tmp
21:06:17.405290 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
21:06:17.406275 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.406523 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector_tmp
21:06:17.406747 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.407166 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector_tmp
21:06:17.407415 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__credits_used
21:06:17.407783 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
21:06:17.407992 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__credits_used
21:06:17.408197 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__credits_used
21:06:17.412450 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
21:06:17.413176 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.413405 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__credits_used
21:06:17.413622 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.414026 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__credits_used
21:06:17.414262 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination
21:06:17.414608 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
21:06:17.414809 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination
21:06:17.415004 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination
21:06:17.419719 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination"
21:06:17.420772 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.421091 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination
21:06:17.421318 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.421767 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination
21:06:17.422021 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination_membership
21:06:17.422368 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
21:06:17.422570 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination_membership
21:06:17.422764 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination_membership
21:06:17.428377 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
21:06:17.429716 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.430011 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination_membership
21:06:17.430233 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.430682 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination_membership
21:06:17.430937 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__log
21:06:17.431287 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__log"
21:06:17.431488 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__log
21:06:17.431687 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__log
21:06:17.436819 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__log"
21:06:17.437991 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.438219 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__log
21:06:17.438427 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.438813 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__log
21:06:17.439049 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__user
21:06:17.439392 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__user"
21:06:17.439591 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__user
21:06:17.439784 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__user
21:06:17.445732 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__user"
21:06:17.446822 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.447060 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__user
21:06:17.447269 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.447713 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__user
21:06:17.447969 [debug] [Thread-1  ]: Began running node model.workshop_live.my_first_dbt_model
21:06:17.448323 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_first_dbt_model"
21:06:17.448524 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_first_dbt_model
21:06:17.448718 [debug] [Thread-1  ]: Compiling model.workshop_live.my_first_dbt_model
21:06:17.452183 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_first_dbt_model"
21:06:17.452918 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.453144 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_first_dbt_model
21:06:17.453351 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.453751 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_first_dbt_model
21:06:17.453989 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
21:06:17.454329 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
21:06:17.454527 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
21:06:17.454826 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
21:06:17.467257 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
21:06:17.467769 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.467970 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
21:06:17.468163 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.468514 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
21:06:17.468733 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
21:06:17.469056 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
21:06:17.469243 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
21:06:17.469423 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
21:06:17.477005 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
21:06:17.477477 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.477676 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
21:06:17.477869 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.478219 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
21:06:17.478441 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
21:06:17.478760 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
21:06:17.478948 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
21:06:17.479126 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
21:06:17.491060 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
21:06:17.491468 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.491642 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
21:06:17.491809 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.492121 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
21:06:17.492310 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
21:06:17.492585 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
21:06:17.492747 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
21:06:17.492914 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
21:06:17.497579 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
21:06:17.499096 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.499346 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
21:06:17.499526 [debug] [Thread-1  ]: finished collecting timing info
21:06:17.499913 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
21:06:17.500115 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector
21:06:17.500394 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
21:06:17.500551 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector
21:06:17.500708 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector
21:06:17.514156 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
21:06:17.514419 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */

    describe table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp
21:06:17.514642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:06:18.029370 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.51 seconds
21:06:18.068179 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector"
21:06:18.070254 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.070577 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector
21:06:18.070837 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.071078 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: Close
21:06:18.196360 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector
21:06:18.196762 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
21:06:18.197426 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
21:06:18.197882 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
21:06:18.198200 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
21:06:18.205566 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
21:06:18.206808 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.207209 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
21:06:18.207558 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.208052 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
21:06:18.208332 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
21:06:18.208705 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
21:06:18.208921 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
21:06:18.209131 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
21:06:18.214268 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
21:06:18.214960 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.215186 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
21:06:18.215401 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.215797 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
21:06:18.216040 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
21:06:18.216396 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
21:06:18.216606 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
21:06:18.216886 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
21:06:18.221874 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
21:06:18.222415 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.222638 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
21:06:18.222855 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.223254 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
21:06:18.223503 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
21:06:18.223868 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
21:06:18.224078 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
21:06:18.224281 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
21:06:18.288114 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
21:06:18.288858 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.289134 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
21:06:18.289399 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.289914 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
21:06:18.290210 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
21:06:18.290643 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
21:06:18.291000 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
21:06:18.291271 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
21:06:18.298196 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
21:06:18.298723 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.298957 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
21:06:18.299181 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.299586 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
21:06:18.299856 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
21:06:18.300232 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
21:06:18.300450 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
21:06:18.300661 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
21:06:18.305724 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
21:06:18.306281 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.306517 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
21:06:18.306742 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.307156 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
21:06:18.307410 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
21:06:18.307786 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
21:06:18.308002 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
21:06:18.308216 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
21:06:18.313250 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
21:06:18.314296 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.314541 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
21:06:18.314766 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.315199 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
21:06:18.315457 [debug] [Thread-1  ]: Began running node model.workshop_live.my_second_dbt_model
21:06:18.315837 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_second_dbt_model"
21:06:18.316050 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_second_dbt_model
21:06:18.316264 [debug] [Thread-1  ]: Compiling model.workshop_live.my_second_dbt_model
21:06:18.319802 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_second_dbt_model"
21:06:18.320473 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.320704 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_second_dbt_model
21:06:18.320926 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.321361 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_second_dbt_model
21:06:18.321617 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
21:06:18.322176 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
21:06:18.322415 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
21:06:18.322633 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
21:06:18.328594 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
21:06:18.329649 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.329912 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
21:06:18.330142 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.330849 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
21:06:18.331268 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
21:06:18.332022 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
21:06:18.332253 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
21:06:18.332563 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_first_dbt_model_id.16e066b321
21:06:18.338356 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
21:06:18.339310 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.339566 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
21:06:18.339899 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.340362 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
21:06:18.340634 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_status
21:06:18.341168 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_status"
21:06:18.341398 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_status
21:06:18.341606 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_status
21:06:18.384698 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_status"
21:06:18.387739 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.388103 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_status
21:06:18.388351 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.388829 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_status
21:06:18.389096 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__mar_table_history
21:06:18.389641 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
21:06:18.390237 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__mar_table_history
21:06:18.390525 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__mar_table_history
21:06:18.399394 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
21:06:18.400110 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.400339 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__mar_table_history
21:06:18.400551 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.400969 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__mar_table_history
21:06:18.401216 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
21:06:18.401567 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
21:06:18.401768 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
21:06:18.401962 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
21:06:18.408289 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
21:06:18.409441 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.409661 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
21:06:18.409867 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.410323 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
21:06:18.410565 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
21:06:18.410903 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
21:06:18.411096 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
21:06:18.411284 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
21:06:18.415891 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
21:06:18.416364 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.416560 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
21:06:18.416754 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.417105 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
21:06:18.417324 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
21:06:18.417641 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
21:06:18.417826 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
21:06:18.418131 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
21:06:18.423353 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
21:06:18.424228 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.424528 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
21:06:18.424884 [debug] [Thread-1  ]: finished collecting timing info
21:06:18.425526 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
21:06:18.425953 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__audit_table
21:06:18.426529 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__audit_table"
21:06:18.427002 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__audit_table
21:06:18.427353 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__audit_table
21:06:18.459783 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
21:06:18.460074 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
select date(max(sync_start)) from angel.workshop_live_fivetran_log.fivetran_log__audit_table
21:06:18.460279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:06:19.060596 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
21:06:19.097700 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__audit_table"
21:06:19.098350 [debug] [Thread-1  ]: finished collecting timing info
21:06:19.098586 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__audit_table
21:06:19.098813 [debug] [Thread-1  ]: finished collecting timing info
21:06:19.099041 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: Close
21:06:19.219690 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__audit_table
21:06:19.220105 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_daily_events
21:06:19.220561 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
21:06:19.221103 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_daily_events
21:06:19.221412 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_daily_events
21:06:19.238263 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
21:06:19.238545 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */

    
        select  min( signed_up ) as min_date from angel.fivetran_log.connector
21:06:19.238749 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:06:19.950423 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.71 seconds
21:06:19.975331 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
21:06:19.975581 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


        select 

    datediff(
        day,
        cast('2020-08-12' as date),
        

    dateadd(
        week,
        1,
        
    date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)

        )


        )
21:06:20.126275 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
21:06:20.145609 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
21:06:20.146358 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.146597 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_daily_events
21:06:20.146822 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.147045 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: Close
21:06:20.287655 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_daily_events
21:06:20.288059 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__schema_changelog
21:06:20.288796 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
21:06:20.289064 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__schema_changelog
21:06:20.289322 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__schema_changelog
21:06:20.296905 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
21:06:20.298753 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.299294 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__schema_changelog
21:06:20.299634 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.300327 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__schema_changelog
21:06:20.300720 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
21:06:20.301187 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
21:06:20.301580 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
21:06:20.301977 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
21:06:20.310243 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
21:06:20.310842 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.311067 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
21:06:20.311287 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.311690 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
21:06:20.311942 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__credit_mar_destination_history
21:06:20.312313 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
21:06:20.312522 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__credit_mar_destination_history
21:06:20.312728 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__credit_mar_destination_history
21:06:20.316633 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
21:06:20.317745 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.317993 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__credit_mar_destination_history
21:06:20.318220 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.318671 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__credit_mar_destination_history
21:06:20.318936 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
21:06:20.319531 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
21:06:20.319757 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
21:06:20.319964 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
21:06:20.327580 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
21:06:20.328658 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.328894 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
21:06:20.329114 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.329540 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
21:06:20.329790 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
21:06:20.330152 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
21:06:20.330359 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
21:06:20.330560 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
21:06:20.335573 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
21:06:20.336170 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.336383 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
21:06:20.336588 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.336973 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
21:06:20.337199 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
21:06:20.337526 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
21:06:20.337716 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
21:06:20.337923 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
21:06:20.342424 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
21:06:20.342893 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.343100 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
21:06:20.343296 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.343649 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
21:06:20.343868 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
21:06:20.344192 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
21:06:20.344380 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
21:06:20.344562 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
21:06:20.350718 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
21:06:20.351159 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.351364 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
21:06:20.351554 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.351905 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
21:06:20.352126 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
21:06:20.352449 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a"
21:06:20.352638 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
21:06:20.352821 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
21:06:20.360117 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a"
21:06:20.361130 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.361415 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
21:06:20.361629 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.362055 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
21:06:20.362295 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
21:06:20.362621 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
21:06:20.362810 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
21:06:20.363000 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
21:06:20.369063 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
21:06:20.369542 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.369733 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
21:06:20.369921 [debug] [Thread-1  ]: finished collecting timing info
21:06:20.370266 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
21:06:20.371156 [debug] [MainThread]: Connection 'master' was properly closed.
21:06:20.371359 [debug] [MainThread]: Connection 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2' was properly closed.
21:06:20.388090 [info ] [MainThread]: Done.
21:06:20.391525 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
21:06:20.391760 [info ] [MainThread]: Building catalog
21:06:20.396974 [debug] [ThreadPool]: Acquiring new snowflake connection "angel.information_schema"
21:06:20.406496 [debug] [ThreadPool]: Using snowflake connection "angel.information_schema"
21:06:20.406716 [debug] [ThreadPool]: On angel.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "angel.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from angel.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from angel.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('workshop_live') or upper("table_schema") = upper('workshop_live_stg_fivetran_log') or upper("table_schema") = upper('workshop_live_fivetran_log') or upper("table_schema") = upper('fivetran_log'))
      order by "column_index"
21:06:20.406911 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:06:43.459425 [debug] [ThreadPool]: SQL status: SUCCESS 227 in 23.05 seconds
21:06:43.887454 [debug] [ThreadPool]: On angel.information_schema: Close
21:06:44.236881 [info ] [MainThread]: Catalog written to /Users/angel.hernandez/Fivetran/dbt/workshop_live/target/catalog.json
21:06:44.237565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb72130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccb72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cba74f0>]}
21:06:44.597619 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
21:06:44.598025 [debug] [MainThread]: Connection 'angel.information_schema' was properly closed.


============================== 2022-04-01 21:06:48.534333 | e94e50c5-4059-41c4-8c2c-a6f1f1cc1fba ==============================
21:06:48.534333 [info ] [MainThread]: Running with dbt=1.0.1
21:06:48.535194 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
21:06:48.535513 [debug] [MainThread]: Tracking: tracking
21:06:48.535941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd24160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd24190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd24460>]}
21:06:48.538939 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
21:06:48.539393 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
21:06:48.539707 [info ] [MainThread]: 
21:06:48.539980 [info ] [MainThread]: 
21:06:48.540247 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-04-26 16:07:06.470350 | aeb68ee6-66f8-4875-9a79-9d0cc07a8dac ==============================
16:07:06.470350 [info ] [MainThread]: Running with dbt=1.0.1
16:07:06.471174 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
16:07:06.471426 [debug] [MainThread]: Tracking: tracking
16:07:06.504529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068aeb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ba5e0>]}
16:07:07.916586 [debug] [MainThread]: Executing "git --help"
16:07:07.941419 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:07:07.942344 [debug] [MainThread]: STDERR: "b''"
16:07:07.951014 [debug] [MainThread]: Acquiring new snowflake connection "debug"
16:07:07.955099 [debug] [MainThread]: Using snowflake connection "debug"
16:07:07.955616 [debug] [MainThread]: On debug: select 1 as id
16:07:07.956269 [debug] [MainThread]: Opening a new connection, currently in state init
16:07:09.255296 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.3 seconds
16:07:09.256630 [debug] [MainThread]: On debug: Close
16:07:09.388582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6ce6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6ce670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6ce2e0>]}
16:07:09.829143 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-04-26 16:09:51.278765 | a9b724a7-d431-436c-a1d9-41ad22c273a3 ==============================
16:09:51.278765 [info ] [MainThread]: Running with dbt=1.0.1
16:09:51.281277 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
16:09:51.281615 [debug] [MainThread]: Tracking: tracking
16:09:51.282113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee06d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee06040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee064c0>]}
16:09:51.386542 [info ] [MainThread]: Unable to do partial parsing because profile has changed
16:09:51.387075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9b724a7-d431-436c-a1d9-41ad22c273a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee42370>]}
16:09:51.500427 [debug] [MainThread]: Parsing macros/catalog.sql
16:09:51.503480 [debug] [MainThread]: Parsing macros/adapters.sql
16:09:51.560534 [debug] [MainThread]: Parsing macros/materializations/merge.sql
16:09:51.566166 [debug] [MainThread]: Parsing macros/materializations/seed.sql
16:09:51.573924 [debug] [MainThread]: Parsing macros/materializations/view.sql
16:09:51.575881 [debug] [MainThread]: Parsing macros/materializations/table.sql
16:09:51.580647 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
16:09:51.593336 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
16:09:51.595146 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:09:51.600525 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:09:51.604021 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:09:51.606457 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:09:51.632460 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:09:51.648900 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:09:51.666230 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:09:51.672799 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:09:51.675665 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:09:51.678391 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:09:51.684963 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:09:51.700855 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:09:51.703025 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:09:51.719016 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:09:51.746674 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:09:51.759095 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:09:51.764098 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:09:51.775998 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:09:51.779479 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:09:51.784206 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:09:51.787639 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:09:51.797248 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:09:51.823223 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:09:51.825482 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:09:51.829748 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:09:51.832192 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:09:51.833529 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:09:51.834348 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:09:51.835378 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:09:51.837403 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:09:51.845001 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:09:51.857838 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:09:51.861764 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:09:51.866079 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:09:51.880265 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:09:51.884784 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:09:51.890802 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:09:51.901716 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:09:51.916566 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:09:51.921213 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
16:09:51.922822 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
16:09:51.924790 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
16:09:51.926448 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
16:09:51.935252 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
16:09:51.936771 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
16:09:51.938508 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
16:09:51.942356 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
16:09:51.944033 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
16:09:51.946521 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
16:09:51.949613 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
16:09:51.963710 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
16:09:51.966361 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
16:09:51.968287 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
16:09:51.970220 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
16:09:51.972615 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
16:09:51.976561 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
16:09:51.979071 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
16:09:51.980464 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
16:09:51.985865 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
16:09:51.993697 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
16:09:51.996279 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
16:09:52.001581 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
16:09:52.004743 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
16:09:52.007136 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
16:09:52.010712 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
16:09:52.050808 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
16:09:52.054028 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
16:09:52.057945 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
16:09:52.060300 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
16:09:52.062583 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
16:09:52.064829 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
16:09:52.066629 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
16:09:52.068362 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
16:09:52.070669 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
16:09:52.073100 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
16:09:52.076685 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
16:09:52.079348 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
16:09:52.081388 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
16:09:52.085157 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
16:09:52.088112 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
16:09:52.090079 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
16:09:52.092118 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
16:09:52.096844 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
16:09:52.099853 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
16:09:52.102658 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
16:09:52.105750 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
16:09:52.110476 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
16:09:52.112721 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
16:09:52.117806 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
16:09:52.131922 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
16:09:52.137892 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
16:09:52.140379 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
16:09:52.145771 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
16:09:52.152204 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
16:09:52.157553 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
16:09:52.160011 [debug] [MainThread]: Parsing macros/sql/star.sql
16:09:52.167946 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
16:09:52.180230 [debug] [MainThread]: Parsing macros/sql/union.sql
16:09:52.215495 [debug] [MainThread]: Parsing macros/sql/groupby.sql
16:09:52.217531 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
16:09:52.222661 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
16:09:52.225244 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
16:09:52.228477 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
16:09:52.237800 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
16:09:52.245949 [debug] [MainThread]: Parsing macros/sql/pivot.sql
16:09:52.252277 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
16:09:52.255827 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
16:09:52.257683 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
16:09:52.267309 [debug] [MainThread]: Parsing macros/maintenance_operation.sql
16:09:52.295649 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/concat.sql
16:09:52.297067 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/datatypes.sql
16:09:52.298108 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/dateadd.sql
16:09:52.307014 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/datediff.sql
16:09:52.328667 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/current_timestamp.sql
16:09:52.329756 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/split_part.sql
16:09:52.331903 [debug] [MainThread]: Parsing macros/dbt_utils/sql/get_relations_by_prefix.sql
16:09:52.339864 [debug] [MainThread]: Parsing macros/etc/assert_not_null.sql
16:09:52.342037 [debug] [MainThread]: Parsing macros/snowplow/convert_timezone.sql
16:09:52.343010 [debug] [MainThread]: Parsing macros/enabled_vars.sql
16:09:52.344573 [debug] [MainThread]: Parsing macros/percentile.sql
16:09:52.350183 [debug] [MainThread]: Parsing macros/pivot_json_extract.sql
16:09:52.352033 [debug] [MainThread]: Parsing macros/persist_pass_through_columns.sql
16:09:52.354020 [debug] [MainThread]: Parsing macros/json_parse.sql
16:09:52.362998 [debug] [MainThread]: Parsing macros/max_bool.sql
16:09:52.365450 [debug] [MainThread]: Parsing macros/calculated_fields.sql
16:09:52.366896 [debug] [MainThread]: Parsing macros/seed_data_helper.sql
16:09:52.368967 [debug] [MainThread]: Parsing macros/fill_pass_through_columns.sql
16:09:52.371167 [debug] [MainThread]: Parsing macros/string_agg.sql
16:09:52.374889 [debug] [MainThread]: Parsing macros/timestamp_diff.sql
16:09:52.389742 [debug] [MainThread]: Parsing macros/generate_docs.sql
16:09:52.391358 [debug] [MainThread]: Parsing macros/generate_columns_macro.sql
16:09:52.396871 [debug] [MainThread]: Parsing macros/source_relation.sql
16:09:52.400633 [debug] [MainThread]: Parsing macros/first_value.sql
16:09:52.403982 [debug] [MainThread]: Parsing macros/add_dbt_source_relation.sql
16:09:52.405077 [debug] [MainThread]: Parsing macros/add_pass_through_columns.sql
16:09:52.408293 [debug] [MainThread]: Parsing macros/staging_models_automation.sql
16:09:52.413146 [debug] [MainThread]: Parsing macros/union_relations.sql
16:09:52.426790 [debug] [MainThread]: Parsing macros/snowflake_seed_data.sql
16:09:52.428773 [debug] [MainThread]: Parsing macros/get_columns_for_macro.sql
16:09:52.434286 [debug] [MainThread]: Parsing macros/fill_staging_columns.sql
16:09:52.440975 [debug] [MainThread]: Parsing macros/json_extract.sql
16:09:52.446458 [debug] [MainThread]: Parsing macros/collect_freshness.sql
16:09:52.452198 [debug] [MainThread]: Parsing macros/timestamp_add.sql
16:09:52.457184 [debug] [MainThread]: Parsing macros/ceiling.sql
16:09:52.458972 [debug] [MainThread]: Parsing macros/remove_prefix_from_columns.sql
16:09:52.461588 [debug] [MainThread]: Parsing macros/union_data.sql
16:09:52.471677 [debug] [MainThread]: Parsing macros/dummy_coalesce_value.sql
16:09:52.477144 [debug] [MainThread]: Parsing macros/array_agg.sql
16:09:52.479669 [debug] [MainThread]: Parsing macros/empty_variable_warning.sql
16:09:52.481266 [debug] [MainThread]: Parsing macros/enabled_vars_one_true.sql
16:09:52.482821 [debug] [MainThread]: Parsing macros/get_brand_columns.sql
16:09:53.208757 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:09:53.225780 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:09:53.273916 [debug] [MainThread]: 1603: static parser failed on fivetran_log__transformation_status.sql
16:09:53.285833 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__transformation_status.sql
16:09:53.288012 [debug] [MainThread]: 1603: static parser failed on fivetran_log__connector_status.sql
16:09:53.330834 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__connector_status.sql
16:09:53.332586 [debug] [MainThread]: 1699: static parser successfully parsed fivetran_log__credit_mar_destination_history.sql
16:09:53.337067 [debug] [MainThread]: 1603: static parser failed on fivetran_log__audit_table.sql
16:09:53.388779 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__audit_table.sql
16:09:53.390763 [debug] [MainThread]: 1603: static parser failed on fivetran_log__mar_table_history.sql
16:09:53.405099 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__mar_table_history.sql
16:09:53.406771 [debug] [MainThread]: 1603: static parser failed on fivetran_log__schema_changelog.sql
16:09:53.416996 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__schema_changelog.sql
16:09:53.418845 [debug] [MainThread]: 1603: static parser failed on fivetran_log__connector_daily_events.sql
16:09:53.480057 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__connector_daily_events.sql
16:09:53.481694 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__credits_used.sql
16:09:53.488590 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__credits_used.sql
16:09:53.490168 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__destination_membership.sql
16:09:53.499179 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__destination_membership.sql
16:09:53.500780 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__transformation.sql
16:09:53.509122 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__transformation.sql
16:09:53.510881 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__account_membership.sql
16:09:53.520994 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__account_membership.sql
16:09:53.522755 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__connector.sql
16:09:53.558307 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__connector.sql
16:09:53.559949 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__destination.sql
16:09:53.568748 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__destination.sql
16:09:53.570362 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__active_volume.sql
16:09:53.577940 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__active_volume.sql
16:09:53.579571 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__user.sql
16:09:53.587301 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__user.sql
16:09:53.588814 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__log.sql
16:09:53.598062 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__log.sql
16:09:53.599650 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__account.sql
16:09:53.660482 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__account.sql
16:09:53.662203 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__trigger_table.sql
16:09:53.671455 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__trigger_table.sql
16:09:53.673252 [debug] [MainThread]: 1603: static parser failed on staging/tmp/stg_fivetran_log__connector_tmp.sql
16:09:53.680741 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/tmp/stg_fivetran_log__connector_tmp.sql
16:09:54.130356 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__transformation_status_destination_id__transformation_id.4c7bf174ec' (models/fivetran_log.yml) depends on a node named 'fivetran_log__transformation_status' which is disabled
16:09:54.131025 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__transformation_transformation_id__destination_id.53b3485eb3' (models/staging/stg_fivetran_log.yml) depends on a node named 'stg_fivetran_log__transformation' which is disabled
16:09:54.131418 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__trigger_table_trigger_table__transformation_id.124bb8d5ca' (models/staging/stg_fivetran_log.yml) depends on a node named 'stg_fivetran_log__trigger_table' which is disabled
16:09:54.205357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9b724a7-d431-436c-a1d9-41ad22c273a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9560d0>]}
16:09:54.231979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9b724a7-d431-436c-a1d9-41ad22c273a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f869550>]}
16:09:54.232401 [info ] [MainThread]: Found 18 models, 23 tests, 0 snapshots, 0 analyses, 479 macros, 0 operations, 0 seed files, 11 sources, 0 exposures, 0 metrics
16:09:54.236830 [info ] [MainThread]: 
16:09:54.237547 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:09:54.239551 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live"
16:09:54.253718 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live"
16:09:54.254017 [debug] [ThreadPool]: On list_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live"} */

    show terse objects in angel.workshop_live
16:09:54.254226 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:09:56.528449 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.27 seconds
16:09:56.532411 [debug] [ThreadPool]: On list_angel_workshop_live: Close
16:09:56.664732 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_fivetran_log"
16:09:56.672546 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_fivetran_log"
16:09:56.672971 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_fivetran_log"} */

    show terse objects in angel.workshop_live_fivetran_log
16:09:56.673277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:09:57.975452 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.3 seconds
16:09:57.978993 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: Close
16:09:58.646186 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_stg_fivetran_log"
16:09:58.651105 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_stg_fivetran_log"
16:09:58.651629 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_stg_fivetran_log"} */

    show terse objects in angel.workshop_live_stg_fivetran_log
16:09:58.652178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:09:59.654095 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
16:09:59.656471 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: Close
16:09:59.783629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:09:59.784114 [info ] [MainThread]: 
16:09:59.789912 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account
16:09:59.790809 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account"
16:09:59.791066 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account
16:09:59.791303 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account
16:09:59.799021 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account"
16:09:59.801081 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.801361 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account
16:09:59.801606 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.802221 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account
16:09:59.802491 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account_membership
16:09:59.803225 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
16:09:59.803540 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account_membership
16:09:59.803757 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account_membership
16:09:59.810453 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
16:09:59.811529 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.811855 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account_membership
16:09:59.812143 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.812660 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account_membership
16:09:59.812929 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__active_volume
16:09:59.813872 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
16:09:59.814223 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__active_volume
16:09:59.814585 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__active_volume
16:09:59.821365 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
16:09:59.822484 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.822761 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__active_volume
16:09:59.822994 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.823630 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__active_volume
16:09:59.823901 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector_tmp
16:09:59.824488 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
16:09:59.824714 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector_tmp
16:09:59.824918 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector_tmp
16:09:59.830605 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
16:09:59.861481 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.861782 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector_tmp
16:09:59.862016 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.862484 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector_tmp
16:09:59.862743 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__credits_used
16:09:59.863388 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
16:09:59.863656 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__credits_used
16:09:59.864067 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__credits_used
16:09:59.870255 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
16:09:59.870902 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.871258 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__credits_used
16:09:59.871605 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.872165 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__credits_used
16:09:59.872452 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination
16:09:59.873005 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
16:09:59.873342 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination
16:09:59.873569 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination
16:09:59.880565 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination"
16:09:59.881633 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.882068 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination
16:09:59.882332 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.882787 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination
16:09:59.883060 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination_membership
16:09:59.883740 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
16:09:59.883980 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination_membership
16:09:59.884201 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination_membership
16:09:59.890957 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
16:09:59.891592 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.891834 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination_membership
16:09:59.892059 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.892570 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination_membership
16:09:59.892853 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__log
16:09:59.893598 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__log"
16:09:59.893820 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__log
16:09:59.894025 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__log
16:09:59.900546 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__log"
16:09:59.901226 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.901569 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__log
16:09:59.901834 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.902284 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__log
16:09:59.902542 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__user
16:09:59.903167 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__user"
16:09:59.903429 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__user
16:09:59.903643 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__user
16:09:59.909228 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__user"
16:09:59.909887 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.910128 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__user
16:09:59.910351 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.910794 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__user
16:09:59.911066 [debug] [Thread-1  ]: Began running node model.workshop_live.my_first_dbt_model
16:09:59.911965 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_first_dbt_model"
16:09:59.912219 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_first_dbt_model
16:09:59.912437 [debug] [Thread-1  ]: Compiling model.workshop_live.my_first_dbt_model
16:09:59.916477 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_first_dbt_model"
16:09:59.917535 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.917961 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_first_dbt_model
16:09:59.918240 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.918698 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_first_dbt_model
16:09:59.918974 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:09:59.919361 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
16:09:59.919736 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:09:59.920204 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:09:59.929390 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
16:09:59.932127 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.932414 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:09:59.932714 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.933212 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:09:59.933475 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:09:59.933971 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
16:09:59.934196 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:09:59.934403 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:09:59.945126 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
16:09:59.945874 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.946139 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:09:59.946369 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.946815 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:09:59.947084 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:09:59.947574 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
16:09:59.947787 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:09:59.947993 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:09:59.956076 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
16:09:59.956847 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.957088 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:09:59.957308 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.957750 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:09:59.958305 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:09:59.958960 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
16:09:59.959263 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:09:59.959614 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:09:59.968026 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
16:09:59.968782 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.969016 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:09:59.969245 [debug] [Thread-1  ]: finished collecting timing info
16:09:59.969689 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:09:59.969947 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector
16:09:59.970443 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
16:09:59.970659 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector
16:09:59.970865 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector
16:09:59.990014 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
16:09:59.990305 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */

    describe table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp
16:09:59.990509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:10:00.765549 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.78 seconds
16:10:00.780743 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector"
16:10:00.781425 [debug] [Thread-1  ]: finished collecting timing info
16:10:00.781666 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector
16:10:00.781898 [debug] [Thread-1  ]: finished collecting timing info
16:10:00.782132 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: Close
16:10:01.124624 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector
16:10:01.125003 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:10:01.125696 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
16:10:01.126156 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:10:01.127051 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:10:01.134778 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
16:10:01.135443 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.135674 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:10:01.135897 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.136329 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:10:01.136593 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:10:01.137091 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
16:10:01.137324 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:10:01.137533 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:10:01.143503 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
16:10:01.144146 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.144370 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:10:01.144668 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.145134 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:10:01.145395 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:10:01.146196 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
16:10:01.146558 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:10:01.146806 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:10:01.153216 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
16:10:01.154242 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.154527 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:10:01.154775 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.155228 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:10:01.155485 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:10:01.155912 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
16:10:01.156331 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:10:01.156561 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:10:01.163482 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
16:10:01.164256 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.164549 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:10:01.164791 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.165249 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:10:01.165583 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:10:01.166456 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
16:10:01.166701 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:10:01.166916 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:10:01.174790 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
16:10:01.175913 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.176276 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:10:01.176553 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.177018 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:10:01.177285 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:10:01.177769 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
16:10:01.177999 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:10:01.178209 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:10:01.184213 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
16:10:01.185278 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.185510 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:10:01.185733 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.186490 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:10:01.186802 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:10:01.187219 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
16:10:01.187462 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:10:01.187780 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:10:01.195040 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
16:10:01.195723 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.195987 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:10:01.196314 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.196874 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:10:01.197150 [debug] [Thread-1  ]: Began running node model.workshop_live.my_second_dbt_model
16:10:01.197685 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_second_dbt_model"
16:10:01.197924 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_second_dbt_model
16:10:01.198144 [debug] [Thread-1  ]: Compiling model.workshop_live.my_second_dbt_model
16:10:01.202060 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_second_dbt_model"
16:10:01.202673 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.202896 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_second_dbt_model
16:10:01.203117 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.203537 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_second_dbt_model
16:10:01.203789 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:10:01.204262 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
16:10:01.204623 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:10:01.204940 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:10:01.210403 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
16:10:01.211095 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.211345 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:10:01.211574 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.212042 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:10:01.212298 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:10:01.212676 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
16:10:01.212893 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:10:01.213116 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:10:01.219066 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
16:10:01.219732 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.219973 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:10:01.220198 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.220691 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:10:01.220967 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_status
16:10:01.221562 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_status"
16:10:01.221796 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_status
16:10:01.222017 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_status
16:10:01.240711 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_status"
16:10:01.242133 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.242382 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_status
16:10:01.242615 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.243045 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_status
16:10:01.243302 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__mar_table_history
16:10:01.243939 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
16:10:01.244160 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__mar_table_history
16:10:01.244362 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__mar_table_history
16:10:01.250514 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
16:10:01.251752 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.252134 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__mar_table_history
16:10:01.252476 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.252944 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__mar_table_history
16:10:01.253204 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:10:01.253589 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
16:10:01.253802 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:10:01.254011 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:10:01.262521 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
16:10:01.264615 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.264880 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:10:01.265112 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.265555 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:10:01.265851 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:10:01.266373 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
16:10:01.266619 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:10:01.266833 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:10:01.340713 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
16:10:01.341521 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.341902 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:10:01.342251 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.342739 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:10:01.343011 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:10:01.343551 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
16:10:01.343774 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:10:01.344068 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:10:01.351413 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
16:10:01.352179 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.352434 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:10:01.352675 [debug] [Thread-1  ]: finished collecting timing info
16:10:01.353136 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:10:01.353400 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__audit_table
16:10:01.353894 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:10:01.354109 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__audit_table
16:10:01.354319 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__audit_table
16:10:01.373231 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:10:01.373534 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
select date(max(sync_start)) from angel.workshop_live_fivetran_log.fivetran_log__audit_table
16:10:01.373744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:10:02.590370 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.22 seconds
16:10:02.607276 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__audit_table"
16:10:02.608001 [debug] [Thread-1  ]: finished collecting timing info
16:10:02.608242 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__audit_table
16:10:02.608469 [debug] [Thread-1  ]: finished collecting timing info
16:10:02.608699 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: Close
16:10:02.751186 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__audit_table
16:10:02.751518 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_daily_events
16:10:02.752019 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:10:02.752330 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_daily_events
16:10:02.752564 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_daily_events
16:10:02.769098 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:10:02.769404 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */

    
        select  min( signed_up ) as min_date from angel.fivetran_log.connector
16:10:02.769618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:10:03.818870 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.05 seconds
16:10:03.825014 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:10:03.825250 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


        select 

    datediff(
        day,
        cast('2020-08-12' as date),
        

    dateadd(
        week,
        1,
        
    date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)

        )


        )
16:10:03.980658 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
16:10:03.986150 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
16:10:03.986864 [debug] [Thread-1  ]: finished collecting timing info
16:10:03.987106 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_daily_events
16:10:03.987355 [debug] [Thread-1  ]: finished collecting timing info
16:10:03.987598 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: Close
16:10:04.271980 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_daily_events
16:10:04.272398 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__schema_changelog
16:10:04.273018 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
16:10:04.273262 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__schema_changelog
16:10:04.273474 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__schema_changelog
16:10:04.281808 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
16:10:04.282732 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.283092 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__schema_changelog
16:10:04.283495 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.283981 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__schema_changelog
16:10:04.284251 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:10:04.284745 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
16:10:04.285054 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:10:04.285312 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:10:04.292666 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
16:10:04.293393 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.293627 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:10:04.293849 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.294295 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:10:04.294551 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:10:04.295067 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
16:10:04.295316 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:10:04.295526 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__credit_mar_destination_history
16:10:04.300398 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
16:10:04.301645 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.301888 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:10:04.302105 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.302548 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:10:04.302799 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:10:04.303365 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
16:10:04.303586 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:10:04.303788 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:10:04.311860 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
16:10:04.312519 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.312749 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:10:04.312968 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.313396 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:10:04.313728 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:10:04.314232 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
16:10:04.314445 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:10:04.314649 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:10:04.319808 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
16:10:04.320444 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.320667 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:10:04.320884 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.321308 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:10:04.321565 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:10:04.321936 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
16:10:04.322149 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:10:04.322476 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:10:04.327738 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
16:10:04.328757 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.329046 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:10:04.329273 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.329756 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:10:04.330018 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:10:04.330416 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
16:10:04.330643 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:10:04.330866 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:10:04.342212 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
16:10:04.342994 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.343316 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:10:04.343706 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.344193 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:10:04.344529 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
16:10:04.345007 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a"
16:10:04.345220 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
16:10:04.345425 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
16:10:04.353201 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a"
16:10:04.353914 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.354148 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
16:10:04.354382 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.354833 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__created_at.f806c2596a
16:10:04.355103 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:10:04.355593 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
16:10:04.355816 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:10:04.356100 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:10:04.363540 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
16:10:04.364254 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.364491 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:10:04.364709 [debug] [Thread-1  ]: finished collecting timing info
16:10:04.365151 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:10:04.366178 [debug] [MainThread]: Connection 'master' was properly closed.
16:10:04.366401 [debug] [MainThread]: Connection 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2' was properly closed.
16:10:04.386887 [info ] [MainThread]: Done.
16:10:04.390265 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
16:10:04.390556 [info ] [MainThread]: Building catalog
16:10:04.396887 [debug] [ThreadPool]: Acquiring new snowflake connection "angel.information_schema"
16:10:04.408225 [debug] [ThreadPool]: Using snowflake connection "angel.information_schema"
16:10:04.408507 [debug] [ThreadPool]: On angel.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "angel.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from angel.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from angel.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('workshop_live') or upper("table_schema") = upper('fivetran_log') or upper("table_schema") = upper('workshop_live_fivetran_log') or upper("table_schema") = upper('workshop_live_stg_fivetran_log'))
      order by "column_index"
16:10:04.408717 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:10:27.816653 [debug] [ThreadPool]: SQL status: SUCCESS 227 in 23.41 seconds
16:10:28.549784 [debug] [ThreadPool]: On angel.information_schema: Close
16:10:28.744944 [info ] [MainThread]: Catalog written to /Users/angel.hernandez/Fivetran/dbt/workshop_live/target/catalog.json
16:10:28.745712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af411f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1068b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b106a00>]}
16:10:29.175949 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
16:10:29.176249 [debug] [MainThread]: Connection 'angel.information_schema' was properly closed.


============================== 2022-04-26 16:10:34.326413 | f29e20e6-2b01-45e6-938a-ccd01ee9b583 ==============================
16:10:34.326413 [info ] [MainThread]: Running with dbt=1.0.1
16:10:34.327914 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
16:10:34.328290 [debug] [MainThread]: Tracking: tracking
16:10:34.328961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b66f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b66f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b66f8e0>]}
16:10:34.332580 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
16:10:34.333176 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
16:10:34.333612 [info ] [MainThread]: 
16:10:34.333959 [info ] [MainThread]: 
16:10:34.334286 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-04-26 16:15:18.019942 | 7092416b-8994-4e2b-a094-809e8ec4ad4f ==============================
16:15:18.019942 [info ] [MainThread]: Running with dbt=1.0.1
16:15:18.022924 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
16:15:18.023559 [debug] [MainThread]: Tracking: tracking
16:15:18.083342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e626790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e62e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7313a0>]}
16:15:19.498201 [debug] [MainThread]: Executing "git --help"
16:15:19.529725 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:15:19.530886 [debug] [MainThread]: STDERR: "b''"
16:15:19.540436 [debug] [MainThread]: Acquiring new snowflake connection "debug"
16:15:19.543545 [debug] [MainThread]: Using snowflake connection "debug"
16:15:19.543864 [debug] [MainThread]: On debug: select 1 as id
16:15:19.544165 [debug] [MainThread]: Opening a new connection, currently in state init
16:15:20.553723 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.01 seconds
16:15:20.555116 [debug] [MainThread]: On debug: Close
16:15:20.664665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225f1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224d7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224d79d0>]}
16:15:20.997839 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-04-26 16:22:29.756279 | 97f48365-8015-4aee-836e-e7c62178b2cd ==============================
16:22:29.756279 [info ] [MainThread]: Running with dbt=1.0.1
16:22:29.756978 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
16:22:29.757192 [debug] [MainThread]: Tracking: tracking
16:22:29.788340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df10b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df19040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e01b3a0>]}
16:22:31.273763 [debug] [MainThread]: Executing "git --help"
16:22:31.298426 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:22:31.299157 [debug] [MainThread]: STDERR: "b''"
16:22:31.308848 [debug] [MainThread]: Acquiring new snowflake connection "debug"
16:22:31.312867 [debug] [MainThread]: Using snowflake connection "debug"
16:22:31.313235 [debug] [MainThread]: On debug: select 1 as id
16:22:31.313538 [debug] [MainThread]: Opening a new connection, currently in state init
16:22:32.964088 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.65 seconds
16:22:32.965438 [debug] [MainThread]: On debug: Close
16:22:33.128661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dc54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e034ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dcf1f0>]}
16:22:33.924861 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-04-26 16:24:22.749956 | 49b45756-303a-4bd2-8324-b874b70864e3 ==============================
16:24:22.749956 [info ] [MainThread]: Running with dbt=1.0.1
16:24:22.750818 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
16:24:22.751068 [debug] [MainThread]: Tracking: tracking
16:24:22.751352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cbe160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cbe7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cbe820>]}
16:24:22.753639 [debug] [MainThread]: Set downloads directory='/var/folders/mk/2ztnrxy17z11rwb071p5c8c80000gp/T/dbt-downloads-k5dnun4i'
16:24:22.754073 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
16:24:22.918492 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
16:24:22.918933 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json
16:24:23.013672 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json 200
16:24:23.017153 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.4.json
16:24:23.298546 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.4.json 200
16:24:23.299226 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
16:24:23.401851 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
16:24:23.415280 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.7.json
16:24:23.791798 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.7.json 200
16:24:23.792458 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
16:24:23.896615 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
16:24:23.899646 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json
16:24:24.035102 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json 200
16:24:24.035604 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
16:24:24.210481 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
16:24:24.249565 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json
16:24:24.285552 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json 200
16:24:24.285945 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json
16:24:24.406476 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log.json 200
16:24:24.410651 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
16:24:24.452687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
16:24:24.465848 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
16:24:24.501363 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
16:24:24.504766 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
16:24:24.542113 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
16:24:24.585010 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.4.json
16:24:24.869107 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_log/0.5.4.json 200
16:24:24.869502 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.7.json
16:24:24.915177 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils/0.3.7.json 200
16:24:24.915559 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json
16:24:24.965026 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils/0.3.0.json 200
16:24:24.965418 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json
16:24:25.015226 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.4.json 200
16:24:25.015686 [info ] [MainThread]: Installing fivetran/fivetran_log
16:24:25.480817 [info ] [MainThread]:   Installed from version 0.5.4
16:24:25.481278 [info ] [MainThread]:   Up to date!
16:24:25.481680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '49b45756-303a-4bd2-8324-b874b70864e3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cbeeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cbe430>]}
16:24:25.481995 [info ] [MainThread]: Installing fivetran/fivetran_utils
16:24:25.999981 [info ] [MainThread]:   Installed from version 0.3.7
16:24:26.000430 [info ] [MainThread]:   Up to date!
16:24:26.000833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '49b45756-303a-4bd2-8324-b874b70864e3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d20b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d205e0>]}
16:24:26.001157 [info ] [MainThread]: Installing dbt-labs/spark_utils
16:24:26.328505 [info ] [MainThread]:   Installed from version 0.3.0
16:24:26.329225 [info ] [MainThread]:   Up to date!
16:24:26.329909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '49b45756-303a-4bd2-8324-b874b70864e3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d20430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d20820>]}
16:24:26.330456 [info ] [MainThread]: Installing dbt-labs/dbt_utils
16:24:26.884076 [info ] [MainThread]:   Installed from version 0.8.4
16:24:26.884423 [info ] [MainThread]:   Up to date!
16:24:26.884727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '49b45756-303a-4bd2-8324-b874b70864e3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bec250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126beeac0>]}
16:24:26.886969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bee2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126beecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bee580>]}


============================== 2022-04-26 16:33:17.117087 | 0e82fc36-5d78-4e3d-adb0-7e49a9d75d3f ==============================
16:33:17.117087 [info ] [MainThread]: Running with dbt=1.0.1
16:33:17.138950 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
16:33:17.143569 [debug] [MainThread]: Tracking: tracking
16:33:17.150069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ad8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096adac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ad040>]}
16:33:17.510068 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:33:17.510922 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:33:17.511462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0e82fc36-5d78-4e3d-adb0-7e49a9d75d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103757b20>]}
16:33:17.672090 [debug] [MainThread]: Parsing macros/catalog.sql
16:33:17.675621 [debug] [MainThread]: Parsing macros/adapters.sql
16:33:17.739744 [debug] [MainThread]: Parsing macros/materializations/merge.sql
16:33:17.747466 [debug] [MainThread]: Parsing macros/materializations/seed.sql
16:33:17.757186 [debug] [MainThread]: Parsing macros/materializations/view.sql
16:33:17.760414 [debug] [MainThread]: Parsing macros/materializations/table.sql
16:33:17.765195 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
16:33:17.780200 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
16:33:17.782881 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:33:17.789060 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:33:17.793289 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:33:17.795709 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:33:17.826402 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:33:17.844474 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:33:17.864203 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:33:17.873003 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:33:17.877172 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:33:17.881283 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:33:17.891013 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:33:17.913686 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:33:17.917869 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:33:17.939375 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:33:17.970925 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:33:17.986112 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:33:17.991329 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:33:18.005797 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:33:18.008185 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:33:18.012309 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:33:18.016701 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:33:18.027236 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:33:18.061835 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:33:18.065764 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:33:18.073397 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:33:18.078251 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:33:18.080838 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:33:18.082351 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:33:18.084231 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:33:18.087549 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:33:18.096882 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:33:18.115188 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:33:18.118873 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:33:18.124156 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:33:18.141094 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:33:18.145896 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:33:18.153002 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:33:18.165727 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:33:18.180810 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:33:18.185239 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
16:33:18.187043 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
16:33:18.188832 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
16:33:18.190551 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
16:33:18.199968 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
16:33:18.201754 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
16:33:18.204426 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
16:33:18.208908 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
16:33:18.210612 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
16:33:18.213217 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
16:33:18.217241 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
16:33:18.230477 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
16:33:18.246416 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
16:33:18.249235 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
16:33:18.251549 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
16:33:18.253925 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
16:33:18.256448 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
16:33:18.258333 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
16:33:18.260630 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
16:33:18.262246 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
16:33:18.267746 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
16:33:18.276014 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
16:33:18.278393 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
16:33:18.283763 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
16:33:18.286549 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
16:33:18.288825 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
16:33:18.291726 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
16:33:18.328614 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
16:33:18.331695 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
16:33:18.335480 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
16:33:18.337817 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
16:33:18.340143 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
16:33:18.342466 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
16:33:18.345372 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
16:33:18.347835 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
16:33:18.349604 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
16:33:18.353428 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
16:33:18.356305 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
16:33:18.358180 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
16:33:18.359799 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
16:33:18.363453 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
16:33:18.366021 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
16:33:18.368456 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
16:33:18.371592 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
16:33:18.375885 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
16:33:18.377915 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
16:33:18.382583 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
16:33:18.394635 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
16:33:18.396351 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
16:33:18.398059 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
16:33:18.399603 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
16:33:18.401298 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
16:33:18.407410 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
16:33:18.410144 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
16:33:18.414815 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
16:33:18.421445 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
16:33:18.426297 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
16:33:18.428515 [debug] [MainThread]: Parsing macros/sql/star.sql
16:33:18.433142 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
16:33:18.444598 [debug] [MainThread]: Parsing macros/sql/union.sql
16:33:18.460657 [debug] [MainThread]: Parsing macros/sql/groupby.sql
16:33:18.462822 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
16:33:18.467839 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
16:33:18.473125 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
16:33:18.475552 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
16:33:18.479022 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
16:33:18.490893 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
16:33:18.499647 [debug] [MainThread]: Parsing macros/sql/pivot.sql
16:33:18.506480 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
16:33:18.511285 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
16:33:18.514631 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
16:33:18.517558 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
16:33:18.527192 [debug] [MainThread]: Parsing macros/maintenance_operation.sql
16:33:18.562171 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/concat.sql
16:33:18.563598 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/datatypes.sql
16:33:18.564251 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/dateadd.sql
16:33:18.574334 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/datediff.sql
16:33:18.597707 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/current_timestamp.sql
16:33:18.598910 [debug] [MainThread]: Parsing macros/dbt_utils/cross_db_utils/split_part.sql
16:33:18.601520 [debug] [MainThread]: Parsing macros/dbt_utils/sql/get_relations_by_prefix.sql
16:33:18.612036 [debug] [MainThread]: Parsing macros/etc/assert_not_null.sql
16:33:18.614956 [debug] [MainThread]: Parsing macros/snowplow/convert_timezone.sql
16:33:18.615977 [debug] [MainThread]: Parsing macros/enabled_vars.sql
16:33:18.618060 [debug] [MainThread]: Parsing macros/percentile.sql
16:33:18.623631 [debug] [MainThread]: Parsing macros/pivot_json_extract.sql
16:33:18.625252 [debug] [MainThread]: Parsing macros/persist_pass_through_columns.sql
16:33:18.627006 [debug] [MainThread]: Parsing macros/json_parse.sql
16:33:18.635959 [debug] [MainThread]: Parsing macros/max_bool.sql
16:33:18.638396 [debug] [MainThread]: Parsing macros/calculated_fields.sql
16:33:18.639836 [debug] [MainThread]: Parsing macros/seed_data_helper.sql
16:33:18.641901 [debug] [MainThread]: Parsing macros/fill_pass_through_columns.sql
16:33:18.643961 [debug] [MainThread]: Parsing macros/string_agg.sql
16:33:18.647577 [debug] [MainThread]: Parsing macros/timestamp_diff.sql
16:33:18.663632 [debug] [MainThread]: Parsing macros/try_cast.sql
16:33:18.670687 [debug] [MainThread]: Parsing macros/generate_docs.sql
16:33:18.672164 [debug] [MainThread]: Parsing macros/generate_columns_macro.sql
16:33:18.676980 [debug] [MainThread]: Parsing macros/source_relation.sql
16:33:18.680669 [debug] [MainThread]: Parsing macros/first_value.sql
16:33:18.684022 [debug] [MainThread]: Parsing macros/add_dbt_source_relation.sql
16:33:18.685120 [debug] [MainThread]: Parsing macros/add_pass_through_columns.sql
16:33:18.688094 [debug] [MainThread]: Parsing macros/staging_models_automation.sql
16:33:18.692478 [debug] [MainThread]: Parsing macros/union_relations.sql
16:33:18.705559 [debug] [MainThread]: Parsing macros/snowflake_seed_data.sql
16:33:18.706951 [debug] [MainThread]: Parsing macros/get_columns_for_macro.sql
16:33:18.711915 [debug] [MainThread]: Parsing macros/fill_staging_columns.sql
16:33:18.718522 [debug] [MainThread]: Parsing macros/json_extract.sql
16:33:18.722786 [debug] [MainThread]: Parsing macros/collect_freshness.sql
16:33:18.728126 [debug] [MainThread]: Parsing macros/timestamp_add.sql
16:33:18.732878 [debug] [MainThread]: Parsing macros/ceiling.sql
16:33:18.735079 [debug] [MainThread]: Parsing macros/remove_prefix_from_columns.sql
16:33:18.737385 [debug] [MainThread]: Parsing macros/union_data.sql
16:33:18.746077 [debug] [MainThread]: Parsing macros/dummy_coalesce_value.sql
16:33:18.751598 [debug] [MainThread]: Parsing macros/array_agg.sql
16:33:18.753365 [debug] [MainThread]: Parsing macros/empty_variable_warning.sql
16:33:18.754754 [debug] [MainThread]: Parsing macros/enabled_vars_one_true.sql
16:33:18.756246 [debug] [MainThread]: Parsing macros/get_brand_columns.sql
16:33:19.517849 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:33:19.534524 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:33:19.581885 [debug] [MainThread]: 1603: static parser failed on fivetran_log__transformation_status.sql
16:33:19.596859 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__transformation_status.sql
16:33:19.599703 [debug] [MainThread]: 1603: static parser failed on fivetran_log__connector_status.sql
16:33:19.645497 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__connector_status.sql
16:33:19.647115 [debug] [MainThread]: 1699: static parser successfully parsed fivetran_log__credit_mar_destination_history.sql
16:33:19.655481 [debug] [MainThread]: 1603: static parser failed on fivetran_log__audit_table.sql
16:33:19.783402 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__audit_table.sql
16:33:19.785278 [debug] [MainThread]: 1603: static parser failed on fivetran_log__mar_table_history.sql
16:33:19.797073 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__mar_table_history.sql
16:33:19.798773 [debug] [MainThread]: 1603: static parser failed on fivetran_log__schema_changelog.sql
16:33:19.810685 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__schema_changelog.sql
16:33:19.812532 [debug] [MainThread]: 1603: static parser failed on fivetran_log__connector_daily_events.sql
16:33:19.869027 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fivetran_log__connector_daily_events.sql
16:33:19.870619 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__credits_used.sql
16:33:19.879170 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__credits_used.sql
16:33:19.880994 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__destination_membership.sql
16:33:19.889776 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__destination_membership.sql
16:33:19.891414 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__transformation.sql
16:33:19.899790 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__transformation.sql
16:33:19.901485 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__account_membership.sql
16:33:19.909873 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__account_membership.sql
16:33:19.911518 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__connector.sql
16:33:19.944950 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__connector.sql
16:33:19.946597 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__destination.sql
16:33:19.955328 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__destination.sql
16:33:19.957690 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__active_volume.sql
16:33:19.966842 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__active_volume.sql
16:33:19.968752 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__user.sql
16:33:19.976351 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__user.sql
16:33:19.977898 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__log.sql
16:33:19.985499 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__log.sql
16:33:19.987108 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__account.sql
16:33:19.994387 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__account.sql
16:33:19.995962 [debug] [MainThread]: 1603: static parser failed on staging/stg_fivetran_log__trigger_table.sql
16:33:20.005876 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_fivetran_log__trigger_table.sql
16:33:20.007553 [debug] [MainThread]: 1603: static parser failed on staging/tmp/stg_fivetran_log__connector_tmp.sql
16:33:20.014226 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/tmp/stg_fivetran_log__connector_tmp.sql
16:33:20.397452 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__transformation_status_destination_id__transformation_id.4c7bf174ec' (models/fivetran_log.yml) depends on a node named 'fivetran_log__transformation_status' which is disabled
16:33:20.398017 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__transformation_transformation_id__destination_id.53b3485eb3' (models/staging/stg_fivetran_log.yml) depends on a node named 'stg_fivetran_log__transformation' which is disabled
16:33:20.398401 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__trigger_table_trigger_table__transformation_id.124bb8d5ca' (models/staging/stg_fivetran_log.yml) depends on a node named 'stg_fivetran_log__trigger_table' which is disabled
16:33:20.457047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e82fc36-5d78-4e3d-adb0-7e49a9d75d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180a30d0>]}
16:33:20.487427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e82fc36-5d78-4e3d-adb0-7e49a9d75d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ad910>]}
16:33:20.487868 [info ] [MainThread]: Found 18 models, 23 tests, 0 snapshots, 0 analyses, 497 macros, 0 operations, 0 seed files, 11 sources, 0 exposures, 0 metrics
16:33:20.492356 [info ] [MainThread]: 
16:33:20.493035 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:33:20.495023 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_stg_fivetran_log"
16:33:20.509020 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_stg_fivetran_log"
16:33:20.509321 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_stg_fivetran_log"} */

    show terse objects in angel.workshop_live_stg_fivetran_log
16:33:20.509533 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:33:21.667615 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.16 seconds
16:33:21.670821 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: Close
16:33:22.019688 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live"
16:33:22.024370 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live"
16:33:22.024634 [debug] [ThreadPool]: On list_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live"} */

    show terse objects in angel.workshop_live
16:33:22.024837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:33:22.881780 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.86 seconds
16:33:22.884357 [debug] [ThreadPool]: On list_angel_workshop_live: Close
16:33:23.037064 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_fivetran_log"
16:33:23.041124 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_fivetran_log"
16:33:23.041401 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_fivetran_log"} */

    show terse objects in angel.workshop_live_fivetran_log
16:33:23.041601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:33:23.703258 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.66 seconds
16:33:23.705365 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: Close
16:33:23.840594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:33:23.841063 [info ] [MainThread]: 
16:33:23.846027 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account
16:33:23.847239 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account"
16:33:23.847526 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account
16:33:23.847769 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account
16:33:23.853432 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account"
16:33:23.854940 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.855182 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account
16:33:23.855403 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.855924 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account
16:33:23.856187 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account_membership
16:33:23.856705 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
16:33:23.857029 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account_membership
16:33:23.857273 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account_membership
16:33:23.864323 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
16:33:23.865708 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.866077 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account_membership
16:33:23.866431 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.867019 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account_membership
16:33:23.867284 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__active_volume
16:33:23.867802 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
16:33:23.868124 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__active_volume
16:33:23.868330 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__active_volume
16:33:23.874553 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
16:33:23.875577 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.875884 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__active_volume
16:33:23.876274 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.876759 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__active_volume
16:33:23.877020 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector_tmp
16:33:23.877661 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
16:33:23.877896 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector_tmp
16:33:23.878166 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector_tmp
16:33:23.884957 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
16:33:23.886033 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.886472 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector_tmp
16:33:23.886860 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.887775 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector_tmp
16:33:23.888093 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__credits_used
16:33:23.888653 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
16:33:23.889000 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__credits_used
16:33:23.889240 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__credits_used
16:33:23.893938 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
16:33:23.894562 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.894789 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__credits_used
16:33:23.895008 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.895444 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__credits_used
16:33:23.895698 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination
16:33:23.896331 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
16:33:23.896553 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination
16:33:23.896972 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination
16:33:23.905078 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination"
16:33:23.906160 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.906465 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination
16:33:23.906758 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.907243 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination
16:33:23.907521 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination_membership
16:33:23.907961 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
16:33:23.908307 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination_membership
16:33:23.908684 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination_membership
16:33:23.915103 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
16:33:23.915878 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.916311 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination_membership
16:33:23.916640 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.917246 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination_membership
16:33:23.917510 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__log
16:33:23.918196 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__log"
16:33:23.918424 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__log
16:33:23.918707 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__log
16:33:23.924377 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__log"
16:33:23.924946 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.925265 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__log
16:33:23.925546 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.925994 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__log
16:33:23.926254 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__user
16:33:23.926846 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__user"
16:33:23.927062 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__user
16:33:23.927264 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__user
16:33:23.934270 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__user"
16:33:23.934910 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.935199 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__user
16:33:23.935422 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.935852 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__user
16:33:23.936186 [debug] [Thread-1  ]: Began running node model.workshop_live.my_first_dbt_model
16:33:23.936882 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_first_dbt_model"
16:33:23.937158 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_first_dbt_model
16:33:23.937396 [debug] [Thread-1  ]: Compiling model.workshop_live.my_first_dbt_model
16:33:23.941231 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_first_dbt_model"
16:33:23.942162 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.942404 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_first_dbt_model
16:33:23.942625 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.943329 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_first_dbt_model
16:33:23.943580 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:33:23.944242 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
16:33:23.944461 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:33:23.944660 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:33:23.955028 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a"
16:33:23.957395 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.957664 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:33:23.957892 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.958346 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__account_account_id.19a03e662a
16:33:23.958597 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:33:23.959072 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
16:33:23.959317 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:33:23.959547 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:33:23.969832 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc"
16:33:23.970506 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.970735 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:33:23.970952 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.971388 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__account_account_id.3de58e95dc
16:33:23.971638 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:33:23.972114 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
16:33:23.972328 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:33:23.972531 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:33:23.979742 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6"
16:33:23.980428 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.980702 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:33:23.980926 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.981371 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__account_membership_account_id__user_id.9d4b4c8ce6
16:33:23.981858 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:33:23.982433 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
16:33:23.982658 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:33:23.982866 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:33:23.991083 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276"
16:33:23.991777 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.992013 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:33:23.992234 [debug] [Thread-1  ]: finished collecting timing info
16:33:23.992682 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__active_volume_active_volume_id__destination_id.d6532db276
16:33:23.992935 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector
16:33:23.993422 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
16:33:23.993643 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector
16:33:23.993868 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector
16:33:24.015990 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
16:33:24.016362 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */

    describe table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp
16:33:24.016581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:33:24.669945 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.65 seconds
16:33:24.687439 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector"
16:33:24.690853 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.691168 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector
16:33:24.691401 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.691673 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: Close
16:33:24.827150 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector
16:33:24.827543 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:33:24.828210 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
16:33:24.828617 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:33:24.828840 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:33:24.837016 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878"
16:33:24.837689 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.837920 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:33:24.838137 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.838572 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__credits_used_measured_month__destination_id.ad5114f878
16:33:24.838836 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:33:24.839387 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
16:33:24.839751 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:33:24.839977 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:33:24.845362 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed"
16:33:24.846012 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.846370 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:33:24.846667 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.847180 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__destination_destination_id.bf0be221ed
16:33:24.847442 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:33:24.848198 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
16:33:24.848443 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:33:24.848736 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:33:24.857094 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb"
16:33:24.858238 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.858497 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:33:24.858735 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.859334 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__destination_destination_id.f88b94a8cb
16:33:24.859785 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:33:24.860544 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
16:33:24.860819 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:33:24.861193 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:33:24.936210 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da"
16:33:24.936974 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.937370 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:33:24.937623 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.938090 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__destination_membership_destination_id__user_id.daa65572da
16:33:24.938353 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:33:24.939104 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
16:33:24.939329 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:33:24.939535 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:33:24.946888 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9"
16:33:24.947624 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.947867 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:33:24.948101 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.948554 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__log_log_id__created_at.b6392465d9
16:33:24.948817 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:33:24.949327 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
16:33:24.949565 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:33:24.949801 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:33:24.956340 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a"
16:33:24.957002 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.957230 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:33:24.957448 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.957882 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_stg_fivetran_log__user_user_id.cf0cc5540a
16:33:24.958137 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:33:24.958677 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
16:33:24.958892 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:33:24.959095 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:33:24.965046 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda"
16:33:24.965973 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.966357 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:33:24.966609 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.967157 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_stg_fivetran_log__user_user_id.25561a7dda
16:33:24.967468 [debug] [Thread-1  ]: Began running node model.workshop_live.my_second_dbt_model
16:33:24.968291 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.workshop_live.my_second_dbt_model"
16:33:24.968517 [debug] [Thread-1  ]: Began compiling node model.workshop_live.my_second_dbt_model
16:33:24.968784 [debug] [Thread-1  ]: Compiling model.workshop_live.my_second_dbt_model
16:33:24.972808 [debug] [Thread-1  ]: Writing injected SQL for node "model.workshop_live.my_second_dbt_model"
16:33:24.973444 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.973668 [debug] [Thread-1  ]: Began executing node model.workshop_live.my_second_dbt_model
16:33:24.973882 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.974326 [debug] [Thread-1  ]: Finished running node model.workshop_live.my_second_dbt_model
16:33:24.974585 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:33:24.974956 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
16:33:24.975162 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:33:24.975362 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:33:24.980957 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710"
16:33:24.981914 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.982165 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:33:24.982396 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.982856 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_first_dbt_model_id.5fb22c2710
16:33:24.983112 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:33:24.983497 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
16:33:24.983738 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:33:24.983952 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:33:24.991773 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_first_dbt_model_id.16e066b321"
16:33:24.992537 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.992799 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:33:24.993153 [debug] [Thread-1  ]: finished collecting timing info
16:33:24.993689 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_first_dbt_model_id.16e066b321
16:33:24.993941 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_status
16:33:24.994394 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_status"
16:33:24.994614 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_status
16:33:24.994823 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_status
16:33:25.018531 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_status"
16:33:25.019575 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.019908 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_status
16:33:25.020272 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.020816 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_status
16:33:25.021075 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__mar_table_history
16:33:25.021452 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
16:33:25.021663 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__mar_table_history
16:33:25.021871 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__mar_table_history
16:33:25.027649 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
16:33:25.028457 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.028686 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__mar_table_history
16:33:25.028901 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.029391 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__mar_table_history
16:33:25.029699 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:33:25.030278 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
16:33:25.030628 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:33:25.030872 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:33:25.039239 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8"
16:33:25.040285 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.040530 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:33:25.040755 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.041207 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_stg_fivetran_log__connector_connector_name__destination_id.c6898547d8
16:33:25.041462 [debug] [Thread-1  ]: Began running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:33:25.041956 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
16:33:25.042175 [debug] [Thread-1  ]: Began compiling node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:33:25.042380 [debug] [Thread-1  ]: Compiling test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:33:25.047897 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.not_null_my_second_dbt_model_id.151b76d778"
16:33:25.048542 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.048786 [debug] [Thread-1  ]: Began executing node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:33:25.049010 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.049468 [debug] [Thread-1  ]: Finished running node test.workshop_live.not_null_my_second_dbt_model_id.151b76d778
16:33:25.049731 [debug] [Thread-1  ]: Began running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:33:25.050332 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
16:33:25.050715 [debug] [Thread-1  ]: Began compiling node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:33:25.051030 [debug] [Thread-1  ]: Compiling test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:33:25.057198 [debug] [Thread-1  ]: Writing injected SQL for node "test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493"
16:33:25.057848 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.058077 [debug] [Thread-1  ]: Began executing node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:33:25.058300 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.058741 [debug] [Thread-1  ]: Finished running node test.workshop_live.unique_my_second_dbt_model_id.57a0f8c493
16:33:25.059027 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__audit_table
16:33:25.059742 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:33:25.060042 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__audit_table
16:33:25.060267 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__audit_table
16:33:25.085104 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:33:25.085416 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
select date(max(sync_start)) from angel.workshop_live_fivetran_log.fivetran_log__audit_table
16:33:25.085636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:33:25.747004 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.66 seconds
16:33:25.762855 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__audit_table"
16:33:25.763997 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.764318 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__audit_table
16:33:25.764637 [debug] [Thread-1  ]: finished collecting timing info
16:33:25.764886 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: Close
16:33:25.883855 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__audit_table
16:33:25.884287 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_daily_events
16:33:25.885013 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:33:25.885263 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_daily_events
16:33:25.885520 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_daily_events
16:33:25.903639 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:33:25.903910 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */

    
        select  min( signed_up ) as min_date from angel.fivetran_log.connector
16:33:25.904111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:33:26.552818 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
16:33:26.559332 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:33:26.559611 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


        select datediff(
        day,
        cast('2020-08-12' as date),
        

    dateadd(
        week,
        1,
        date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)
        )


        )
16:33:26.704861 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
16:33:26.709748 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
16:33:26.710387 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.710618 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_daily_events
16:33:26.710837 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.711056 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: Close
16:33:26.870610 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_daily_events
16:33:26.870993 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__schema_changelog
16:33:26.871497 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
16:33:26.871714 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__schema_changelog
16:33:26.871927 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__schema_changelog
16:33:26.881404 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
16:33:26.882215 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.882472 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__schema_changelog
16:33:26.882901 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.883504 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__schema_changelog
16:33:26.883772 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:33:26.884357 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
16:33:26.884725 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:33:26.884957 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:33:26.894313 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0"
16:33:26.895007 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.895236 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:33:26.895452 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.896060 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_status_connector_id__destination_id.a2135f04e0
16:33:26.896345 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:33:26.896734 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
16:33:26.896963 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:33:26.897275 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__credit_mar_destination_history
16:33:26.902268 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
16:33:26.903382 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.903619 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:33:26.903839 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.904275 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:33:26.904530 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:33:26.904900 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
16:33:26.905109 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:33:26.905313 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:33:26.913708 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac"
16:33:26.914365 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.914598 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:33:26.914818 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.915248 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__mar_table_history_connector_id__destination_id__table_name__measured_month.2e5ecfcbac
16:33:26.915508 [debug] [Thread-1  ]: Began running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:33:26.916194 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
16:33:26.916434 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:33:26.916666 [debug] [Thread-1  ]: Compiling test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:33:26.922692 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc"
16:33:26.923414 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.923652 [debug] [Thread-1  ]: Began executing node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:33:26.923870 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.924354 [debug] [Thread-1  ]: Finished running node test.fivetran_log.not_null_fivetran_log__audit_table_unique_table_sync_key.f6ba3bbedc
16:33:26.924633 [debug] [Thread-1  ]: Began running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:33:26.925111 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
16:33:26.925332 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:33:26.925538 [debug] [Thread-1  ]: Compiling test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:33:26.930734 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d"
16:33:26.931737 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.932042 [debug] [Thread-1  ]: Began executing node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:33:26.932277 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.932729 [debug] [Thread-1  ]: Finished running node test.fivetran_log.unique_fivetran_log__audit_table_unique_table_sync_key.3a60f8fc5d
16:33:26.932992 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:33:26.933505 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
16:33:26.933783 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:33:26.934011 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:33:26.941615 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f"
16:33:26.942248 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.942479 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:33:26.942694 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.943120 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__connector_daily_events_connector_id__destination_id__date_day.9d2d1bd07f
16:33:26.943371 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__message_data__created_at.542291325d
16:33:26.943879 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__message_data__created_at.542291325d"
16:33:26.944100 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__message_data__created_at.542291325d
16:33:26.944305 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__message_data__created_at.542291325d
16:33:26.952834 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__message_data__created_at.542291325d"
16:33:26.953517 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.953756 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__message_data__created_at.542291325d
16:33:26.953975 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.954408 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__schema_changelog_connector_id__destination_id__message_data__created_at.542291325d
16:33:26.954668 [debug] [Thread-1  ]: Began running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:33:26.955142 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
16:33:26.955366 [debug] [Thread-1  ]: Began compiling node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:33:26.955572 [debug] [Thread-1  ]: Compiling test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:33:26.964184 [debug] [Thread-1  ]: Writing injected SQL for node "test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2"
16:33:26.964928 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.965189 [debug] [Thread-1  ]: Began executing node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:33:26.965423 [debug] [Thread-1  ]: finished collecting timing info
16:33:26.965971 [debug] [Thread-1  ]: Finished running node test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2
16:33:26.966971 [debug] [MainThread]: Connection 'master' was properly closed.
16:33:26.967224 [debug] [MainThread]: Connection 'test.fivetran_log.dbt_utils_unique_combination_of_columns_fivetran_log__credit_mar_destination_history_destination_id__measured_month.f0f1bdaea2' was properly closed.
16:33:26.987217 [info ] [MainThread]: Done.
16:33:26.990327 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
16:33:26.990591 [info ] [MainThread]: Building catalog
16:33:26.996507 [debug] [ThreadPool]: Acquiring new snowflake connection "angel.information_schema"
16:33:27.009106 [debug] [ThreadPool]: Using snowflake connection "angel.information_schema"
16:33:27.009394 [debug] [ThreadPool]: On angel.information_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "angel.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from angel.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from angel.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('fivetran_log') or upper("table_schema") = upper('workshop_live') or upper("table_schema") = upper('workshop_live_fivetran_log') or upper("table_schema") = upper('workshop_live_stg_fivetran_log'))
      order by "column_index"
16:33:27.009619 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:33:52.516907 [debug] [ThreadPool]: SQL status: SUCCESS 227 in 25.51 seconds
16:33:53.063349 [debug] [ThreadPool]: On angel.information_schema: Close
16:33:53.264951 [info ] [MainThread]: Catalog written to /Users/angel.hernandez/Fivetran/dbt/workshop_live/target/catalog.json
16:33:53.266383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ad8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118486c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11849f6a0>]}
16:33:53.632349 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
16:33:53.632651 [debug] [MainThread]: Connection 'angel.information_schema' was properly closed.


============================== 2022-04-26 16:33:58.774395 | 3028d69f-03bb-483c-9e88-7e326915c0c0 ==============================
16:33:58.774395 [info ] [MainThread]: Running with dbt=1.0.1
16:33:58.775576 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
16:33:58.776321 [debug] [MainThread]: Tracking: tracking
16:33:58.776907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e354430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e354490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e354310>]}
16:33:58.781275 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
16:33:58.781939 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
16:33:58.782318 [info ] [MainThread]: 
16:33:58.782690 [info ] [MainThread]: 
16:33:58.783008 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-04-26 16:49:39.370140 | d7f4e071-36c3-4c89-99bf-15486f528b0f ==============================
16:49:39.370140 [info ] [MainThread]: Running with dbt=1.0.1
16:49:39.372070 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/angel.hernandez/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['fivetran_log'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
16:49:39.372684 [debug] [MainThread]: Tracking: tracking
16:49:39.373630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b406940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b406ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b406040>]}
16:49:39.588289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:49:39.588778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:49:39.619147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d2fee0>]}
16:49:39.667364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175c45e0>]}
16:49:39.668069 [info ] [MainThread]: Found 18 models, 23 tests, 0 snapshots, 0 analyses, 497 macros, 0 operations, 0 seed files, 11 sources, 0 exposures, 0 metrics
16:49:39.673520 [info ] [MainThread]: 
16:49:39.674690 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:49:39.678458 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel"
16:49:39.712216 [debug] [ThreadPool]: Using snowflake connection "list_angel"
16:49:39.712806 [debug] [ThreadPool]: On list_angel: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel"} */

    show terse schemas in database angel
    limit 10000
16:49:39.713461 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:49:40.853263 [debug] [ThreadPool]: SQL status: SUCCESS 123 in 1.14 seconds
16:49:40.861375 [debug] [ThreadPool]: On list_angel: Close
16:49:40.962793 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel"
16:49:40.966358 [debug] [ThreadPool]: Using snowflake connection "list_angel"
16:49:40.966620 [debug] [ThreadPool]: On list_angel: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel"} */

    show terse schemas in database angel
    limit 10000
16:49:40.966842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:49:41.597136 [debug] [ThreadPool]: SQL status: SUCCESS 123 in 0.63 seconds
16:49:41.603856 [debug] [ThreadPool]: On list_angel: Close
16:49:41.912911 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live"
16:49:41.927535 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live"
16:49:41.927950 [debug] [ThreadPool]: On list_angel_workshop_live: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live"} */

    show terse objects in angel.workshop_live
16:49:41.928176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:49:42.529580 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.6 seconds
16:49:42.531712 [debug] [ThreadPool]: On list_angel_workshop_live: Close
16:49:42.941440 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_stg_fivetran_log"
16:49:42.945060 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_stg_fivetran_log"
16:49:42.945314 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_stg_fivetran_log"} */

    show terse objects in angel.workshop_live_stg_fivetran_log
16:49:42.945519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:49:43.628991 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.68 seconds
16:49:43.631106 [debug] [ThreadPool]: On list_angel_workshop_live_stg_fivetran_log: Close
16:49:43.736885 [debug] [ThreadPool]: Acquiring new snowflake connection "list_angel_workshop_live_fivetran_log"
16:49:43.742045 [debug] [ThreadPool]: Using snowflake connection "list_angel_workshop_live_fivetran_log"
16:49:43.742334 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "connection_name": "list_angel_workshop_live_fivetran_log"} */

    show terse objects in angel.workshop_live_fivetran_log
16:49:43.742539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:49:44.369692 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.63 seconds
16:49:44.371771 [debug] [ThreadPool]: On list_angel_workshop_live_fivetran_log: Close
16:49:44.493119 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:49:44.493595 [info ] [MainThread]: 
16:49:44.498281 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account
16:49:44.499146 [info ] [Thread-1  ]: 1 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__account [RUN]
16:49:44.499798 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account"
16:49:44.500029 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account
16:49:44.500265 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account
16:49:44.511992 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account"
16:49:44.512927 [debug] [Thread-1  ]: finished collecting timing info
16:49:44.513193 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account
16:49:44.574684 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__account"
16:49:44.577888 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__account"
16:49:44.578161 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__account"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__account  as
      (with account as (
    
    select * from angel.fivetran_log.account

),

fields as (

    select
        id as account_id,
        country,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        name as account_name,
        status
        
    from account

)

select * from fields
      );
16:49:44.578375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:46.630611 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.05 seconds
16:49:46.647083 [debug] [Thread-1  ]: finished collecting timing info
16:49:46.647395 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account: Close
16:49:46.779809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e92a30>]}
16:49:46.780364 [info ] [Thread-1  ]: 1 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__account [[32mSUCCESS 1[0m in 2.28s]
16:49:46.780925 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account
16:49:46.781194 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__account_membership
16:49:46.781638 [info ] [Thread-1  ]: 2 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership [RUN]
16:49:46.782506 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
16:49:46.782821 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__account_membership
16:49:46.783173 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__account_membership
16:49:46.791986 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
16:49:46.792704 [debug] [Thread-1  ]: finished collecting timing info
16:49:46.792954 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__account_membership
16:49:46.796658 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__account_membership"
16:49:46.798757 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__account_membership"
16:49:46.798993 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account_membership: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__account_membership"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership  as
      (with account_membership as (
    
    select * from angel.fivetran_log.account_membership

),

fields as (

    select
        account_id,
        user_id,
        cast(activated_at as 
    timestamp_ntz
) as activated_at,
        cast(joined_at as 
    timestamp_ntz
) as joined_at,
        role as account_role
        
    from account_membership
    
)

select * from fields
      );
16:49:46.799199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:48.256063 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.46 seconds
16:49:48.258246 [debug] [Thread-1  ]: finished collecting timing info
16:49:48.258549 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__account_membership: Close
16:49:48.363442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180eb610>]}
16:49:48.363953 [info ] [Thread-1  ]: 2 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__account_membership [[32mSUCCESS 1[0m in 1.58s]
16:49:48.364394 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__account_membership
16:49:48.364645 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__active_volume
16:49:48.364936 [info ] [Thread-1  ]: 3 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume [RUN]
16:49:48.365737 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
16:49:48.365968 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__active_volume
16:49:48.366190 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__active_volume
16:49:48.372780 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
16:49:48.373417 [debug] [Thread-1  ]: finished collecting timing info
16:49:48.373666 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__active_volume
16:49:48.377608 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__active_volume"
16:49:48.379345 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__active_volume"
16:49:48.379589 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__active_volume: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__active_volume"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume  as
      (with active_volume as (

    select * from angel.fivetran_log.active_volume

),

fields as (

    select
        id as active_volume_id,
        connector_id as connector_name, -- Note: this misnomer will be changed by Fivetran soon
        destination_id,
        cast(measured_at as 
    timestamp_ntz
) as measured_at,
        monthly_active_rows,
        schema_name,
        table_name
    
    from active_volume
)

select * from fields
      );
16:49:48.379796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:49.583257 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.2 seconds
16:49:49.586964 [debug] [Thread-1  ]: finished collecting timing info
16:49:49.587548 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__active_volume: Close
16:49:49.725062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11812d610>]}
16:49:49.726768 [info ] [Thread-1  ]: 3 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume [[32mSUCCESS 1[0m in 1.36s]
16:49:49.727384 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__active_volume
16:49:49.728394 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector_tmp
16:49:49.728916 [info ] [Thread-1  ]: 4 of 16 START view model workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp [RUN]
16:49:49.729653 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
16:49:49.730016 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector_tmp
16:49:49.730385 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector_tmp
16:49:49.736061 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
16:49:49.736881 [debug] [Thread-1  ]: finished collecting timing info
16:49:49.737200 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector_tmp
16:49:49.767359 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__connector_tmp"
16:49:49.768922 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector_tmp"
16:49:49.769165 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector_tmp: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector_tmp"} */

  create or replace  view angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp 
  
   as (
    select *
from angel.fivetran_log.connector
  );
16:49:49.769384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:50.442303 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.67 seconds
16:49:50.444369 [debug] [Thread-1  ]: finished collecting timing info
16:49:50.444653 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector_tmp: Close
16:49:50.592612 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11812de20>]}
16:49:50.593107 [info ] [Thread-1  ]: 4 of 16 OK created view model workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp [[32mSUCCESS 1[0m in 0.86s]
16:49:50.593590 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector_tmp
16:49:50.593893 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__credits_used
16:49:50.594360 [info ] [Thread-1  ]: 5 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used [RUN]
16:49:50.595083 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
16:49:50.595308 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__credits_used
16:49:50.595540 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__credits_used
16:49:50.600532 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
16:49:50.601181 [debug] [Thread-1  ]: finished collecting timing info
16:49:50.601420 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__credits_used
16:49:50.605353 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__credits_used"
16:49:50.607199 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__credits_used"
16:49:50.607461 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__credits_used: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__credits_used"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used  as
      (with  credits_used as (

    select * from angel.fivetran_log.credits_used

),

fields as (
    
    select 
        destination_id,
        measured_month,
        credits_consumed
    
    from credits_used
)

select * from fields
      );
16:49:50.607674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:51.507021 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.9 seconds
16:49:51.509407 [debug] [Thread-1  ]: finished collecting timing info
16:49:51.509761 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__credits_used: Close
16:49:51.613634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11815ddf0>]}
16:49:51.614137 [info ] [Thread-1  ]: 5 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used [[32mSUCCESS 1[0m in 1.02s]
16:49:51.614617 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__credits_used
16:49:51.614879 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination
16:49:51.615397 [info ] [Thread-1  ]: 6 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination [RUN]
16:49:51.616045 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
16:49:51.616273 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination
16:49:51.616510 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination
16:49:51.683071 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination"
16:49:51.684147 [debug] [Thread-1  ]: finished collecting timing info
16:49:51.684531 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination
16:49:51.691584 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__destination"
16:49:51.693958 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__destination"
16:49:51.694305 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__destination"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination  as
      (with destination as (

    select * from angel.fivetran_log.destination

),

fields as (

    select
        id as destination_id,
        account_id,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        name as destination_name,
        region
    
    from destination
)

select * from fields
      );
16:49:51.694545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:53.209016 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.51 seconds
16:49:53.211736 [debug] [Thread-1  ]: finished collecting timing info
16:49:53.212009 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination: Close
16:49:53.328637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181596d0>]}
16:49:53.329152 [info ] [Thread-1  ]: 6 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination [[32mSUCCESS 1[0m in 1.71s]
16:49:53.329625 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination
16:49:53.329882 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__destination_membership
16:49:53.330175 [info ] [Thread-1  ]: 7 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership [RUN]
16:49:53.330761 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
16:49:53.331074 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__destination_membership
16:49:53.331329 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__destination_membership
16:49:53.338365 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
16:49:53.339236 [debug] [Thread-1  ]: finished collecting timing info
16:49:53.339495 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__destination_membership
16:49:53.343283 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__destination_membership"
16:49:53.345092 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__destination_membership"
16:49:53.345335 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination_membership: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__destination_membership"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership  as
      (with destination_membership as (
    
    select * from angel.fivetran_log.destination_membership

),

fields as (

    select
        destination_id,
        user_id,
        cast(activated_at as 
    timestamp_ntz
) as activated_at,
        cast(joined_at as 
    timestamp_ntz
) as joined_at,
        role as destination_role
        
    from destination_membership
)

select * from fields
      );
16:49:53.345545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:54.717773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.37 seconds
16:49:54.720270 [debug] [Thread-1  ]: finished collecting timing info
16:49:54.720647 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__destination_membership: Close
16:49:54.842603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118096bb0>]}
16:49:54.843304 [info ] [Thread-1  ]: 7 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__destination_membership [[32mSUCCESS 1[0m in 1.51s]
16:49:54.843959 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__destination_membership
16:49:54.844315 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__log
16:49:54.844627 [info ] [Thread-1  ]: 8 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__log.. [RUN]
16:49:54.845388 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__log"
16:49:54.845617 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__log
16:49:54.845836 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__log
16:49:54.851511 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__log"
16:49:54.852142 [debug] [Thread-1  ]: finished collecting timing info
16:49:54.852377 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__log
16:49:54.856088 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__log"
16:49:54.858223 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__log"
16:49:54.858478 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__log: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__log"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log  as
      (with log as (

    select * from angel.fivetran_log.log
    
),

fields as (

    select
        id as log_id, 
        cast(time_stamp as 
    timestamp_ntz
) as created_at,
        connector_id, -- Note: the connector_id column used to erroneously equal the connector_name, NOT its id.
        case when transformation_id is not null and event is null then 'TRANSFORMATION'
        else event end as event_type, 
        message_data,
        case 
        when transformation_id is not null and message_data like '%has succeeded%' then 'transformation run success'
        when transformation_id is not null and message_data like '%has failed%' then 'transformation run failed'
        else message_event end as event_subtype,
        transformation_id

    from log
)

select * from fields
      );
16:49:54.858690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:57.022692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.16 seconds
16:49:57.025655 [debug] [Thread-1  ]: finished collecting timing info
16:49:57.026100 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__log: Close
16:49:57.244914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11801dbe0>]}
16:49:57.245451 [info ] [Thread-1  ]: 8 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__log [[32mSUCCESS 1[0m in 2.40s]
16:49:57.245904 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__log
16:49:57.246162 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__user
16:49:57.246577 [info ] [Thread-1  ]: 9 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__user. [RUN]
16:49:57.247147 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__user"
16:49:57.247377 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__user
16:49:57.247594 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__user
16:49:57.253664 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__user"
16:49:57.254451 [debug] [Thread-1  ]: finished collecting timing info
16:49:57.254707 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__user
16:49:57.259048 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__user"
16:49:57.260804 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__user"
16:49:57.261034 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__user: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__user"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__user  as
      (with fivetran_user as (

    select * from angel.fivetran_log.user

),

fields as (

    select
        id as user_id,
        cast(created_at as 
    timestamp_ntz
) as created_at,
        email,
        email_disabled as has_disabled_email_notifications,
        family_name as last_name,
        given_name as first_name,
        phone,
        verified as is_verified
        
    from fivetran_user

)

select * from fields
      );
16:49:57.261240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:58.551586 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.29 seconds
16:49:58.553661 [debug] [Thread-1  ]: finished collecting timing info
16:49:58.553937 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__user: Close
16:49:58.724134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b17ea60>]}
16:49:58.725373 [info ] [Thread-1  ]: 9 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__user [[32mSUCCESS 1[0m in 1.48s]
16:49:58.726000 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__user
16:49:58.726295 [debug] [Thread-1  ]: Began running node model.fivetran_log.stg_fivetran_log__connector
16:49:58.726612 [info ] [Thread-1  ]: 10 of 16 START table model workshop_live_stg_fivetran_log.stg_fivetran_log__connector [RUN]
16:49:58.727234 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
16:49:58.727695 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.stg_fivetran_log__connector
16:49:58.727964 [debug] [Thread-1  ]: Compiling model.fivetran_log.stg_fivetran_log__connector
16:49:58.747038 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
16:49:58.747331 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */

    describe table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp
16:49:58.747547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:49:59.464105 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.72 seconds
16:49:59.503774 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.stg_fivetran_log__connector"
16:49:59.504459 [debug] [Thread-1  ]: finished collecting timing info
16:49:59.504841 [debug] [Thread-1  ]: Began executing node model.fivetran_log.stg_fivetran_log__connector
16:49:59.509035 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.stg_fivetran_log__connector"
16:49:59.512839 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.stg_fivetran_log__connector"
16:49:59.513122 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.stg_fivetran_log__connector"} */


      create or replace transient table angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector  as
      (with connector as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector_tmp

),

fields as (
    select
        
    
    
    _fivetran_deleted
    
 as 
    
    _fivetran_deleted
    
, 
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    connecting_user_id
    
 as 
    
    connecting_user_id
    
, 
    
    
    connector_id
    
 as 
    
    connector_id
    
, 
    
    
    connector_name
    
 as 
    
    connector_name
    
, 
    
    
    connector_type
    
 as 
    
    connector_type
    
, 
    
    
    connector_type_id
    
 as 
    
    connector_type_id
    
, 
    
    
    destination_id
    
 as 
    
    destination_id
    
, 
    
    
    paused
    
 as 
    
    paused
    
, 
    cast(null as 
    int
) as 
    
    service_version
    
 , 
    
    
    signed_up
    
 as 
    
    signed_up
    



        ,row_number() over ( partition by connector_name, destination_id order by _fivetran_synced desc ) as nth_last_record
    from connector

),

final as (

    select 
        connector_id,
        connector_name,
        coalesce(connector_type_id, connector_type) as connector_type,
        destination_id,
        connecting_user_id,
        paused as is_paused,
        signed_up as set_up_at

    from fields

    -- Only look at the most recent one
    where nth_last_record = 1
)

select * 
from final
      );
16:50:00.547082 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.03 seconds
16:50:00.549063 [debug] [Thread-1  ]: finished collecting timing info
16:50:00.549318 [debug] [Thread-1  ]: On model.fivetran_log.stg_fivetran_log__connector: Close
16:50:00.656402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e92a90>]}
16:50:00.656924 [info ] [Thread-1  ]: 10 of 16 OK created table model workshop_live_stg_fivetran_log.stg_fivetran_log__connector [[32mSUCCESS 1[0m in 1.93s]
16:50:00.657479 [debug] [Thread-1  ]: Finished running node model.fivetran_log.stg_fivetran_log__connector
16:50:00.658265 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_status
16:50:00.658595 [info ] [Thread-1  ]: 11 of 16 START table model workshop_live_fivetran_log.fivetran_log__connector_status [RUN]
16:50:00.659175 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_status"
16:50:00.659388 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_status
16:50:00.659600 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_status
16:50:00.702323 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_status"
16:50:00.703131 [debug] [Thread-1  ]: finished collecting timing info
16:50:00.703502 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_status
16:50:00.707329 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__connector_status"
16:50:00.720960 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_status"
16:50:00.721388 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_status: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_status"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__connector_status  as
      (with transformation_removal as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log
    where transformation_id is null

),

connector_log as (
    select 
        *,
        sum( case when event_subtype in ('sync_start') then 1 else 0 end) over ( partition by connector_id 
            order by created_at rows unbounded preceding) as sync_batch_id
    from transformation_removal
    -- only looking at errors, warnings, and syncs here
    where event_type = 'SEVERE'
        or event_type = 'WARNING'
        or event_subtype like 'sync%'
        or (event_subtype = 'status' 
            and 

  parse_json( message_data )['status'] = 'RESCHEDULED'
            
            and 

  parse_json( message_data )['reason'] like '%intended behavior%'
            ) -- for priority-first syncs. these should be captured by event_type = 'WARNING' but let's make sure
        or (event_subtype = 'status' 
            and 

  parse_json( message_data )['status'] = 'SUCCESSFUL'
        )
        -- whole reason is "We have rescheduled the connector to force flush data from the forward sync into your destination. This is intended behavior and means that the connector is working as expected."
),

schema_changes as (

    select
        connector_id,
        count(*) as number_of_schema_changes_last_month

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where 
        datediff(
        day,
        created_at,
        
    current_timestamp::
    timestamp_ntz


        ) <= 30
        and event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config')

    group by 1

),

connector as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector

),

destination as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination
),

connector_metrics as (

    select
        connector.connector_id,
        connector.connector_name,
        connector.connector_type,
        connector.destination_id,
        connector.is_paused,
        connector.set_up_at,
        max(case when connector_log.event_subtype = 'sync_start' then connector_log.created_at else null end) as last_sync_started_at,

        max(case when connector_log.event_subtype = 'sync_end' 
            then connector_log.created_at else null end) as last_sync_completed_at,

        max(case when connector_log.event_subtype in ('status', 'sync_end')
                and 

  parse_json( connector_log.message_data )['status'] ='SUCCESSFUL'
            then connector_log.created_at else null end) as last_successful_sync_completed_at,


        max(case when connector_log.event_subtype = 'sync_end' 
            then connector_log.sync_batch_id else null end) as last_sync_batch_id,

        max(case when connector_log.event_subtype in ('status', 'sync_end')
                and 

  parse_json( connector_log.message_data )['status'] ='RESCHEDULED'
                and 

  parse_json( connector_log.message_data )['reason'] like '%intended behavior%'
            then connector_log.created_at else null end) as last_priority_first_sync_completed_at,
                

        max(case when connector_log.event_type = 'SEVERE' then connector_log.created_at else null end) as last_error_at,

        max(case when connector_log.event_type = 'SEVERE' then connector_log.sync_batch_id else null end) as last_error_batch,
        max(case when event_type = 'WARNING' then connector_log.created_at else null end) as last_warning_at

    from connector 
    left join connector_log 
        on connector_log.connector_id = connector.connector_id
    group by 1,2,3,4,5,6

),

connector_health as (

    select
        *,
        case 
            -- connector is paused
            when is_paused then 'paused'

            -- a sync has never been attempted
            when last_sync_started_at is null then 'incomplete'

            -- a priority-first sync has occurred, but a normal sync has not
            when last_priority_first_sync_completed_at is not null and last_sync_completed_at is null then 'priority first sync'

            -- a priority sync has occurred more recently than a normal one (may occurr if the connector has been paused and resumed)
            when last_priority_first_sync_completed_at > last_sync_completed_at then 'priority first sync'

            -- a sync has been attempted, but not completed, and it's not due to errors. also a priority-first sync hasn't
            when last_sync_completed_at is null and last_error_at is null then 'initial sync in progress'

            -- the last attempted sync had an error
            when last_sync_batch_id = last_error_batch then 'broken'

            -- there's never been a successful sync and there have been errors
            when last_sync_completed_at is null and last_error_at is not null then 'broken'

        else 'connected' end as connector_health

    from connector_metrics
),

-- Joining with log to grab pertinent error/warning messagees
connector_recent_logs as (

    select 
        connector_health.connector_id,
        connector_health.connector_name,
        connector_health.connector_type,
        connector_health.destination_id,
        connector_health.connector_health,
        connector_health.last_successful_sync_completed_at,
        connector_health.last_sync_started_at,
        connector_health.last_sync_completed_at,
        connector_health.set_up_at,
        connector_log.event_subtype,
        connector_log.event_type,
        connector_log.message_data

    from connector_health 
    left join connector_log 
        on connector_log.connector_id = connector_health.connector_id
        -- limiting relevance to since the last successful sync completion (if there has been one)
        and connector_log.created_at > coalesce(connector_health.last_sync_completed_at, connector_health.last_priority_first_sync_completed_at, '2000-01-01') 
        -- only looking at errors and warnings (excluding syncs - both normal and priority first)
        and connector_log.event_type != 'INFO' 
        -- need to explicitly avoid priority first statuses because they are of event_type WARNING
        and not (connector_log.event_subtype = 'status' 
            and 

  parse_json( connector_log.message_data )['status'] ='RESCHEDULED'
            and 

  parse_json( connector_log.message_data )['reason'] like '%intended behavior%')

    group by 1,2,3,4,5,6,7,8,9,10,11,12 -- de-duping error messages
    

),

final as (

    select
        connector_recent_logs.connector_id,
        connector_recent_logs.connector_name,
        connector_recent_logs.connector_type,
        connector_recent_logs.destination_id,
        destination.destination_name,
        connector_recent_logs.connector_health,
        connector_recent_logs.last_successful_sync_completed_at,
        connector_recent_logs.last_sync_started_at,
        connector_recent_logs.last_sync_completed_at,
        connector_recent_logs.set_up_at,
        coalesce(schema_changes.number_of_schema_changes_last_month, 0) as number_of_schema_changes_last_month
        
        
        , 
    listagg(distinct case when connector_recent_logs.event_type = 'SEVERE' then connector_recent_logs.message_data else null end, '\n')

 as errors_since_last_completed_sync
        , 
    listagg(distinct case when connector_recent_logs.event_type = 'WARNING' then connector_recent_logs.message_data else null end, '\n')

 as warnings_since_last_completed_sync
        

    from connector_recent_logs
    left join schema_changes 
        on connector_recent_logs.connector_id = schema_changes.connector_id 

    join destination on destination.destination_id = connector_recent_logs.destination_id
    group by 1,2,3,4,5,6,7,8,9,10,11
)

select * from final
      );
16:50:00.721671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:50:03.080383 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.36 seconds
16:50:03.082453 [debug] [Thread-1  ]: finished collecting timing info
16:50:03.082717 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_status: Close
16:50:03.194770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180ab070>]}
16:50:03.195305 [info ] [Thread-1  ]: 11 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__connector_status [[32mSUCCESS 1[0m in 2.54s]
16:50:03.195770 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_status
16:50:03.196028 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__mar_table_history
16:50:03.196665 [info ] [Thread-1  ]: 12 of 16 START table model workshop_live_fivetran_log.fivetran_log__mar_table_history [RUN]
16:50:03.197351 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
16:50:03.197575 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__mar_table_history
16:50:03.197792 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__mar_table_history
16:50:03.208750 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
16:50:03.209397 [debug] [Thread-1  ]: finished collecting timing info
16:50:03.209632 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__mar_table_history
16:50:03.213127 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__mar_table_history"
16:50:03.216897 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__mar_table_history"
16:50:03.217137 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__mar_table_history: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__mar_table_history"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__mar_table_history  as
      (with active_volume as (

    select 
        *, 
        date_trunc('month', measured_at) as measured_month

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__active_volume 

    where schema_name != 'fivetran_log' -- it's free! 

),

connector as (

    select * 
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__connector
),

destination as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__destination
),

ordered_mar as (

    select
        connector_name,
        schema_name,
        table_name,
        destination_id,
        measured_at,
        measured_month,
        monthly_active_rows,

        -- each measurement is cumulative for the month, so we'll only look at the latest date for each month
        row_number() over(partition by table_name, connector_name, destination_id, measured_month order by measured_at desc) as n

    from active_volume

),

latest_mar as (
    select 
        connector_name,
        schema_name,
        table_name,
        destination_id,
        measured_month,
        date(measured_at) as last_measured_at,
        monthly_active_rows
      
    from ordered_mar
    where n = 1

),

mar_join as (

    select 
        latest_mar.*,
        connector.connector_type,
        connector.connector_id,
        destination.destination_name

    from latest_mar
    join connector 
        on latest_mar.connector_name = connector.connector_name
        and latest_mar.destination_id = connector.destination_id
    join destination on latest_mar.destination_id = destination.destination_id
)

select * from mar_join
order by measured_month desc, destination_id, connector_name
      );
16:50:03.217352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:50:04.704224 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.49 seconds
16:50:04.707366 [debug] [Thread-1  ]: finished collecting timing info
16:50:04.707668 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__mar_table_history: Close
16:50:04.845266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180ffdc0>]}
16:50:04.845770 [info ] [Thread-1  ]: 12 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__mar_table_history [[32mSUCCESS 1[0m in 1.65s]
16:50:04.846207 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__mar_table_history
16:50:04.846456 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__audit_table
16:50:04.846987 [info ] [Thread-1  ]: 13 of 16 START incremental model workshop_live_fivetran_log.fivetran_log__audit_table [RUN]
16:50:04.847641 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:04.847860 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__audit_table
16:50:04.848075 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__audit_table
16:50:04.871693 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:04.872125 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
select date(max(sync_start)) from angel.workshop_live_fivetran_log.fivetran_log__audit_table
16:50:04.872647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:50:05.396646 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.52 seconds
16:50:05.430581 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__audit_table"
16:50:05.431279 [debug] [Thread-1  ]: finished collecting timing info
16:50:05.431520 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__audit_table
16:50:05.474796 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:05.475127 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    

      create or replace temporary table angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp  as
      (

with sync_log as (
    
    select 
        *,
        

  parse_json( message_data )['table'] as table_name

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('sync_start', 'sync_end', 'write_to_table_start', 'write_to_table_end', 'records_modified')

    

    -- Capture the latest timestamp in a call statement instead of a subquery for optimizing BQ costs on incremental runs-- load the result from the above query into a new variable-- the query_result is stored as a dataframe. Therefore, we want to now store it as a singular value.-- compare the new batch of data to the latest sync already stored in this model
        and date(created_at) >= '2022-04-18'

    
),


connector as (

    select *
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status

),

add_connector_info as (

    select 
        sync_log.*,
        connector.connector_name,
        connector.destination_id,
        connector.destination_name

    from sync_log join connector using(connector_id)
),

sync_timestamps as (

    select
        connector_id,
        connector_name,
        table_name,
        event_subtype,
        destination_id,
        destination_name,

        created_at as write_to_table_start,
        
        min(case when event_subtype = 'write_to_table_end' then created_at else null end) 
            over (partition by connector_id, table_name order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as write_to_table_end,

        max(case when event_subtype = 'sync_start' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between UNBOUNDED PRECEDING and CURRENT ROW) as sync_start,

        min(case when event_subtype = 'sync_end' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as sync_end, -- coalesce with next_sync_start

        min(case when event_subtype = 'sync_start' then created_at else null end) 
            over (partition by connector_id order by created_at ROWS between CURRENT ROW AND UNBOUNDED FOLLOWING) as next_sync_start

    from add_connector_info

),

-- this will be the base for every record in the final CTE
limit_to_table_starts as (

    select *

    from sync_timestamps 
    where event_subtype = 'write_to_table_start'

),

records_modified_log as (

    select 
        connector_id,
        created_at,
        

  parse_json( message_data )['table'] as table_name,
        

  parse_json( message_data )['schema'] as schema_name,
        

  parse_json( message_data )['operationType'] as operation_type,
        cast (

  parse_json( message_data )['count'] as 
    int
) as row_count

    from sync_log 
    where event_subtype = 'records_modified'

),

sum_records_modified as (

    select
        limit_to_table_starts.connector_id,
        limit_to_table_starts.connector_name,
        limit_to_table_starts.table_name,
        limit_to_table_starts.destination_id,
        limit_to_table_starts.destination_name,
        limit_to_table_starts.write_to_table_start,
        limit_to_table_starts.write_to_table_end,
        limit_to_table_starts.sync_start,
        case when limit_to_table_starts.sync_end > limit_to_table_starts.next_sync_start then null else limit_to_table_starts.sync_end end as sync_end,

        sum(case when records_modified_log.operation_type = 'REPLACED_OR_INSERTED' then records_modified_log.row_count else 0 end) as sum_rows_replaced_or_inserted,
        sum(case when records_modified_log.operation_type = 'UPDATED' then records_modified_log.row_count else 0 end) as sum_rows_updated,
        sum(case when records_modified_log.operation_type = 'DELETED' then records_modified_log.row_count else 0 end) as sum_rows_deleted

    from limit_to_table_starts

    left join records_modified_log on 
        limit_to_table_starts.connector_id = records_modified_log.connector_id
        and limit_to_table_starts.table_name = records_modified_log.table_name
        -- confine it to one sync
        and records_modified_log.created_at > limit_to_table_starts.sync_start 
        and records_modified_log.created_at < coalesce(limit_to_table_starts.sync_end, limit_to_table_starts.next_sync_start) 

    group by 1,2,3,4,5,6,7,8,9

),

surrogate_key as (

    select 
        *,
        md5(cast(coalesce(cast(connector_id as 
    varchar
), '') || '-' || coalesce(cast(destination_id as 
    varchar
), '') || '-' || coalesce(cast(table_name as 
    varchar
), '') || '-' || coalesce(cast(write_to_table_start as 
    varchar
), '') as 
    varchar
)) as unique_table_sync_key

    from sum_records_modified
)

select *
from surrogate_key
      );
16:50:07.134514 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.66 seconds
16:50:07.142454 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:07.142991 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp
16:50:07.287914 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.14 seconds
16:50:07.303857 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:07.306599 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table angel.workshop_live_fivetran_log.fivetran_log__audit_table
16:50:07.408295 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.1 seconds
16:50:07.447371 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:07.447865 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */

    describe table "ANGEL"."WORKSHOP_LIVE_FIVETRAN_LOG"."FIVETRAN_LOG__AUDIT_TABLE"
16:50:07.556935 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.11 seconds
16:50:07.621362 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__audit_table"
16:50:07.625438 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:07.625731 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__audit_table"} */
begin;
16:50:07.733665 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
16:50:07.734111 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:07.734471 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: merge into angel.workshop_live_fivetran_log.fivetran_log__audit_table as DBT_INTERNAL_DEST
        using angel.workshop_live_fivetran_log.fivetran_log__audit_table__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.unique_table_sync_key = DBT_INTERNAL_DEST.unique_table_sync_key
        

    
    when matched then update set
        "CONNECTOR_ID" = DBT_INTERNAL_SOURCE."CONNECTOR_ID","CONNECTOR_NAME" = DBT_INTERNAL_SOURCE."CONNECTOR_NAME","TABLE_NAME" = DBT_INTERNAL_SOURCE."TABLE_NAME","DESTINATION_ID" = DBT_INTERNAL_SOURCE."DESTINATION_ID","DESTINATION_NAME" = DBT_INTERNAL_SOURCE."DESTINATION_NAME","WRITE_TO_TABLE_START" = DBT_INTERNAL_SOURCE."WRITE_TO_TABLE_START","WRITE_TO_TABLE_END" = DBT_INTERNAL_SOURCE."WRITE_TO_TABLE_END","SYNC_START" = DBT_INTERNAL_SOURCE."SYNC_START","SYNC_END" = DBT_INTERNAL_SOURCE."SYNC_END","SUM_ROWS_REPLACED_OR_INSERTED" = DBT_INTERNAL_SOURCE."SUM_ROWS_REPLACED_OR_INSERTED","SUM_ROWS_UPDATED" = DBT_INTERNAL_SOURCE."SUM_ROWS_UPDATED","SUM_ROWS_DELETED" = DBT_INTERNAL_SOURCE."SUM_ROWS_DELETED","UNIQUE_TABLE_SYNC_KEY" = DBT_INTERNAL_SOURCE."UNIQUE_TABLE_SYNC_KEY"
    

    when not matched then insert
        ("CONNECTOR_ID", "CONNECTOR_NAME", "TABLE_NAME", "DESTINATION_ID", "DESTINATION_NAME", "WRITE_TO_TABLE_START", "WRITE_TO_TABLE_END", "SYNC_START", "SYNC_END", "SUM_ROWS_REPLACED_OR_INSERTED", "SUM_ROWS_UPDATED", "SUM_ROWS_DELETED", "UNIQUE_TABLE_SYNC_KEY")
    values
        ("CONNECTOR_ID", "CONNECTOR_NAME", "TABLE_NAME", "DESTINATION_ID", "DESTINATION_NAME", "WRITE_TO_TABLE_START", "WRITE_TO_TABLE_END", "SYNC_START", "SYNC_END", "SUM_ROWS_REPLACED_OR_INSERTED", "SUM_ROWS_UPDATED", "SUM_ROWS_DELETED", "UNIQUE_TABLE_SYNC_KEY")

;
16:50:09.141738 [debug] [Thread-1  ]: SQL status: SUCCESS 7914 in 1.41 seconds
16:50:09.142110 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__audit_table"
16:50:09.142352 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: commit;
16:50:09.489524 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.35 seconds
16:50:09.491685 [debug] [Thread-1  ]: finished collecting timing info
16:50:09.491960 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__audit_table: Close
16:50:09.672691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181287c0>]}
16:50:09.673226 [info ] [Thread-1  ]: 13 of 16 OK created incremental model workshop_live_fivetran_log.fivetran_log__audit_table [[32mSUCCESS 1[0m in 4.83s]
16:50:09.673669 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__audit_table
16:50:09.673944 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__connector_daily_events
16:50:09.674395 [info ] [Thread-1  ]: 14 of 16 START table model workshop_live_fivetran_log.fivetran_log__connector_daily_events [RUN]
16:50:09.674985 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:50:09.675207 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__connector_daily_events
16:50:09.675419 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__connector_daily_events
16:50:09.691009 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:50:09.691288 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */

    
        select  min( signed_up ) as min_date from angel.fivetran_log.connector
16:50:09.691490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:50:10.575990 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.88 seconds
16:50:10.600615 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:50:10.600912 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


        select datediff(
        day,
        cast('2020-08-12' as date),
        

    dateadd(
        week,
        1,
        date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)
        )


        )
16:50:10.749213 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
16:50:10.768401 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
16:50:10.769154 [debug] [Thread-1  ]: finished collecting timing info
16:50:10.769451 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__connector_daily_events
16:50:10.774933 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__connector_daily_events"
16:50:10.785954 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__connector_daily_events"
16:50:10.786271 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__connector_daily_events"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__connector_daily_events  as
      (-- depends_on: angel.fivetran_log.connector

with connector as (
    
    select * 
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status
),

-- grab api calls, schema changes, and record modifications
log_events as (

    select 
        connector_id,
        cast( date_trunc('day', created_at) as date) as date_day,
        case 
            when event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config') then 'schema_change' 
            else event_subtype end as event_subtype,

        sum(case when event_subtype = 'records_modified' then cast( 

  parse_json( message_data )['count'] as 
    int
 )
        else 1 end) as count_events 

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('api_call', 
                            'records_modified', 
                            'create_table', 'alter_table', 'create_schema', 'change_schema_config') -- all schema changes
                            
        and connector_id is not null

    group by 1,2,3
),

pivot_out_events as (

    select
        connector_id,
        date_day,
        max(case when event_subtype = 'api_call' then count_events else 0 end) as count_api_calls,
        max(case when event_subtype = 'records_modified' then count_events else 0 end) as count_record_modifications,
        max(case when event_subtype = 'schema_change' then count_events else 0 end) as count_schema_changes

    from log_events
    group by 1,2
),

connector_event_counts as (

    select
        pivot_out_events.date_day,
        pivot_out_events.count_api_calls,
        pivot_out_events.count_record_modifications,
        pivot_out_events.count_schema_changes,
        connector.connector_name,
        connector.connector_id,
        connector.connector_type,
        connector.destination_name,
        connector.destination_id,
        connector.set_up_at
    from
    connector left join pivot_out_events 
        on pivot_out_events.connector_id = connector.connector_id
),

spine as (

    
    
    
    
    

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 629
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2020-08-12' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= 

    dateadd(
        week,
        1,
        date_trunc('day', 
    current_timestamp::
    timestamp_ntz

)
        )



)

select * from filtered

 
),

connector_event_history as (

    select
        cast(spine.date_day as date) as date_day,
        connector_event_counts.connector_name,
        connector_event_counts.connector_id,
        connector_event_counts.connector_type,
        connector_event_counts.destination_name,
        connector_event_counts.destination_id,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_api_calls
            else 0
        end) as count_api_calls,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_record_modifications
            else 0
        end) as count_record_modifications,
        max(case 
            when cast(spine.date_day as date) = connector_event_counts.date_day then connector_event_counts.count_schema_changes
            else 0
        end) as count_schema_changes
    from
    spine join connector_event_counts
        on spine.date_day  >= cast( date_trunc('day', connector_event_counts.set_up_at) as date)

    group by 1,2,3,4,5,6
),

-- now rejoin spine to get a complete calendar
join_event_history as (
    
    select
        spine.date_day,
        connector_event_history.connector_name,
        connector_event_history.connector_id,
        connector_event_history.connector_type,
        connector_event_history.destination_name,
        connector_event_history.destination_id,
        max(connector_event_history.count_api_calls) as count_api_calls,
        max(connector_event_history.count_record_modifications) as count_record_modifications,
        max(connector_event_history.count_schema_changes) as count_schema_changes

    from
    spine left join connector_event_history
        on cast(spine.date_day as date) = connector_event_history.date_day

    group by 1,2,3,4,5,6
),

final as (

    select *
    from join_event_history

    where cast(date_day as timestamp) <= 
    current_timestamp::
    timestamp_ntz



    order by date_day desc
)

select *
from final
      );
16:50:12.703243 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.92 seconds
16:50:12.705600 [debug] [Thread-1  ]: finished collecting timing info
16:50:12.705911 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__connector_daily_events: Close
16:50:12.821645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181c13a0>]}
16:50:12.822147 [info ] [Thread-1  ]: 14 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__connector_daily_events [[32mSUCCESS 1[0m in 3.15s]
16:50:12.822586 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__connector_daily_events
16:50:12.822872 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__schema_changelog
16:50:12.823340 [info ] [Thread-1  ]: 15 of 16 START table model workshop_live_fivetran_log.fivetran_log__schema_changelog [RUN]
16:50:12.823934 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
16:50:12.824153 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__schema_changelog
16:50:12.824438 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__schema_changelog
16:50:12.832208 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
16:50:12.832930 [debug] [Thread-1  ]: finished collecting timing info
16:50:12.833174 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__schema_changelog
16:50:12.836865 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__schema_changelog"
16:50:12.840473 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__schema_changelog"
16:50:12.840743 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__schema_changelog: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__schema_changelog"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__schema_changelog  as
      (with schema_changes as (

    select *
    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__log

    where event_subtype in ('create_table', 'alter_table', 'create_schema', 'change_schema_config')
),

connector as (

    select *
    from angel.workshop_live_fivetran_log.fivetran_log__connector_status
),

add_connector_info as (

    select 
        schema_changes.*,
        connector.connector_name,
        connector.destination_id,
        connector.destination_name

    from schema_changes join connector using(connector_id)
),

final as (

    select
        connector_id,
        connector_name,
        destination_id,
        destination_name,
        created_at,
        event_subtype,
        message_data,

        case 
        when event_subtype = 'alter_table' then 

  parse_json( message_data )['table'] 
        when event_subtype = 'create_table' then 

  parse_json( message_data )['name'] 
        else null end as table_name,

        case 
        when event_subtype = 'create_schema' or event_subtype = 'create_table' then 

  parse_json( message_data )['schema'] 
        else null end as schema_name
    
    from add_connector_info
)

select * from final
order by created_at desc, connector_id
      );
16:50:12.840958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:50:14.205219 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.36 seconds
16:50:14.207364 [debug] [Thread-1  ]: finished collecting timing info
16:50:14.207629 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__schema_changelog: Close
16:50:14.498147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181b2b50>]}
16:50:14.498650 [info ] [Thread-1  ]: 15 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__schema_changelog [[32mSUCCESS 1[0m in 1.67s]
16:50:14.499091 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__schema_changelog
16:50:14.499358 [debug] [Thread-1  ]: Began running node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:50:14.499764 [info ] [Thread-1  ]: 16 of 16 START table model workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history [RUN]
16:50:14.500317 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
16:50:14.500537 [debug] [Thread-1  ]: Began compiling node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:50:14.500753 [debug] [Thread-1  ]: Compiling model.fivetran_log.fivetran_log__credit_mar_destination_history
16:50:14.506554 [debug] [Thread-1  ]: Writing injected SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
16:50:14.507194 [debug] [Thread-1  ]: finished collecting timing info
16:50:14.507424 [debug] [Thread-1  ]: Began executing node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:50:14.510890 [debug] [Thread-1  ]: Writing runtime SQL for node "model.fivetran_log.fivetran_log__credit_mar_destination_history"
16:50:14.514319 [debug] [Thread-1  ]: Using snowflake connection "model.fivetran_log.fivetran_log__credit_mar_destination_history"
16:50:14.514569 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__credit_mar_destination_history: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "workshop_live", "target_name": "dev", "node_id": "model.fivetran_log.fivetran_log__credit_mar_destination_history"} */


      create or replace transient table angel.workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history  as
      (with table_mar as (
    
    select *
    from angel.workshop_live_fivetran_log.fivetran_log__mar_table_history
),

destination_mar as (

    select 
        measured_month,
        destination_id,
        destination_name,
        sum(monthly_active_rows) as monthly_active_rows
    
    from table_mar
    group by 1,2,3
),

credits_used as (

    select 
        destination_id,
        credits_consumed,
        cast(concat(measured_month, '-01') as date) as measured_month -- match date format to join with MAR table

    from angel.workshop_live_stg_fivetran_log.stg_fivetran_log__credits_used
),

join_credits_mar as (

    select 
        destination_mar.measured_month,
        destination_mar.destination_id,
        destination_mar.destination_name,
        credits_used.credits_consumed,
        destination_mar.monthly_active_rows,
        round( nullif(credits_used.credits_consumed,0) * 1000000.0 / nullif(destination_mar.monthly_active_rows,0), 2) as credits_per_million_mar,
        round( nullif(destination_mar.monthly_active_rows,0) * 1.0 / nullif(credits_used.credits_consumed,0), 0) as mar_per_credit

    from 
    destination_mar left join credits_used 
        on destination_mar.measured_month = cast(credits_used.measured_month as timestamp)
        and destination_mar.destination_id = credits_used.destination_id

)

select * from join_credits_mar
order by measured_month desc
      );
16:50:14.514792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:50:16.477877 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.96 seconds
16:50:16.480585 [debug] [Thread-1  ]: finished collecting timing info
16:50:16.480880 [debug] [Thread-1  ]: On model.fivetran_log.fivetran_log__credit_mar_destination_history: Close
16:50:16.581759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7f4e071-36c3-4c89-99bf-15486f528b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118203f40>]}
16:50:16.582288 [info ] [Thread-1  ]: 16 of 16 OK created table model workshop_live_fivetran_log.fivetran_log__credit_mar_destination_history [[32mSUCCESS 1[0m in 2.08s]
16:50:16.582964 [debug] [Thread-1  ]: Finished running node model.fivetran_log.fivetran_log__credit_mar_destination_history
16:50:16.585187 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:50:16.585868 [info ] [MainThread]: 
16:50:16.586332 [info ] [MainThread]: Finished running 14 table models, 1 view model, 1 incremental model in 36.91s.
16:50:16.587023 [debug] [MainThread]: Connection 'master' was properly closed.
16:50:16.587286 [debug] [MainThread]: Connection 'model.fivetran_log.fivetran_log__credit_mar_destination_history' was properly closed.
16:50:16.608719 [info ] [MainThread]: 
16:50:16.609165 [info ] [MainThread]: [32mCompleted successfully[0m
16:50:16.609628 [info ] [MainThread]: 
16:50:16.610089 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
16:50:16.610811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175c4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f26d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118004f70>]}
